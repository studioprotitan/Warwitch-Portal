try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="873f2d62-4a31-431d-97cc-e504ee2017b0",e._sentryDebugIdIdentifier="sentry-dbid-873f2d62-4a31-431d-97cc-e504ee2017b0")}catch(e){}{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{};e._sentryModuleMetadata=e._sentryModuleMetadata||{},e._sentryModuleMetadata[new e.Error().stack]=Object.assign({},e._sentryModuleMetadata[new e.Error().stack],{"_sentryBundlerPluginAppKey:anthropic-apps":!0})}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[49601],{0x19e8b6e8:(e,t,a)=>{a.d(t,{sF:()=>eM,Qg:()=>eC,Id:()=>ek});var s=a(0x22102fd88),n=a(0x628a9a0b),l=a(0x14a6d5f1),i=a(0x1065e6d73),r=a(0x14de19ae8),o=a(0x139b5e710),d=a(0x252daebb2),c=a(0x225bae024),u=a(0x1a3383306),m=a(0xac309a83),x=a(0x1b813d90),p=a(0x17f3a2521),f=a(0x1bd175d8c),h=a(0x48be3344),g=a(0xfc89b4a4),b=a(0x38e6572),v=a(0x23e1b1f63),y=a(0x1bd42f6d2),j=a(0x1334f6ecc),w=a(0x25062734b),k=a(0x18175ce17),C=a(0x33928c7f);a(0x4e764078);var M=a(0x8ca4d894),N=a(0x16801a2b9),A=a(0x17b66474f),S=a(0x17774dcd8),_=a(0x20567b754),E=a(0x9cb4c2a2),I=a(0x1c12b3087),T=a(0x114e73153),R=a(0x12c402068),D=a(0x10b8a0309),P=a(0x1d302b010),F=a(0x1037073d3);let L=()=>{let e=(0,P.lu)();return(0,s.jsxs)(R.x,{children:[(0,s.jsx)("p",{className:"text-[13px] text-text-200",children:e?(0,s.jsx)(b.A,{defaultMessage:"Connect your tools to Claude",id:"exSmFaQCLC"}):(0,s.jsx)(b.A,{defaultMessage:"Upgrade to connect your tools to Claude",id:"kIvAPf8iSA"})}),(0,s.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,s.jsxs)("div",{className:"flex flex-row",children:[e&&[{url:"https://mcp.notion.com/mcp",name:"Notion"},{url:"https://mcp.canva.com/mcp",name:"Canva"},{url:"https://mcp.linear.app/sse",name:"Linear"},{url:"https://mcp.atlassian.com/v1/sse",name:"Atlassian"},{url:"https://mcp.asana.com/sse",name:"Asana"}].map(e=>{let{url:t,name:a}=e;return(0,s.jsx)("div",{className:"w-3",children:(0,s.jsx)(F.z,{size:18,imageSize:13,type:"favicon",src:t,name:a})},t)}),["/images/icons/messages-app.svg","/images/icons/notes-app.svg","/images/icons/chrome-app.svg"].map(e=>(0,s.jsx)("div",{className:"w-3",children:(0,s.jsx)(F.z,{size:18,imageSize:13,type:"external",src:e})},e))]}),(0,s.jsx)(D.J,{size:16,className:"text-text-500"})]})]})};var z=a(0x1ab362a20);function O(e){let{enableNotifications:t,onDismiss:a}=e;return(0,s.jsxs)(R.x,{children:[(0,s.jsx)("span",{className:"text-text-300 text-sm",children:(0,s.jsx)(b.A,{defaultMessage:"Want to be notified when Claude responds?",id:"oTSi46bhi3"})}),(0,s.jsxs)("span",{children:[(0,s.jsx)(c.$,{size:"sm",variant:"primary",onClick:t,children:(0,s.jsx)(b.A,{defaultMessage:"Notify",id:"dhf5eKHqOb"})}),(0,s.jsx)(c.$,{className:"ml-2 !bg-transparent",size:"icon_xs",variant:"ghost",onClick:a,children:(0,s.jsx)(z.X,{size:12})})]})]})}var U=a(0x22fc8d729),Y=a(0x1ab0d1ca1),G=a(0x1025e2485);function H(){let e=(0,r.Kq)(),t=(0,Y.A)();return(0,s.jsx)(G.q,{actionButton:null,title:t.formatMessage({defaultMessage:"Team plan canceled",id:"KuqVOfg9/0"}),children:e?(0,s.jsx)(b.A,{defaultMessage:"You can no longer chat with Claude. To restore full access, <link>renew your subscription</link>.",id:"L2pC0kiNNO",values:{link:e=>(0,s.jsx)(U.Y,{className:"whitespace-nowrap",href:"/settings/billing",children:e})}}):(0,s.jsx)(b.A,{defaultMessage:"You can no longer chat with Claude.",id:"hxcpUUnV0b"})})}var q=a(0x242212ea2);let B=()=>{let{limitActionButton:e}=(0,q.hi)({allowSelfUpgrade:!1});return(0,s.jsx)(G.q,{actionButton:e,children:(0,s.jsx)(b.A,{defaultMessage:"Due to capacity constraints, chatting with Claude is currently not available. Please try again shortly.",id:"kfyWX0MxKQ"})})};var K=a(0x195e308ca),V=a(0xec9172c1),W=a(0xe824fb1c),$=a(0x1a1f6dda6);let J=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,$.A)("text-text-100 font-medium underline hover:no-underline",t),...a})},X=e=>{var t;let a,{inaccessibleSyncSources:n}=e,{chatResourceState:l}=(0,N.i)(),i=(0,K.v)(),{isDrawerExpanded:r,setIsDrawerExpanded:o}=(0,V.x)(),d=n[0],c=(null==d?void 0:d.type)===x.v8.MCP_RESOURCES?d.config.server_uuid:void 0,u=(0,W.Uz)({type:"remote",uuid:c}),m=n.every(e=>e.status.state===x.I5.UNAUTHENTICATED)&&1===new Set(n.map(e=>e.type)).size,p=null==(t=n[0])?void 0:t.type,f=(0,s.jsx)("button",{onClick:()=>{o(!0)},children:(0,s.jsx)(J,{children:(0,s.jsx)(b.A,{defaultMessage:"Show {count, plural, one {# Item} other {# Items}}",id:"1HlfJxfH7H",values:{count:n.length}})})}),h=c&&u[0]?{uuid:u[0].uuid,url:u[0].url}:void 0;if(m&&null!==p){if(p===x.v8.MCP_RESOURCES&&!h)return;a=(0,s.jsx)("button",{onClick:()=>i(p,h),children:(0,s.jsx)(J,{children:(0,s.jsx)(b.A,{defaultMessage:"Reconnect with {sourceName}",id:"dUareRZF9G",values:{sourceName:x.sb[p]}})})})}else l.conversationUuid&&!r&&(a=f);return(0,s.jsx)(R.x,{children:(0,s.jsx)(b.A,{defaultMessage:"Some of your content could not be loaded. {actionButton}",id:"Ibsz06ys2B",values:{actionButton:a}})})};var Q=a(0x11af11324),Z=a(0x1156b3bea);let ee="chat-notification-cta-dismissed";var et=a(0x109513363),ea=a(0x19aca0448),es=a(0x597e433e),en=a(0xf32c56dd),el=a(0xef41e510),ei=a.n(el),er=a(0x1dbad8fd1);function eo(e){let{wiggleOrgEnabled:t}=e,{track:a}=(0,en.st)();return(0,s.jsx)(R.x,{children:(0,s.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,s.jsx)("div",{children:t?(0,s.jsx)(b.A,{defaultMessage:"Claude needs code execution to access some attached files.",id:"2NqXIz34vM"}):(0,s.jsx)(b.A,{defaultMessage:"Claude needs code execution to access some attached files. Contact an organization owner to enable this feature.",id:"HjhwC7vyjv"})}),t&&(0,s.jsx)("div",{children:(0,s.jsx)(ei(),{className:"text-accent-secondary-000 font-medium",href:"/settings/capabilities",onClick:()=>{a({event_key:"claudeai.settings.capabilities.opened",source:"ooc_files_warning"})},children:(0,s.jsx)(b.A,{defaultMessage:"Enable in settings",id:"01fHiYUEo1"})})})]})})}var ed=a(0x7f00847a),ec=a(0xbe814870),eu=a(0xb6b8b1fb),em=a(0x459bbfb4),ex=a(0x2b8c35fe);let ep="rosemary_last_notified_at";function ef(e){try{localStorage.setItem(ep,String(e))}catch(e){}}var eh=a(0xbca8e388),eg=a(0x226530adf),eb=a(0xb804d868),ev=a(0x8603234d),ey=a(0x156c4e43b);let ej=ey.Ik({id:ey.Yj(),bodyMd:ey.Yj(),isDismissable:ey.zM(),proUpsell:ey.zM(),alertForModels:ey.YO(ey.Yj())}).nullable(),ew=e=>{let{alert:t,setHideAlert:a}=e,n=(0,r.UC)(),{limitActionButton:l}=(0,q.hi)();return(0,s.jsxs)(R.x,{children:[(0,s.jsx)(eh.Lv,{children:(0,s.jsx)(ev.o,{children:t.bodyMd})}),n&&t.proUpsell&&l,t.isDismissable&&(0,s.jsx)(c.$,{className:"ml-2 rounded",size:"icon_xs",variant:"ghost",onClick:()=>a(!0),children:(0,s.jsx)(z.X,{size:12})})]})},ek=()=>{let e=(0,k.X0)(x.v8.GMAIL),t=(0,k.X0)(x.v8.GCAL),a=(0,j.$f)();return!(0,f.V)()&&(e||t||a)},eC=e=>{var t,a,l,o,c,p,j,k,M,D,P,F,z,U,Y,G,q,K;let V,{placement:W,onRetry:$,isRunningToolOrThinking:J=!1,askUserInputData:en}=e,el=(0,m.fS)("chat-ui-core"),{isPromptUnsafe:ei}=(0,I.QT)(),{attachments:eh,files:ev}=(0,I.Jy)(e=>({attachments:e.attachments,files:e.files})),{conversation:ey}=(0,E.oM)(),eC=(0,I.QN)(),eM=(0,n.WZ)(null==ey?void 0:ey.id),{setMcpDirectoryModalIsOpen:eN}=(0,A.tl)(),eA=(0,ea.h)(null==ey?void 0:ey.id,null==ey?void 0:ey.model),eS=(null==ey?void 0:ey.id)&&eA?(0,s.jsx)(ea.g,{conversationUuid:ey.id,model:ey.model,lastMessage:eA.lastMessage,stopReason:eA.stopReason,onRetryWithFallback:async()=>{if(!eA.lastMessage.parent_message_uuid)return;let{model:e}=await eM.mutateAsync();$(eA.lastMessage.parent_message_uuid,e)}}):null,{exceededMessageLimitWarning:e_,approachingMessageLimitWarning:eE,overageExceededWarning:eI}=(0,et.IK)(null!=(t=null==ey?void 0:ey.id)?t:null),{isRavenCanceled:eT}=(0,v.bF)(),eR=eT?(0,s.jsx)(H,{}):void 0,eD=(0,r.r$)()?(0,s.jsx)(B,{}):void 0,eP=(()=>{let{chatResourceState:e}=(0,N.i)();return[...e.syncSources||[],...(0,y.CO)(eC).data||[]].filter(e=>{var t;return x.xj.includes(null==e||null==(t=e.status)?void 0:t.state)})})(),eF=eP.length?(0,s.jsx)(X,{inaccessibleSyncSources:eP}):void 0,eL=(0,C.CD)(),ez=(0,r.mV)(),eO=eL&&!ez?(0,s.jsx)(R.x,{children:(0,s.jsxs)("div",{className:"text-danger-000 flex items-center gap-1",children:[(0,s.jsx)(h.N,{className:"h-4 w-4 shrink-0",weight:"regular"}),(0,s.jsx)("span",{children:(0,s.jsx)(b.A,{defaultMessage:"Less accurate Google Drive search results while Claude catalogs your Drive files",id:"ljvRWwDUyf"})})]})}):void 0,eU=(0,T.U)(eC)?(0,s.jsx)(R.x,{children:(0,s.jsxs)("div",{className:"text-danger-000 flex items-center gap-1",children:[(0,s.jsx)(h.N,{className:"h-4 w-4 shrink-0",weight:"regular"}),(0,s.jsx)("span",{children:(0,s.jsx)(b.A,{defaultMessage:"Project knowledge exceeds maximum. Remove files to continue.",id:"IqUMWBoy4d"})})]})}):void 0,{systemAlertFromConfig:eY}=(e=>{let t=(0,m.T9)("claude_ai_system_alerts","alert",null,ej),[a,n]=(0,eb.Vc)("".concat(e,":").concat(null==t?void 0:t.id,":hideAlertOnConversation"),!1),l=null==t?void 0:t.alertForModels,i=(0,eg.Z3)(e);return e&&(!l||l.includes(i))&&t&&!a?{systemAlertFromConfig:{alert:t,component:(0,s.jsx)(ew,{alert:t,setHideAlert:n})}}:{}})(null!=(a=null==ey?void 0:ey.id)?a:null),eG=eY?eY.component:null,eH=(0,i.u9)(),eq=function(e,t,a){let{data:n=[]}=(0,er.uE)(a),l=(0,es.cV)(),r=(0,i.t5)(),o=[...e,...t?t.files:[],...n].filter(e=>e.file_kind===u.Mr.Blob);return!l&&o.length?(0,s.jsx)(eo,{wiggleOrgEnabled:r}):null}(ev,ey,eC),eB=eH?null:eq,eK=ek(),eV=(0,m.fS)("claudeai_unsafe_prompt_inline"),eW=ei&&eK&&eV?(0,s.jsx)(R.x,{children:(0,s.jsxs)("div",{className:"text-danger-000 flex items-center gap-1",children:[(0,s.jsx)(h.N,{className:"h-4 w-4 shrink-0",weight:"regular"}),(0,s.jsx)("span",{children:(0,s.jsx)(b.A,{defaultMessage:"Use caution before running this prompt. Malicious conversation content could trick Claude into attempting harmful actions or sharing your data.",id:"bWRp6wwzXA"})})]})}):null,e$=eh.some(e=>e.origin===u.R9.URLParameter)?(0,s.jsx)(R.x,{children:(0,s.jsxs)("div",{className:"text-danger-000 flex items-center gap-1",children:[(0,s.jsx)(h.N,{className:"h-4 w-4 shrink-0",weight:"regular"}),(0,s.jsx)("span",{children:(0,s.jsx)(b.A,{defaultMessage:"Artifacts are user-generated and may contain unverified or potentially unsafe content.",id:"/0GesG9R4n"})})]})}):null,eJ=null!=(o=null!=(l=null!=eS?eS:eW)?l:e$)?o:null,eX=(0,w.ko)({shouldTrack:"onpage"===W})&&"onpage"===W?(0,s.jsx)(L,{}):null,{warning:eQ,modal:eZ}=function(e,t){let a=(0,ex.F)("claudeai_rosemary_enabled"),{data:n}=(0,eu.F1)({enabled:a}),[l,i]=(0,g.useState)(!1),[r,o]=(0,g.useState)(!1),c=!!((null==n?void 0:n.reflection)&&n.reflection.trim().length>0),u=(0,g.useCallback)(()=>{ef(Date.now()),o(!0),i(!0)},[i,o]),m=(0,g.useCallback)(()=>{ef(Date.now()),o(!0)},[o]);return a&&c?{warning:"onpage"===t&&!r&&function(e){if(!e)return!1;let t=function(){try{let e=localStorage.getItem(ep);return e?Number(e):null}catch(e){return null}}(),a=new Date(e).getTime(),s=Date.now();return null===t||s-t>432e6&&a>t}(null==n?void 0:n.updated_at)?(0,s.jsx)(R.x,{children:(0,s.jsxs)("div",{className:"text-accent-main-200 flex items-center gap-1 justify-between w-full",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(ed.R,{className:"h-4 w-4 shrink-0",weight:"fill"}),(0,s.jsx)("span",{children:(0,s.jsx)(d.YX,{id:"architect_embrace_transition",dangerouslyVisiblePublicValues:{here:(0,s.jsx)("button",{onClick:u,className:"underline cursor-pointer hover:text-accent-main-100",children:(0,s.jsx)(b.A,{defaultMessage:"here",id:"hniz8ZA1BU"})})}})})]}),(0,s.jsx)("button",{onClick:m,className:"text-accent-main-200 hover:text-accent-main-100 cursor-pointer ml-2","aria-label":"Dismiss",children:(0,s.jsx)(ec.X,{className:"h-4 w-4",weight:"regular"})})]})}):null,modal:l&&(null==n?void 0:n.reflection)?(0,s.jsx)(em.x,{modalOpen:l,setModalOpen:i,parsedMemory:n.reflection}):null}:{warning:null,modal:null}}(0,W),{showNotification:e0,notificationPermission:e1,enableNotifications:e2,dismiss:e5,isEnabled:e3,isFeatureEnabled:e4}=(e=>{let{isRunningToolOrThinking:t}=e,a=(0,f.V)(),s=(0,m.fS)("web_completion_notif")&&!a,n=(0,Z.Wo)(),l=(0,Z.hG)(),i=(0,Q.Lr)(),r=(0,Q.KG)("completion"),[o,d]=(0,g.useState)(()=>(function(){let e=localStorage.getItem(ee);if(!e)return!1;let t=new Date(e).getTime();return Date.now()-t<2592e6})()),[c,u]=(0,g.useState)(!1),x=(0,g.useRef)(null);(0,g.useEffect)(()=>{if(s&&!c)return t?x.current||(x.current=setTimeout(()=>{u(!0),x.current=null},3e3)):x.current&&(clearTimeout(x.current),x.current=null),()=>{x.current&&clearTimeout(x.current)}},[t,s,c]);let p=(0,g.useCallback)(async()=>{let{success:e}=await l();return e&&await i(!0),e},[l,i]);return{showNotification:c&&!o,notificationPermission:n,enableNotifications:p,dismiss:(0,g.useCallback)(()=>{let e=new Date().toISOString();localStorage.setItem(ee,e),d(!0)},[]),isEnabled:r,isFeatureEnabled:s}})({isRunningToolOrThinking:J}),e8=(0,S.lS)(),e6=el&&e4&&e0&&!e8&&("granted"!==e1||!e3)?(0,s.jsx)(O,{enableNotifications:e2,onDismiss:e5}):null,e9=null!=(K=null!=(q=null!=(G=null!=(Y=null!=(U=null!=(z=null!=(F=null!=(P=null!=(D=null!=(M=null!=(k=null!=(j=null!=(p=null!=(c=null!=eJ?eJ:null!=eU?eU:null)?c:e_)?p:eI)?j:eR)?k:eD)?M:eF)?D:eB)?P:eG)?F:eO)?z:eE)?U:eQ)?Y:eX)?G:null)?q:e6)?K:null;e9===eX&&(V=()=>eN(!0));let e7=eY&&eY.alert.proUpsell,te=!!(e_||eB||eO||eE||eQ||e6);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(_.L,{warning:e9,placement:W,theme:e7?"pro":te?"info":eX?"chin":"danger",onClick:V}),eZ]})};function eM(e){var t,a;let{model:n,conversationUuid:i,lastMessage:r,fallback:o,onRetryWithFallback:u}=e,[x,p]=(0,g.useState)(!1),{allModelOptions:f}=(0,l.A9)(),h=f.find(e=>e.model===n),v=(null==h||null==(t=h.name)?void 0:t.replace("Claude",""))||n,y=null!=(a=(0,m.T9)("hiking_boots","value",null,m.Lu))?a:"";return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eN,{isOpen:x,onClose:()=>p(!1),conversationUuid:i,lastMessage:r}),(0,s.jsx)("div",{className:"mx-2 md:mx-0",children:(0,s.jsxs)("div",{className:"flex flex-col md:flex-row min-h-[99px] py-4 px-6 shadow-[0_0.25rem_1.25rem_hsl(var(--always-black)/3.5%)] rounded-2xl bg-bg-000 md:items-center gap-4 md:gap-6 border-0.5 border-border-300",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-1 text-sm flex-1",children:[(0,s.jsx)("h4",{className:"font-bold",children:(0,s.jsx)(b.A,{defaultMessage:"Chat paused",id:"bL7dVUkHa0"})}),(0,s.jsx)("p",{className:"text-text-300",children:(0,s.jsx)(d.YX,{id:"howdy",dangerouslyVisiblePublicValues:{currentModelName:v,fallbackModelName:o.displayName,feedback:e=>(0,s.jsx)("button",{className:"underline cursor-pointer",onClick:()=>{p(!0)},children:e}),learnMore:e=>(0,s.jsx)("a",{className:"underline cursor-pointer",href:y,target:"_blank",children:e})}})})]}),(0,s.jsx)("div",{className:"w-full md:w-auto",children:(0,s.jsx)(c.$,{onClick:u,className:"w-full md:w-auto",children:(0,s.jsx)(b.A,{defaultMessage:"Retry with {fallbackModelName}",id:"SH+4I4XTEI",values:{fallbackModelName:o.displayName}})})})]})}),(0,s.jsx)("div",{className:"bg-bg-100 w-full h-2"})]})}function eN(e){let{isOpen:t,onClose:a,conversationUuid:n,lastMessage:l}=e,i=(0,o.Yf)();return(0,s.jsx)(M.B,{isOpen:t,showOptions:!1,conversationUuid:n,message:l,requestedFeedbackType:p.kj.SC_FALSE_POSITIVE,setRequestedFeedbackType:()=>{},onClose:a,onSuccess:()=>{a(),i.addSuccess((0,s.jsx)(b.A,{defaultMessage:"Thanks for your feedback!",id:"coh2h6fh1P"}))}})}},0x1cee1d89:(e,t,a)=>{a.d(t,{Bv:()=>i,PK:()=>l,ls:()=>n,t_:()=>r});var s=a(0x2149252e7);let n="text/html;profile=mcp-app";async function l(e){let t=document.createElement("iframe");t.style.width="100%",t.style.border="none",t.style.backgroundColor="transparent",t.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),t.setAttribute("allow","fullscreen");let a=new Promise((e,a)=>{let s=async a=>{a.source===t.contentWindow&&a.data&&"ui/notifications/sandbox-proxy-ready"===a.data.method&&(window.removeEventListener("message",s),e())};window.addEventListener("message",s)});return t.src=e.href,{iframe:t,onReady:a}}async function i(e,t){let a,n,l;do{let s=await e.listTools({cursor:l});a=s.tools.find(e=>e.name===t),l=s.nextCursor}while(!a&&l);if(!a)throw Error("tool ".concat(t," not found"));if(!a._meta||"object"!=typeof a._meta)return null;let i=a._meta;if(!(s.CG in i))return null;if(!(n=String(i[s.CG])).startsWith("ui://"))throw Error("tool ".concat(t," has unsupported output template URI: ").concat(n));return{uri:n}}async function r(e,t){let a,l=await e.readResource({uri:t.uri});if(!l)throw Error("UI resource not found: "+t.uri);if(1!==l.contents.length)throw Error("Unsupported UI resource content length: "+l.contents.length);let i=l.contents[0],r=e=>"text/html+mcp"===e||e===n;if("text"in i&&"string"==typeof i.text&&r(i.mimeType))a=i.text;else if("blob"in i&&"string"==typeof i.blob&&r(i.mimeType))a=atob(i.blob);else throw Error("Unsupported UI resource content format: "+JSON.stringify(i));return{html:a,meta:i._meta&&"ui"in i._meta?s.ne.parse(i._meta.ui):void 0}}},0x33928c7f:(e,t,a)=>{a.d(t,{CD:()=>o});var s=a(0x12c9046cd),n=a(0x14de19ae8),l=a(0x49fac030),i=a(0x1b813d90),r=a(0x1334f6ecc);let o=()=>{let e=(0,r.$f)(),t=(0,r.vT)(),a=(0,r.K6)(),{data:s}=d(i.v8.GDRIVE),n=null==s?void 0:s.state;return!!(e&&t&&a&&n&&[i.I5.CREATED,i.I5.UPDATING,i.I5.PENDING].includes(n))},d=e=>{let{account:t,activeOrganization:a}=(0,n.YL)(),r=null==t?void 0:t.uuid,o=null==a?void 0:a.uuid;return(0,s.Sk)("/api/organizations/".concat(o,"/sync/ingestion/").concat(e,"/progress"),{queryKey:[l.hx,{orgUuid:o,accountUuid:r,syncSourceType:e}],enabled:!!a,refetchInterval:e=>{let t;return!!(e.state.data&&(t=e.state.data.state,[i.I5.CREATED,i.I5.PENDING,i.I5.UPDATING].includes(t)))&&6e4},meta:{noToast:!0}})}},0x459bbfb4:(e,t,a)=>{a.d(t,{x:()=>c});var s=a(0x22102fd88),n=a(0xbca8e388),l=a(0x252daebb2),i=a(0x183548b63),r=a(0x1a1f6dda6),o=a(0x18c2bb2d),d=a(0x160045b25);function c(e){let{modalOpen:t,setModalOpen:a,parsedMemory:n}=e;return(0,s.jsx)(i.aF,{className:"!p-8",hasCloseButton:!0,isOpen:t,onClose:()=>a(!1),title:(0,s.jsx)(l.YX,{id:"lay_section_fireplace"}),modalSize:"xl",children:(0,s.jsx)(u,{height:460,parsedMemory:n})})}function u(e){let{height:t,parsedMemory:a}=e;return(0,s.jsxs)("div",{className:(0,r.A)("border-border-300 border-0.5 rounded-xl flex flex-col relative bg-bg-000 overflow-hidden mt-2"),style:{height:t},children:[(0,s.jsx)(o.P.div,{animate:{opacity:0},className:(0,r.A)("absolute left-0 top-0 bottom-0 right-0 w-full h-full rounded-lg"),style:{backgroundImage:"radial-gradient(at 90% 90%,hsl(var(--accent-main-200)/0.1) 0%, transparent 90%)"}}),(0,s.jsx)(o.P.div,{animate:{opacity:1},transition:{delay:2,duration:1.5},className:"relative overflow-hidden rounded-t-lg h-full",children:(0,s.jsx)("div",{className:(0,r.A)("h-full px-5 py-4 pb-24 font-claude-response text-sm overflow-y-auto rounded-t-lg bg-bg-200/20"),children:(0,s.jsx)(d.N,{children:(0,s.jsxs)(o.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:[(0,s.jsx)(n.fP,{text:a}),(0,s.jsx)("div",{className:"absolute bottom-0 h-[18px] bg-gradient-to-t from-text-100 to-bg-100 w-full left-0 opacity-[0.02]"})]},"synthesis")})})})]})}},0x4e764078:(e,t,a)=>{a.d(t,{eN:()=>I,u5:()=>d});var s=a(0x22102fd88),n=a(0xfc89b4a4),l=a(0x1ab0d1ca1),i=a(0x9cb4c2a2);let r={selections:{},rankings:{}},o=(0,n.createContext)({data:null,setData:()=>void 0,state:r,toggleOption:()=>void 0,selectSingleOption:()=>void 0,reorderRanking:()=>void 0,submitAnswers:()=>void 0,clearAll:()=>void 0,isMinimized:!1,minimize:()=>void 0,expand:()=>void 0,bannerRef:{current:null},focusBanner:()=>void 0}),d=()=>(0,n.useContext)(o);(0,n.memo)(e=>{let{children:t}=e,[a,d]=(0,n.useState)(null),[c,u]=(0,n.useState)(r),[m,x]=(0,n.useState)(!1),{sendTransparentMessage:p}=(0,i.oM)(),f=(0,l.A)(),h=(0,n.useRef)(null),g=(0,n.useCallback)(()=>{var e;null==(e=h.current)||e.focus()},[]),b=(0,n.useCallback)(e=>{if(d(e),e){x(!1);let t={};for(let a of e.questions)"rank_priorities"===a.type&&(t[a.id]=a.options.map(e=>e.id));u({selections:{},rankings:t})}},[]),v=(0,n.useCallback)(()=>{d(null),u(r),x(!1)},[]),y=(0,n.useCallback)(()=>{x(!0)},[]),j=(0,n.useCallback)(()=>{x(!1)},[]),w=(0,n.useCallback)((e,t)=>{u(a=>{let s=a.selections[e]||[],n=s.includes(t);return{...a,selections:{...a.selections,[e]:n?s.filter(e=>e!==t):[...s,t]}}})},[]),k=(0,n.useCallback)((e,t)=>{if(!a)return;let s=a.questions.find(t=>t.id===e);if(!s)return;u(a=>({...a,selections:{...a.selections,[e]:[t]}}));let n=1===a.questions.length,l=!s.multiSelect&&"rank_priorities"!==s.type;if(n&&l){let e=s.options.find(e=>e.id===t);e&&(v(),null==p||p(f.formatMessage({defaultMessage:"I'd like to go with {option}",id:"8uwwarLoYv"},{option:e.label})))}},[a,v,p,f]),C=(0,n.useCallback)((e,t,a)=>{u(s=>{let n=[...s.rankings[e]||[]],[l]=n.splice(t,1);return n.splice(a,0,l),{...s,rankings:{...s.rankings,[e]:n}}})},[]),M=(0,n.useCallback)(()=>{if(!a)return;let e=[];for(let t of a.questions){let s=t.type||"select";if("select"===s){let s=c.selections[t.id]||[];if(s.length>0){let n=function(e,t){return t.map(t=>{var a;return null==(a=e.options.find(e=>e.id===t))?void 0:a.label}).filter(Boolean)}(t,s),l=f.formatList(n,{type:"conjunction"});1===a.questions.length?e.push(f.formatMessage({defaultMessage:"I'd like {selection}",id:"b5/69BwqNN"},{selection:l})):e.push(f.formatMessage({defaultMessage:"For {questionText}: I'd like {selection}",id:"4Hs04oP7i2"},{questionText:t.question.toLowerCase(),selection:l}))}}else if("rank_priorities"===s){let s=c.rankings[t.id]||[],n=function(e,t){return t.map((t,a)=>{var s;let n=null==(s=e.options.find(e=>e.id===t))?void 0:s.label;return n?"".concat(a+1,". ").concat(n):null}).filter(Boolean).join(", ")}(t,s);1===a.questions.length?e.push(f.formatMessage({defaultMessage:"My priorities in order: {ranking}",id:"lMwlnBkvBO"},{ranking:n})):e.push(f.formatMessage({defaultMessage:"For {questionText}: {ranking}",id:"/c6fsaiCS2"},{questionText:t.question.toLowerCase(),ranking:n}))}}e.length>0&&(v(),null==p||p(e.join("\n")))},[a,c,v,p,f]),N=(0,n.useMemo)(()=>({data:a,setData:b,state:c,toggleOption:w,selectSingleOption:k,reorderRanking:C,submitAnswers:M,clearAll:v,isMinimized:m,minimize:y,expand:j,bannerRef:h,focusBanner:g}),[a,b,c,w,k,C,M,v,m,y,j,g]);return(0,s.jsx)(o.Provider,{value:N,children:t})}).displayName="AskUserInputProvider";var c=a(0x64121218),u=a.n(c),m=a(0x225bae024),x=a(0x212aec62a),p=a(0x1ab362a20),f=a(0x38e6572),h=a(0xb323e954),g=a(0x1e6551146);let b=["A","B","C","D"];var v=a(0x12cff2265);let y={bag:"ShoppingBag",shop:"Storefront",store:"Storefront",cart:"ShoppingCart",buy:"ShoppingCart",money:"CurrencyDollar",cash:"Money",payment:"CreditCard",price:"Tag",food:"ForkKnife",eat:"ForkKnife",restaurant:"ForkKnife",dining:"ForkKnife",chef:"ChefHat",chefhat:"ChefHat",cooking:"CookingPot",recipe:"CookingPot",drink:"Martini",cocktail:"Martini",beer:"BeerBottle",wine:"Wine",coffee:"Coffee",tea:"Coffee",code:"Code",coding:"Code",programming:"Code",develop:"Code",terminal:"Terminal",console:"Terminal",bug:"Bug",debug:"Bug",computer:"Desktop",laptop:"Laptop",phone:"DeviceMobile",mobile:"DeviceMobile",web:"Globe",internet:"Globe",cloud:"Cloud",server:"HardDrives",database:"Database",api:"Plugs",learn:"GraduationCap",study:"GraduationCap",education:"GraduationCap",school:"GraduationCap",book:"Book",read:"BookOpen",write:"PencilSimple",pen:"Pen",pencil:"Pencil",note:"Note",notes:"Notebook",travel:"Airplane",fly:"Airplane",flight:"Airplane",plane:"Airplane",car:"Car",drive:"Car",bus:"Bus",train:"Train",bike:"Bicycle",walk:"PersonSimpleWalk",run:"PersonSimpleRun",chat:"ChatCircle",message:"ChatText",email:"Envelope",mail:"Envelope",call:"Phone",video:"VideoCamera",music:"MusicNote",song:"MusicNote",play:"Play",movie:"FilmStrip",film:"FilmStrip",tv:"Television",game:"GameController",gaming:"GameController",photo:"Camera",camera:"Camera",image:"Image",picture:"Image",sun:"Sun",sunny:"Sun",moon:"Moon",star:"Star",stars:"Star",rain:"CloudRain",snow:"Snowflake",tree:"Tree",plant:"Plant",flower:"Flower",leaf:"Leaf",health:"Heart",medical:"FirstAid",doctor:"Stethoscope",hospital:"Hospital",workout:"Barbell",gym:"Barbell",fitness:"Barbell",yoga:"PersonSimple",home:"House",house:"House",bed:"Bed",sleep:"Moon",clean:"Broom",cook:"CookingPot",kitchen:"CookingPot",work:"Briefcase",job:"Briefcase",office:"Buildings",meeting:"UsersThree",team:"UsersThree",chart:"ChartLine",graph:"ChartBar",analytics:"ChartPie",search:"MagnifyingGlass",find:"MagnifyingGlass",settings:"Gear",config:"GearSix",help:"Question",info:"Info",warning:"Warning",error:"XCircle",success:"CheckCircle",check:"Check",add:"Plus",remove:"Minus",delete:"Trash",edit:"PencilSimple",save:"FloppyDisk",download:"DownloadSimple",upload:"UploadSimple",share:"Share",link:"Link",copy:"Copy",paste:"ClipboardText",user:"User",person:"Person",people:"Users",group:"UsersThree",friend:"UserPlus",idea:"Lightbulb",lightbulb:"Lightbulb",magic:"MagicWand",sparkle:"Sparkle",fire:"Fire",hot:"Fire",lock:"Lock",secure:"ShieldCheck",security:"Shield",key:"Key",time:"Clock",clock:"Clock",calendar:"Calendar",date:"CalendarBlank",location:"MapPin",map:"Map",pin:"PushPin",flag:"Flag",bookmark:"BookmarkSimple",tag:"Tag",label:"Tag",folder:"Folder",file:"File",document:"FileText",pdf:"FilePdf",zip:"FileZip",archive:"Archive",box:"Package",package:"Package",gift:"Gift",present:"Gift",puzzle:"PuzzlePiece",target:"Target",goal:"Target",trophy:"Trophy",medal:"Medal",award:"Trophy",crown:"Crown",diamond:"Diamond",gem:"Gem"};function j(e){return e.split(/[-_\s]+/).map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join("")}let w=null,k=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return"group/row flex w-full items-center gap-[1.2rem] ".concat(e?"py-2.5 px-3":"p-4"," text-left ").concat(t?"bg-accent-secondary-100/10":"bg-bg-000 hover:bg-bg-100/50"," border-b border-border-300 last:border-b-0")},C=(0,n.memo)(e=>{let{option:t,index:a,variant:n,isSelected:l=!1,isFocused:i=!1,compact:r,onClick:o,onHover:d,isDragging:c=!1,sortableRef:u,sortableStyle:m,sortableAttributes:x,sortableListeners:p}=e,f=null!=r?r:!t.description,C=i||l,M="multi-select"===n?(0,s.jsx)("div",{className:"flex ".concat(f?"size-8":"size-10"," shrink-0 items-center justify-center"),children:(0,s.jsx)(h.S,{checked:l,onChange:()=>void 0,className:f?"!w-5 !h-5":"!w-6 !h-6",iconClassName:f?"!w-3 !h-3":"!w-4 !h-4",size:f?10:12,hideLabel:!0,label:""})}):(0,s.jsx)("span",{className:"relative flex ".concat(f?"size-8 text-xs":"size-10 text-sm"," shrink-0 items-center justify-center rounded-lg font-semibold ").concat(C?"bg-accent-secondary-100/20 text-accent-secondary-100":"bg-bg-300 text-text-300 group-hover/row:bg-accent-secondary-100/20 group-hover/row:text-accent-secondary-100"),children:"rank"===n?a+1:t.icon?function(e){let{icon:t,size:a,className:n}=e;if(!t)return null;if(RegExp("\\p{Emoji}","u").test(t))return(0,s.jsx)("span",{className:n,children:t});let l=function(e){let t=e.trim(),a=t.toLowerCase(),s=y[a];if(s){let e=v[s];if(e)return e}let n=a.replace(/[-_\s]+/g,"");if(n!==a){let e=y[n];if(e){let t=v[e];if(t)return t}}let l=v[j(t)];if(l)return l;let i=a.replace(/s$/,""),r=y[i];if(r){let e=v[r];if(e)return e}let o=v[j(i)];if(o)return o;let d=(w||(w=Object.keys(v).filter(e=>"IconContext"!==e&&"object"==typeof v[e])),w),c=n.toLowerCase();for(let e of d)if(e.toLowerCase().includes(c)){let t=v[e];if(t)return t}for(let e of d)if(c.includes(e.toLowerCase())){let t=v[e];if(t)return t}return null}(t);if(l)try{return(0,s.jsx)(l,{size:a,weight:"regular",className:n})}catch(e){}return null}({icon:t.icon,size:f?16:20}):b[a%b.length]}),N=(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("div",{className:"text-base text-text-100",children:t.label}),t.description&&(0,s.jsx)("div",{className:"text-sm text-text-500 line-clamp-1",children:t.description})]}),A="rank"===n?(0,s.jsx)(g.H,{size:20,weight:"bold",className:"text-text-400 shrink-0"}):null;return"rank"===n?(0,s.jsxs)("div",{ref:u,style:m,...x,...p,className:"".concat(k(f)," cursor-grab active:cursor-grabbing touch-none select-none ").concat(c?"opacity-50 shadow-lg z-10":""),children:[M,N,A]}):(0,s.jsxs)("button",{type:"button",onClick:o,onMouseEnter:()=>null==d?void 0:d(!0),onMouseLeave:()=>null==d?void 0:d(!1),className:k(f,l),children:[M,N]})});C.displayName="OptionItem";var M=a(0x13edb992a),N=a(0x1874dbd74),A=a(0x16a41ed74);let S=(0,n.memo)(e=>{let{id:t,option:a,index:n}=e,{attributes:l,listeners:i,setNodeRef:r,transform:o,transition:d,isDragging:c}=(0,N.gl)({id:t}),u={transform:A.Ks.Transform.toString(o),transition:d};return(0,s.jsx)(C,{variant:"rank",option:a,index:n,isDragging:c,sortableRef:r,sortableStyle:u,sortableAttributes:l,sortableListeners:i})});S.displayName="SortableItem";let _=(0,n.memo)(e=>{let{question:t,rankings:a,onReorder:l}=e,i=(0,M.FR)((0,M.MS)(M.AN),(0,M.MS)(M.uN,{coordinateGetter:N.JR})),r=(0,n.useCallback)(e=>{let{active:t,over:s}=e;s&&t.id!==s.id&&l(a.indexOf(t.id),a.indexOf(s.id))},[a,l]),o=a.map(e=>t.options.find(t=>t.id===e)).filter(Boolean);return(0,s.jsxs)("div",{className:"mb-4 last:mb-0",children:[(0,s.jsx)("div",{className:"mb-2 px-1 pr-8",children:(0,s.jsx)("span",{className:"text-text-200 font-claude-response",children:t.question})}),(0,s.jsx)("div",{className:"border border-border-300 rounded-xl overflow-hidden",children:(0,s.jsx)(M.Mp,{sensors:i,collisionDetection:M.fp,onDragEnd:r,children:(0,s.jsx)(N.gB,{items:a,strategy:N._G,children:o.map((e,t)=>(0,s.jsx)(S,{id:e.id,option:e,index:t},e.id))})})})]})});_.displayName="RankPrioritiesQuestion";let E=(0,n.memo)(e=>{var t;let{question:a,selections:n,rankings:l,focusedOptionIndex:i,onSelectSingle:r,onToggleMulti:o,onReorder:d,setFocusedOptionIndex:c}=e,u=a.type||"select",m=null!=(t=a.multiSelect)&&t;if("rank_priorities"===u)return(0,s.jsx)(_,{question:a,rankings:l,onReorder:d});let x=!a.options.some(e=>e.description);return(0,s.jsxs)("div",{className:"mb-4 last:mb-0",children:[(0,s.jsx)("div",{className:"mb-2 px-1 pr-8",children:(0,s.jsx)("span",{className:"text-text-200 font-claude-response",children:a.question})}),(0,s.jsx)("div",{className:"flex flex-col border border-border-300 rounded-xl overflow-hidden",children:a.options.map((e,t)=>{let a=n.includes(e.id),l=i===t;return(0,s.jsx)(C,{variant:m?"multi-select":"single-select",option:e,index:t,isSelected:a,isFocused:l,compact:x,onClick:()=>m?o(e.id):r(e.id),onHover:e=>{c(e?t:-1)}},e.id)})})]})});function I(e){let{children:t}=e;return(0,s.jsx)(s.Fragment,{children:t})}E.displayName="QuestionSection",(0,n.memo)(function(e){let{data:t}=e,{state:a,selectSingleOption:l,toggleOption:i,reorderRanking:r,submitAnswers:o,isMinimized:c,minimize:h,expand:g,bannerRef:b}=d(),[v,y]=(0,n.useState)(0),[j,w]=(0,n.useState)(-1),k=t.questions[v],C=v===t.questions.length-1,M=t.questions.length>1,N=(null==k?void 0:k.multiSelect)||(null==k?void 0:k.type)==="rank_priorities",A=!!k&&("rank_priorities"===k.type||(a.selections[k.id]||[]).length>0),S=(0,n.useCallback)(()=>{C||(y(e=>e+1),w(-1))},[C]),_=(0,n.useCallback)(()=>{h(),w(-1)},[h]),I=(0,n.useCallback)(e=>{if(!k)return;let t=k.options.length;switch(e.key){case"ArrowUp":e.preventDefault(),j<=0?w(t-1):w(j-1);break;case"ArrowDown":e.preventDefault(),j>=t-1?w(0):w(j+1);break;case"Enter":if(e.preventDefault(),j>=0&&j<t){let e=k.options[j];k.multiSelect?i(k.id,e.id):l(k.id,e.id)}else A&&(C?o():S());break;case"Escape":e.preventDefault(),_()}},[k,j,i,l,o,_,A,C,S]),T=(0,n.useCallback)(()=>{-1===j&&k&&w(k.options.length-1)},[j,k]);if(c){let e=t.questions[0];return(0,s.jsxs)("button",{type:"button",onClick:g,className:"w-full relative z-[5] rounded-2xl p-4 py-3 pb-8 translate-y-5 bg-bg-100/90 backdrop-blur-2xl border-0.5 border-border-300 outline-none flex items-center justify-center gap-2 text-text-300 hover:text-text-100 hover:bg-bg-200/90 transition-colors cursor-pointer",children:[(0,s.jsx)("span",{className:"text-sm font-claude-response flex-1 text-left",children:(null==e?void 0:e.question)||"Questions"}),(0,s.jsx)(x.Z,{size:16,weight:"bold"})]})}return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u(),{id:"1956d758bab51b95",children:"@keyframes bannerSlideIn{0%{transform:translatey(2.5rem);opacity:0}100%{transform:translatey(2rem);opacity:1}}"}),(0,s.jsxs)("div",{ref:b,tabIndex:-1,onKeyDown:I,onFocus:T,"data-ask-user-input-banner":!0,style:{animation:"bannerSlideIn 300ms ease-out forwards"},className:"jsx-1956d758bab51b95 -mx-2 relative z-[5] rounded-2xl pb-12 p-4 bg-bg-100/90 backdrop-blur-2xl border-0.5 border-border-300 outline-none",children:[(0,s.jsx)("button",{type:"button",onClick:_,"aria-label":"Minimize",className:"jsx-1956d758bab51b95 absolute top-3 right-3 p-1.5 rounded-lg text-text-500 hover:text-text-300 hover:bg-bg-300 transition-colors",children:(0,s.jsx)(p.X,{size:16,weight:"bold"})}),k&&(0,s.jsx)(E,{question:k,selections:a.selections[k.id]||[],rankings:a.rankings[k.id]||[],focusedOptionIndex:j,onSelectSingle:e=>l(k.id,e),onToggleMulti:e=>i(k.id,e),onReorder:(e,t)=>r(k.id,e,t),setFocusedOptionIndex:w},k.id),(N||M)&&(0,s.jsxs)("div",{className:"jsx-1956d758bab51b95 mt-4 flex items-center justify-between",children:[M&&(0,s.jsx)("span",{className:"jsx-1956d758bab51b95 text-xs text-text-400",children:(0,s.jsx)(f.A,{defaultMessage:"{current} of {total}",id:"stJYEYsqnV",values:{current:v+1,total:t.questions.length}})}),(0,s.jsx)("div",{className:"jsx-1956d758bab51b95 "+((M?"":"ml-auto")||""),children:C?(0,s.jsx)(m.$,{variant:"primary",onClick:o,disabled:!A,children:(0,s.jsx)(f.A,{defaultMessage:"Submit",id:"wSZR47Y5kj"})}):(0,s.jsx)(m.$,{variant:"primary",onClick:S,disabled:!A,children:(0,s.jsx)(f.A,{defaultMessage:"Next",id:"9+DdtuCqLw"})})})]})]})]})}).displayName="AskUserInputBanner"},0x5e00aadc:(e,t,a)=>{a.d(t,{$z:()=>d,cY:()=>o});var s=a(0x12c9046cd),n=a(0x14de19ae8),l=a(0x9845e38c),i=a(0xac309a83),r=a(0x78b33fbd);function o(){let e=(0,r.useLayer)("frontend"),t=(0,i.fS)("chat_suggestion_chips_enabled"),a=e.get("chat_suggestion_chips",!1);return t||a}function d(e){let{mutateAsync:t,enabled:a}=function(){let{activeOrganization:e}=(0,n.YL)(),t=(0,i.fS)("chat_autocomplete"),a=(0,s.L2)("/api/organizations/".concat(null==e?void 0:e.uuid,"/dust/chat_autocomplete"),"POST",{enabled:t,onError:()=>{l.v.warn(l.u.CHAT_COMPLETION,"Failed to fetch completion")},meta:{noToast:!0}});return{mutateAsync:a.mutateAsync,isPending:a.isPending,isIdle:a.isIdle,enabled:t}}();return{fetchInputAutocompletion:async s=>{if(!a||!e)return"";let[n,l]=(await t({conversationUuid:null!=e?e:"",prompt:s})).prompt.split("\n").map(e=>e.trim());return"Yes"===n?" "===s[s.length-1]?l||"":" "+(l||""):"No"===n&&l||""}}}},0x609a9c34:(e,t,a)=>{a.d(t,{E:()=>s.E});var s=a(0x1b32aa1e2)},0x63f7f562:(e,t,a)=>{a.d(t,{TI:()=>l,dz:()=>i,nQ:()=>r}),a(0x22102fd88);var s=a(0xfc89b4a4);a(0x1449f94a5);let n=(0,s.createContext)({isAppShell:!1});function l(){let{isAppShell:e}=(0,s.useContext)(n);return e}function i(){return l(),"/chat"}function r(){return l(),"/new"}},0x6e0ffcda:(e,t,a)=>{a.d(t,{Kk:()=>j});var s=a(0x22102fd88),n=a(0x14de19ae8),l=a(0x246846ae8),i=a(0x225bae024),r=a(0x22fc8d729),o=a(0x1b813d90),d=a(0x8ee2de7f),c=a(0x7d026653),u=a(0x1a1f6dda6),m=a(0xfc89b4a4),x=a(0x38e6572),p=a(0x1ab0d1ca1),f=a(0x22be9474c),h=a(0xbebfc702),g=a(0x7a7fbf4),b=a(2118184);let v=(0,s.jsx)(x.A,{defaultMessage:"Everyone in your organization can view and use this project",id:"o6dyBu92Ad"}),y=(0,s.jsx)(x.A,{defaultMessage:"Only invited members can view and use this project",id:"r65HKpZU8I"});function j(e){var t,a,j,w,k,C;let{syncSources:M=[],onProjectCreated:N,onError:A,onCancel:S,strings:_}=e,E=(0,p.A)(),I=(0,n.mV)(),T=(0,b.AI)(),{customInstructions:R,type:D,subtype:P}=null!=T?T:{},[F,L]=(0,m.useState)({name:"",description:null!=(t=_.createProjectDescriptionDefault)?t:"",type:D,subtype:P,is_private:!0}),[z,O]=(0,m.useState)({}),[U,Y]=(0,m.useState)(!1),G=M.length>0,H=M.some(e=>e.type===o.v8.GITHUB),q=M.some(e=>e.type===o.v8.GDRIVE),B=H&&q?(0,s.jsx)(x.A,{defaultMessage:"Github and GDrive attachments can only be added to private projects",id:"rqNebqAfPF"}):H?(0,s.jsx)(x.A,{defaultMessage:"Github attachments can only be added to private projects",id:"eyujXWQfg4"}):q?(0,s.jsx)(x.A,{defaultMessage:"GDrive attachments can only be added to private projects",id:"DMBgAV43lL"}):(0,s.jsx)(x.A,{defaultMessage:"Some of these attachments can only be added to private projects",id:"2ssKO1VReL"}),{mutateAsync:K}=(0,h.bL)(),{activeOrganization:V}=(0,n.YL)(),{data:W}=(0,h.BN)(),{data:$,isLoading:J}=(0,h.PL)(),{data:X}=(0,f.q)(),Q=X&&!G,Z=!J&&(null==$?void 0:$.count)===0,ee=e=>t=>{L(a=>({...a,[e]:t.target.value})),O(t=>({...t,[e]:null}))},et=e=>{L(t=>({...t,is_private:e.target.checked&&"private"===e.target.value}))},ea=async e=>{if(e.preventDefault(),!U&&(()=>{let e={};return""===F.name.trim()&&(e.name=E.formatMessage({defaultMessage:"Project name is required",id:"n5cqkMmIMW"})),O(e),0===Object.keys(e).length})()){Y(!0);try{let e={...F};R&&(e.prompt_template=R.replaceAll("{{PROJECT_NAME}}",F.name));let t=await K(e);N(t)}catch(e){A(e)}finally{Y(!1)}}};return(0,s.jsxs)("form",{className:"grid grid-cols-1 gap-4",onSubmit:e=>ea(e),children:[Z&&!T&&(0,s.jsxs)("div",{className:"bg-bg-300 border-border-400/10 text-text-300 flex w-full flex-col items-start justify-start gap-2 rounded-xl border px-5 pb-5 pt-4 text-sm",children:[(0,s.jsx)("div",{className:"flex items-center gap-1 font-medium",children:(0,s.jsx)(x.A,{defaultMessage:"How to use projects",id:"moKJkVk/qB"})}),I?(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)("div",{children:(0,s.jsx)(x.A,{defaultMessage:"Use Projects with your team to do things like:",id:"fcUpqajVgl"})}),(0,s.jsxs)("ul",{className:"list-disc pl-4",children:[(0,s.jsx)("li",{children:(0,s.jsx)(x.A,{defaultMessage:"Query and analyze information about customers, sales calls, and project plans",id:"1YyB53/KOc"})}),(0,s.jsx)("li",{children:(0,s.jsx)(x.A,{defaultMessage:"Upload files from your codebase to understand, improve, and contribute",id:"HXj87AQH0P"})}),(0,s.jsx)("li",{children:(0,s.jsx)(x.A,{defaultMessage:"Generate analysis and reports from one consistent set of materials",id:"3XvEQYrcUv"})}),(0,s.jsx)("li",{children:(0,s.jsx)(x.A,{defaultMessage:"Create content informed by company policies and documentation",id:"HrODk029zr"})})]}),(0,s.jsx)("p",{children:(0,s.jsx)(x.A,{defaultMessage:"Start by creating a memorable title and description to organize your project. You can always edit it later.",id:"qEWJMy5mr7"})})]}):(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)("p",{children:(0,s.jsx)(x.A,{defaultMessage:"Projects help organize your work and leverage knowledge across multiple conversations. Upload docs, code, and files to create themed collections that Claude can reference again and again.",id:"7HFalNigyO"})}),(0,s.jsx)("p",{children:(0,s.jsx)(x.A,{defaultMessage:"Start by creating a memorable title and description to organize your project. You can always edit it later.",id:"qEWJMy5mr7"})})]}),W&&(0,s.jsx)("div",{children:(0,s.jsx)(x.A,{defaultMessage:"Curious to learn more? <link>Try an example project</link>",id:"+AcqvUzRry",values:{link:e=>(0,s.jsx)(r.Y,{href:"/project/".concat(W),children:e})}})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(l.ks,{autoFocus:!0,name:"name",className:"w-full",label:null!=(a=_.createProjectNameLabel)?a:E.formatMessage({defaultMessage:"What are you working on?",id:"R2IogQsIBI"}),placeholder:null!=(j=_.createProjectNamePlaceholder)?j:E.formatMessage({defaultMessage:"Name your project",id:"BtIbm/e/WX"}),size:"lg",onChange:ee("name"),error:!!z.name,"data-1p-ignore":!0}),z.name&&(0,s.jsx)("div",{className:"text-danger-000 mt-1 text-right text-xs font-medium",children:z.name})]}),!T&&(0,s.jsx)("div",{children:(0,s.jsx)(l.fs,{name:"description",className:"w-full",label:null!=(w=_.createProjectDescriptionLabel)?w:E.formatMessage({defaultMessage:"What are you trying to achieve?",id:"RPsTh+NBxY"}),placeholder:null!=(k=_.createProjectDescriptionPlaceholder)?k:E.formatMessage({defaultMessage:"Describe your project, goals, subject, etc...",id:"WStTnUWlP8"}),minRows:3,onChange:ee("description"),error:z.description})}),I?(0,s.jsxs)("fieldset",{children:[(0,s.jsx)("div",{className:"mb-2 text-sm font-medium",children:(0,s.jsx)(x.A,{defaultMessage:"Visibility",id:"JAkIqbzRj5"})}),(0,s.jsxs)("label",{className:(0,u.A)("mb-2 flex w-full gap-2",!Q&&"opacity-40"),children:[(0,s.jsx)("input",{name:"visibility",className:"mt-0.5",type:"radio",value:"open",checked:!F.is_private,onChange:et,disabled:!Q}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsx)(d.m,{size:16,className:"-mt-1 mr-1 inline-block"}),null!=(C=null==V?void 0:V.name)?C:(0,s.jsx)(x.A,{defaultMessage:"Organization",id:"K56Dims7Up"})]}),(0,s.jsx)("div",{className:"text-text-300 text-xs",children:X?G?B:v:(0,s.jsx)(x.A,{defaultMessage:"Public projects are disabled by your organization",id:"c2HBgZtgDR"})})]})]}),(0,s.jsxs)("label",{className:"flex w-full gap-2",children:[(0,s.jsx)("input",{name:"visibility",className:"mt-0.5",type:"radio",value:"private",checked:F.is_private,onChange:et}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsx)(c.W,{size:16,className:"-mt-1 mr-1 inline-block"}),(0,s.jsx)(x.A,{defaultMessage:"Private",id:"viXE3205/2"})]}),(0,s.jsx)("div",{className:"text-text-300 text-xs",children:y})]})]})]}):null,(0,s.jsx)("div",{className:"mt-2 flex justify-end",children:(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(i.$,{onClick:S,href:S?void 0:"/projects",variant:"secondary",disabled:U,children:(0,s.jsx)(x.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})}),(0,s.jsx)(g.i,{children:(0,s.jsx)(i.$,{type:"submit",loading:U,children:(0,s.jsx)(x.A,{defaultMessage:"Create project",id:"VUN1K7kSzC"})})})]})})]})}},0x7050c941:(e,t,a)=>{a.d(t,{V:()=>lE});var s=a(0x22102fd88),n=a(0x628a9a0b),l=a(0x56ac793a),i=a(0x14de19ae8),r=a(0x139b5e710),o=a(0x9845e38c),d=a(0xfc89b4a4),c=a(0xfd34bc37),u=a(0x1065e6d73),m=a(0xac309a83),x=a(0x1888e36ef),p=a(0x1a1f6dda6),f=a(0x160045b25),h=a(0x18c2bb2d),g=a(0x1ab0d1ca1),b=a(0x1e841cc7d),v=a(0x5e00aadc),y=a(0x31c535e9),j=a(0x19e8b6e8),w=a(0xde6c3752),k=a(0x9cb4c2a2),C=a(0x63f7f562);let M=()=>{let e=(0,m.fS)("add_menu_simplification");return(0,C.TI)()||e};function N(e){let{className:t,...a}=e;return(0,s.jsx)("div",{...a,className:(0,p.A)("bg-bg-100 w-full h-2",t)})}function A(e){let{className:t,disabled:a,...n}=e;return(0,s.jsx)("div",{...n,className:(0,p.A)("!box-content flex flex-col bg-bg-000 mx-2 md:mx-0 items-stretch transition-all duration-200 relative z-10 rounded-2xl",a?"cursor-default":"cursor-text",t)})}function S(e){let{className:t,...a}=e;return(0,s.jsx)("fieldset",{...a,className:(0,p.A)("flex w-full min-w-0 flex-col",t)})}let _=(0,d.forwardRef)((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("textarea",{ref:t,...n,className:(0,p.A)("block [outline:none!important] resize-none w-full bg-transparent text-text-100 placeholder:text-text-400",a)})});function E(){return M()?"pl-[6px] pt-[6px]":void 0}function I(e){let{className:t,...a}=e,n=M();return(0,s.jsx)("div",{...a,className:(0,p.A)("flex flex-col m-3.5",n?"gap-3":"gap-3.5",t)})}_.displayName="InputTextarea";var T=a(0x18bfd014),R=a(0x257a56b3),D=a(0x78b33fbd);let P="progressively_enhanced_chat_input",F={isTipTapReady:!1,promptInputSsrEnabled:!1,promptInputSsrTextareaRef:{current:null},handleTipTapReady:()=>{},handleKeyDownCapture:()=>{}};function L(){let e=(0,D.useExperiment)(P),t=(0,C.TI)(),a=e.get("prog_chat_input_enabled",!1),s=t||a;(0,d.useEffect)(()=>{(0,R.xs)(P,void 0,a)},[a]);let n=(0,d.useRef)(null),[l,i]=(0,d.useState)(!1),r=(0,d.useRef)(""),o=(0,d.useRef)(!1),c=(0,d.useRef)(null),u=(0,d.useRef)(new Set);(0,d.useEffect)(()=>{let e=u.current;return()=>{e.forEach(e=>cancelAnimationFrame(e)),e.clear()}},[]);let m=(0,d.useCallback)(e=>{o.current&&(1!==e.key.length||e.ctrlKey||e.metaKey||e.altKey||(r.current+=e.key,e.preventDefault(),e.stopPropagation()))},[]),x=(0,d.useCallback)(e=>{if(!s)return;c.current=e,o.current=!0,r.current="";let t=e=>{let t=requestAnimationFrame(()=>{u.current.delete(t),e()});u.current.add(t)};t(()=>{t(()=>{if(e.isDestroyed){o.current=!1;return}let a=n.current,s=(null==a?void 0:a.value)||"";s&&e.commands.setContent(s),e.commands.focus("end"),t(()=>{o.current=!1;let t=r.current;r.current="",e.isDestroyed||(t&&e.commands.insertContent(t),i(!0))})})})},[s]);return s?{isTipTapReady:l,promptInputSsrEnabled:s,promptInputSsrTextareaRef:n,handleTipTapReady:x,handleKeyDownCapture:m}:F}function z(e){let{promptInputSsrEnabled:t}=L(),a=t?O:d.Fragment;return(0,s.jsx)(a,{children:e.children})}function O(e){return(0,s.jsx)("div",{className:"[grid-area:1/1] min-w-0","data-testid":"chat-input-grid-area",children:e.children})}function U(e){let{promptInputSsrEnabled:t}=L();return t?(0,s.jsx)(Y,{onKeyDownCapture:e.onKeyDownCapture,children:e.children}):(0,s.jsx)(d.Fragment,{children:e.children})}function Y(e){return(0,s.jsx)("div",{className:"grid","data-testid":"chat-input-grid-container",onKeyDownCapture:e.onKeyDownCapture,children:e.children})}var G=a(0xb844abc8);function H(e){let{isNewConversation:t,isAgentMode:a,placeholder:s}=e,n=(0,g.A)();return s||(t?n.formatMessage({defaultMessage:"How can I help you today?",id:"XLcM6WHfQR"}):a?n.formatMessage({defaultMessage:"Reply at any time, even when Claude is working",id:"2eHqp+TzbJ"}):n.formatMessage({defaultMessage:"Reply...",id:"/dm2sj3W5p"}))}function q(e){let{hidden:t,isTipTapReady:a,placeholder:n,placement:l,textareaRef:i,className:r}=e,o=(0,D.useExperiment)("progressively_enhanced_chat_input");return(0,C.TI)()||o.get("prog_chat_input_enabled",!1)?(0,s.jsx)(K,{hidden:t,isTipTapReady:a,placeholder:n,placement:l,textareaRef:i,className:r}):(0,s.jsx)(B,{placement:l})}function B(e){let{placement:t}=e,a=(0,m.fS)("chat-ui-core");return(0,s.jsxs)(S,{"data-testid":"prompt-input-ssr-inert",children:[(0,s.jsx)(A,{className:"bottom"===t?"h-[99px]":"h-[123px]"}),"bottom"===t&&!a&&(0,s.jsx)(N,{})]})}function K(e){let{hidden:t,isTipTapReady:a,placeholder:n,placement:l,textareaRef:i,className:r}=e,o=(0,g.A)(),d=(0,m.fS)("chat-ui-core"),c=E(),u=(0,p.A)("border border-transparent","shadow-[0_0.25rem_1.25rem_hsl(var(--always-black)/3.5%),0_0_0_0.5px_hsla(var(--border-300)/0.15)] hover:shadow-[0_0.25rem_1.25rem_hsl(var(--always-black)/3.5%),0_0_0_0.5px_hsla(var(--border-200)/0.3)] focus-within:shadow-[0_0.25rem_1.25rem_hsl(var(--always-black)/7.5%),0_0_0_0.5px_hsla(var(--border-200)/0.3)] hover:focus-within:shadow-[0_0.25rem_1.25rem_hsl(var(--always-black)/7.5%),0_0_0_0.5px_hsla(var(--border-200)/0.3)]"),x=(0,p.A)("max-h-96 w-full overflow-y-auto font-large break-words transition-opacity duration-200","bottom"===l?"min-h-[1.5rem]":"min-h-[3rem]",c),f=o.formatMessage({defaultMessage:"Write your prompt to Claude",id:"Lxn7p6AQvE"}),h=!(0,G.Fr)(),b=H({placeholder:n,isNewConversation:!0,isAgentMode:!1});return(0,s.jsxs)(S,{"data-testid":"prompt-input-ssr-interactive",inert:!!a||void 0,className:(0,p.A)("relative",t&&"opacity-0 pointer-events-none",r),children:[(0,s.jsx)(A,{className:u,children:(0,s.jsxs)(I,{children:[(0,s.jsx)("div",{className:"relative",children:(0,s.jsx)("div",{className:x,children:(0,s.jsx)(_,{suppressHydrationWarning:!0,autoFocus:h,"data-testid":"chat-input-ssr","aria-invalid":!1,"aria-label":f,"aria-multiline":!0,"aria-required":!1,defaultValue:"",disabled:!1,placeholder:b,ref:i,className:"[field-sizing:content]"})})}),(0,s.jsx)("div",{className:"h-8 w-full","aria-hidden":"true"})]})}),"bottom"===l&&!d&&(0,s.jsx)(N,{})]})}var V=a(0x1c12b3087),W=a(0x114e73153),$=a(0x597e433e),J=a(0x1b813d90),X=a(0x38e6572),Q=a(0x14c0dfde7),Z=a(0x1334f6ecc),ee=a(0x25062734b),et=a(0x18175ce17),ea=a(0x1c03134a9),es=a(0x1e48e639d),en=a(0xe824fb1c),el=a(0x226530adf),ei=a(0x19aca0448),er=a(0x142811145),eo=a(0x1611828d),ed=a(0x1f22b8dda),ec=a(0x4e764078),eu=a(0x225bae024);a(0x20567b754),a(0x2120f5fe0),a(0x14b8da165),a(0x93db382d),a(0x286b4261),a(0xbdad302d),a(0x21687185c);var em=a(0x14a6d5f1),ex=a(0x17cee1991),ep=a(0x19c88845),ef=a(0x1a3383306),eh=a(0x1afb3afe7),eg=a(0x156c4e43b),eb=a(0x1f4bc48d7),ev=a(0xdf883ab6),ey=a(0x213592df7);let ej=e=>{var t,a;let{model:n,projectUuid:l}=e,{allModelOptions:i}=(0,em.A9)(),r=(0,ey.ED)(l),o=(0,ey.Pb)(l),d=null!=(a=null==(t=i.find(e=>e.model===n))?void 0:t.slow_kb_warning_threshold)?a:155e3,c=!o&&(null!=r?r:0)>d?(0,s.jsx)("div",{className:"max-md:hidden",children:(0,s.jsx)(X.A,{defaultMessage:"Large knowledge may slow responses",id:"d6mr4c6d+8"})}):void 0;return(0,s.jsx)("div",{className:"text-text-400 text-xs ml-2",children:null!=c?c:void 0})};var ew=a(0x1ddc8fd3d),ek=a(0x23f1c451b),eC=a(0x1b370f49d),eM=a(0xebbc279e),eN=a(0xa715e9ac),eA=a(0x2307d7eff),eS=a(0xacfa4f6c),e_=a(0xa57595b2),eE=a(0x24b92fff4),eI=a(0x183548b63);let eT=e=>{let{isOpen:t,onClose:a,onConfirm:n,isLoading:l=!1}=e,i=(0,d.useCallback)(e=>{"Enter"!==e.key||l||n()},[n,l]);return(0,d.useEffect)(()=>(t&&window.addEventListener("keydown",i),()=>{window.removeEventListener("keydown",i)}),[t,i]),(0,s.jsxs)(eI.aF,{isOpen:t,onClose:a,title:(0,s.jsx)(X.A,{defaultMessage:"Want to stop researching?",id:"H+/TRHeeuc"}),children:[(0,s.jsx)("div",{className:"mt-4 mb-6",children:(0,s.jsx)(X.A,{defaultMessage:"This canâ€™t be undone. If you want to research this topic again, you can ask in this chat or start a new session.",id:"RuV1dagwp6"})}),(0,s.jsxs)(eI.vW,{children:[(0,s.jsx)(eu.$,{variant:"danger",onClick:n,disabled:l,autoFocus:!0,children:(0,s.jsx)(X.A,{defaultMessage:"Stop research",id:"l3tljn/kXe"})}),(0,s.jsx)(eu.$,{variant:"secondary",onClick:a,children:(0,s.jsx)(X.A,{defaultMessage:"Keep researching",id:"ODR/0L48DC"})})]})]})},eR=e=>{let{isPromptEmpty:t,files:a,attachments:n,syncSourceUuids:l,conversation:i,onSend:r,onStop:o,isSending:d,isDisabled:c,disabledReason:u,currentCompassTask:m,skipInitialAnimation:x=!1,canQueueMessages:p=!1,isNewAgentModeChat:h=!1}=e,g=!t||a.length>0||n.length>0||l.length>0,b=(()=>{if(m)return"researching";if(i){let{isSampling:e,isStoppingSampling:t}=i;if(e)return t?"stopping":"sampling"}return g?"drafting":"empty"})();return(0,s.jsx)(f.N,{children:"sampling"===b||"stopping"===b?(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(eP,{onStop:o,isLoading:"stopping"===b},"stop"),p&&(0,s.jsx)(eL,{isSending:d,isDisabled:c,hasDraftContent:g,onSend:r},"queue")]}):"researching"===b?(0,s.jsx)(eD,{conversationId:null==i?void 0:i.id,taskId:m},"stop_research"):(0,s.jsx)(eF,{isSending:d,isDisabled:c,disabledReason:u,onSend:r,skipInitialAnimation:x,isNewAgentModeChat:h},"send")})},eD=e=>{let{conversationId:t,taskId:a}=e,n=(0,g.A)(),[l,i]=(0,d.useState)(!1),{mutate:r,isPending:o}=(0,eE.hs)(t,null!=a?a:""),c=(0,d.useCallback)(()=>{t&&a&&(r(),i(!1))},[t,a,r]),u=(0,d.useCallback)(()=>{i(!0)},[]);return(0,d.useEffect)(()=>{let e=e=>{"Escape"!==e.key||o||i(!0)};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[o]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eC.m,{tooltipContent:(0,s.jsx)(X.A,{defaultMessage:"Stop Claude response",id:"BonFmr6O3r"}),keyboardShortcut:"Esc",children:(0,s.jsx)(eu.$,{variant:"secondary",size:"icon_sm",className:"!rounded-lg",onClick:u,"aria-label":n.formatMessage({defaultMessage:"Stop response",id:"RANC4/S/j1"}),children:o?(0,s.jsx)(eM.N,{className:"animate-spin",size:18}):(0,s.jsx)(eN.X,{weight:"bold",size:16})})}),(0,s.jsx)(eT,{isOpen:l,onClose:()=>i(!1),onConfirm:c,isLoading:o})]})},eP=e=>{let{onStop:t,isLoading:a}=e,n=(0,g.A)();return(0,d.useEffect)(()=>{let e=e=>{"Escape"!==e.key||a||t()};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[t,a]),(0,s.jsx)(eC.m,{tooltipContent:(0,s.jsx)(X.A,{defaultMessage:"Stop Claude response",id:"BonFmr6O3r"}),keyboardShortcut:"Esc",children:(0,s.jsx)(eu.$,{variant:"secondary",size:"icon_sm",className:"!rounded-lg",onClick:()=>t(),"aria-label":n.formatMessage({defaultMessage:"Stop response",id:"RANC4/S/j1"}),children:a?(0,s.jsx)(eM.N,{className:"animate-spin",size:18}):(0,s.jsx)(eN.X,{weight:"bold",size:16})})})},eF=e=>{let{isSending:t,isDisabled:a,disabledReason:n,onSend:l,skipInitialAnimation:i=!1,isNewAgentModeChat:r=!1}=e,o=(0,g.A)(),c=(0,d.useCallback)(()=>{(0,ek.R)("event","msg_sent",{location:"chat_input"}),l()},[l]);return(0,s.jsx)(h.P.div,{initial:i?{scale:1,opacity:1}:{scale:.3,opacity:0},animate:{scale:1,opacity:1,transition:{delay:.15,scale:{type:"spring",stiffness:600,damping:30},opacity:{duration:.1}}},children:(0,s.jsx)(eC.m,{tooltipContent:n,children:(0,s.jsx)("div",{children:(0,s.jsx)(eu.$,{variant:"claude",size:r?void 0:"icon_sm",className:(0,p.A)("!rounded-lg !h-8 disabled:cursor-default",r?"!px-3 gap-1":"!w-8"),disabled:a,onClick:()=>c(),"aria-label":r?o.formatMessage({defaultMessage:"Start task",id:"6Jb0AX1uQx"}):o.formatMessage({defaultMessage:"Send message",id:"Xx0WZVz8QS"}),children:t?(0,s.jsx)(eM.N,{className:"animate-spin",weight:"bold",size:16}):r?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(X.A,{defaultMessage:"Let's go",id:"wVu1FLTwAn"}),(0,s.jsx)(eA.Q,{weight:"bold",size:16})]}):(0,s.jsx)(eS.D,{weight:"bold",size:16})})})})})},eL=(0,d.memo)(e=>{let{isSending:t,isDisabled:a,hasDraftContent:n,onSend:l}=e,i=(0,g.A)(),r=(0,d.useCallback)(()=>{(0,ek.R)("event","msg_sent",{location:"chat_input"}),l()},[l]);return(0,s.jsx)(h.P.div,{initial:{scale:.3,opacity:0},animate:{scale:1,opacity:1,transition:{delay:.15,scale:{type:"spring",stiffness:600,damping:30},opacity:{duration:.1}}},children:(0,s.jsx)(eC.m,{tooltipContent:i.formatMessage({defaultMessage:"Queue message",id:"UcgUidrDGx"}),children:(0,s.jsxs)(eu.$,{variant:"claude",size:"sm",className:"!rounded-lg gap-1.5",disabled:a||!n,onClick:()=>r(),"aria-label":i.formatMessage({defaultMessage:"Queue message",id:"UcgUidrDGx"}),children:[(0,s.jsx)(e_.L,{weight:"bold",size:16}),t?(0,s.jsx)(eM.N,{className:"animate-spin",size:14}):(0,s.jsx)(X.A,{defaultMessage:"Queue",id:"4YDNPC1W1k"})]})})})});eL.displayName="QueueMessageButton";var ez=a(0x12524db6),eO=a(0x1b09c791a),eU=a(0x1b09b5e10),eY=a(0xad990a54),eG=a(0xe5371ea3),eH=a(0x21cbbfff),eq=a(0x72d3ed73),eB=a(0xbb84ce70),eK=a(0xa6f0de84),eV=a(0x18804ff89),eW=a(0xce472e9e),e$=a(0x23663c967),eJ=a(0x1d1e7ca94),eX=a(0x1c0c7e352),eQ=a(0x2471dc42f);let eZ=e=>{let{onClick:t,checked:a,disabled:n}=e;return(0,s.jsx)("div",{onClick:e=>{e.stopPropagation(),e.preventDefault(),n||t(e)},onPointerDown:e=>{e.stopPropagation()},className:"inline-flex items-center p-0.5 ".concat(n?"cursor-not-allowed":""),children:(0,s.jsx)(eQ.j,{readOnly:!0,size:"small",checked:a,disabled:n,tabIndex:-1})})},e0=["cursor-pointer relative flex items-center justify-between","text-sm min-h-8 px-2 py-1.5 gap-4","group","select-none","rounded-lg","outline-none","data-[disabled]:cursor-not-allowed data-[disabled]:opacity-50","data-[highlighted]:before:content-[' '] data-[highlighted]:before:-z-[1] data-[highlighted]:before:absolute data-[highlighted]:before:inset-0 data-[highlighted]:before:rounded-lg data-[highlighted]:before:bg-bg-200","data-[highlighted]:active:before:!bg-bg-300","[&[data-popup-open]:not([data-highlighted])]:before:content-[' '] [&[data-popup-open]:not([data-highlighted])]:before:-z-[1] [&[data-popup-open]:not([data-highlighted])]:before:absolute [&[data-popup-open]:not([data-highlighted])]:before:inset-0 [&[data-popup-open]:not([data-highlighted])]:before:rounded-lg [&[data-popup-open]:not([data-highlighted])]:before:bg-bg-100"],e1=e=>{if("separator"===e.type){let{className:t,...a}=e;return(0,s.jsx)(eK.w,{className:(0,p.A)("h-[0.5px] bg-border-300 my-1.5 mx-2",t),...a})}if("loading"===e.type)return(0,s.jsxs)("div",{className:"flex items-center gap-2 px-2 py-1.5 min-h-8",children:[(0,s.jsx)(eB.j,{width:20,height:20,rounded:"md"}),(0,s.jsx)(eB.j,{width:96,height:16,rounded:"md"})]});if("search-input"===e.type||"skill"===e.type)return(0,s.jsx)(e2,{...e});let{tooltip:t,...a}=e;return t?(0,s.jsx)(eC.m,{tooltipContent:t,children:(0,s.jsx)(e2,{...a})}):(0,s.jsx)(e2,{...a})},e2=e=>{switch(e.type){case"button":{let{className:t,icon:a,label:n,subtitle:l,suffix:i,onAction:r,...o}=e;return(0,s.jsxs)(eV.D,{...o,onClick:r,className:(0,p.A)(e0,t),children:[(0,s.jsx)(e3,{icon:a,label:n,subtitle:l}),(0,s.jsx)(e4,{suffix:i})]})}case"checkbox":{let{className:t,icon:a,label:n,subtitle:l,suffix:i,onAction:r,...o}=e;return(0,s.jsxs)(eW.s,{...o,onClick:r,className:(0,p.A)(e0,"data-[checked]:text-accent-secondary-100 transition-colors","data-[checked]:data-[highlighted]:before:!bg-accent-secondary-100/10","data-[checked]:data-[highlighted]:active:before:!bg-accent-secondary-100/20",t),children:[(0,s.jsx)(e3,{icon:a,label:n,subtitle:l}),i?(0,s.jsx)(e4,{suffix:i}):(0,s.jsx)(e$.F,{className:"ml-auto size-4 flex items-center justify-center",children:(0,s.jsx)(ep.Check,{})})]})}case"toggle":{let{icon:t,label:a,subtitle:n,suffix:l,onAction:i,checked:r,disabled:o,...d}=e;return(0,s.jsxs)(eV.D,{...d,onClick:i,className:(0,p.A)(e0),disabled:o,children:[(0,s.jsx)(e3,{icon:t,label:a,subtitle:n}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[l&&(0,s.jsx)("div",{children:l}),(0,s.jsx)(eZ,{onClick:()=>null==i?void 0:i(),checked:r,disabled:o})]})]})}case"submenu":{let{align:t="end",alignOffset:a=-8,sideOffset:n=-2,open:l,onOpenChange:i,openOnHover:r,className:o,icon:d,label:c,subtitle:u,suffix:m,items:x,...f}=e;return(0,s.jsxs)(eJ.h,{open:l,onOpenChange:i,openOnHover:r,children:[(0,s.jsxs)(eX.f,{...f,className:(0,p.A)(e0,o),children:[(0,s.jsx)(e3,{icon:d,label:c,subtitle:u}),(0,s.jsxs)("div",{className:"flex items-center gap-2 min-w-0",children:[(0,s.jsx)(e4,{suffix:m}),(0,s.jsx)("div",{className:"size-3",children:(0,s.jsx)(ep.CaretRight,{className:"text-text-500",size:12})})]})]}),(0,s.jsx)(eq.$,{align:t,alignOffset:a,sideOffset:n,className:"max-h-[324px]",children:(0,s.jsx)(eG._,{className:"outline-none",children:x.map((e,t)=>{let a="search-input"===e.type?"search-input-".concat(t):"label"in e?"".concat(e.label,"-").concat(t):t;return(0,s.jsx)(e1,{...e},a)})})})]})}case"search-input":{let{placeholder:t,value:a,onChange:n,onPaste:l,onKeyDown:i,errorMessage:r,inputRef:o,autoFocus:d}=e;return(0,s.jsxs)("div",{className:"mb-1.5 sticky -top-1.5 z-10 bg-bg-000 -mx-1.5 px-1.5 -mt-1.5 pt-1.5",onKeyDown:e=>{["ArrowDown","ArrowUp","Enter","Escape"].includes(e.key)||e.stopPropagation()},children:[(0,s.jsx)("div",{className:(0,p.A)(e0,"cursor-text"),children:(0,s.jsxs)("div",{className:"flex gap-2 truncate items-center flex-1 min-w-0",children:[(0,s.jsx)("div",{className:"size-5 flex items-center justify-center",children:(0,s.jsx)(ep.Search,{size:16,className:"text-text-500"})}),(0,s.jsx)("input",{ref:o,value:a,placeholder:t,className:"w-full bg-transparent border-none text-sm !py-0 !px-0 !h-auto !min-h-0 hide-focus-ring outline-none focus:outline-none focus-visible:outline-none placeholder:text-text-500 ml-0.5",onChange:e=>n(e.target.value),onPasteCapture:l,onKeyDown:i,"data-1p-ignore":!0,autoComplete:"off",autoFocus:d})]})}),r&&(0,s.jsx)("p",{className:"text-xs text-danger-000 mt-1 px-2 pb-2",children:r}),(0,s.jsx)("div",{className:"h-[0.5px] bg-border-300 mt-1.5",style:{marginLeft:8,marginRight:8}})]})}case"skill":{let{className:t,label:a,onAction:n,...l}=e;return(0,s.jsx)(eV.D,{...l,onClick:n,className:(0,p.A)(e0,t),children:(0,s.jsxs)("div",{className:"flex gap-1 items-center truncate",children:[(0,s.jsx)("span",{className:"text-text-100/30",children:"/"}),(0,s.jsx)("span",{className:"truncate",children:a})]})})}}},e5=(0,d.memo)(function(e){let{text:t,className:a}=e,n=(0,d.useRef)(null),[l,i]=(0,d.useState)(!1),r=(0,d.useCallback)(()=>{n.current&&i(n.current.scrollWidth>n.current.clientWidth)},[]),o=(0,s.jsx)("div",{ref:n,className:(0,p.A)("truncate",a),onMouseEnter:r,children:t});return l?(0,s.jsx)(eC.m,{tooltipContent:t,side:"right",align:"start",sideOffset:24,children:o}):o}),e3=e=>{let{icon:t,label:a,subtitle:n}=e;return(0,s.jsxs)("div",{className:(0,p.A)("flex gap-2 truncate",n?"items-start":"items-center"),children:[void 0!==t&&(0,s.jsx)("div",{className:"size-5 flex items-center justify-center",children:t}),(0,s.jsxs)("div",{className:"flex flex-col min-w-0 flex-1",children:[a&&(0,s.jsx)(e5,{text:a}),n&&(0,s.jsx)(e5,{text:n,className:"font-small text-text-500"})]})]})},e4=e=>{let{suffix:t}=e;return t?(0,s.jsx)("div",{className:"min-w-0 truncate flex items-center",onClick:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),children:t}):null};var e8=a(0x17774dcd8),e6=a(0x6aaadcb3),e9=a(0x4d348f95),e7=a(0x17b66474f),te=a(0x1dafb1ccf),tt=a(0x1037073d3),ta=a(0x239a8e4b4),ts=a(0x8475f78a);let tn=eg.YO(eg.Yj()),tl=(e,t)=>{if(0===t.length)return!1;try{let a=new URL(e).hostname;return t.some(e=>a.includes(e))}catch(e){return!1}},ti=e=>{let{intl:t,shouldDisableToggle:a,hasAgentIssues:s,isChromeExtDisabledDueToSettings:n,isChromeExtDisabledDueToModel:l}=e;return a?t.formatMessage({defaultMessage:"Cannot modify connectors while message is processing",id:"dU4vArW8eq"}):s?t.formatMessage({defaultMessage:"This connector has known issues",id:"tI3ocabFQo"}):n?t.formatMessage({defaultMessage:"Enable this MCP in settings",id:"rJ8OY2j2Pd"}):l?t.formatMessage({defaultMessage:"Choose another model",id:"K+LgBlrQZR"}):void 0};var tr=a(0x1d0c32e96);let to=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,g.A)();return(0,d.useMemo)(()=>({disabled:!0,tooltip:t.formatMessage({defaultMessage:"Select a different model to use this feature",id:"/9vSDy2Wm0"}),...e}),[t,e])},td=e=>{let{text:t,className:a,showOnHover:n=!1}=e;return t?(0,s.jsx)("span",{className:(0,p.A)("flex-initial text-right shrink text-ellipsis break-words whitespace-nowrap min-w-0 overflow-hidden font-small text-text-500 !leading-4",n&&"opacity-0 group-hover:opacity-100 transition-opacity",a),children:t}):null};var tc=a(0x21fb79560),tu=a(0x115b4e1b8);let tm=(0,s.jsx)(tr.ft,{size:16}),tx=(0,s.jsx)(tr.HI,{size:16}),tp=(0,s.jsx)(tr.kw,{size:16}),tf="inputMenu",th=e=>{let{overrideCopy:t}=e,a=(0,g.A)();return(0,s.jsx)("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity text-accent-secondary-100 font-small",children:t||a.formatMessage({defaultMessage:"Connect",id:"+vVZ/G11Zg"})})},tg=(0,s.jsx)(ep.Connectors,{}),tb=(0,s.jsx)(ep.Settings,{}),tv=function(){let{includeConnectedOnly:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,g.A)(),a=(0,e9.useRouter)(),{connectedSearchOptions:n,disconnectedSearchOptions:l}=(()=>{let{model:e}=(0,V.TQ)(),{conversation:t}=(0,V.lE)(),a=(0,el.Z3)((null==t?void 0:t.id)||null),n=null!=e?e:a,l=(0,e8.lS)(),i=(e=>{let{currentModel:t}=e,a=(0,g.A)(),n=(0,e9.useRouter)(),{conversation:l}=(0,V.lE)(),i=(0,e8.Ob)(),{toggleSearchTool:r,toggleConversationSetting:o}=(0,tu.D$)(l),d=(0,Z.K6)(),c=(0,em.Wq)()(t,"gsuite_tools"),u=(0,Z.$f)(l),{isDriveAuthenticated:m,initDriveAuth:x}=(0,Z.cI)({callerIdentifier:tf,handleAuthSuccess:()=>{o("enabled_bananagrams",!0)}}),p=(0,et.kO)(),f=(0,et.dJ)(J.v8.GDRIVE),{startAuth:h,authBreakdown:b}=(0,et.ob)(J.v8.GDRIVE,{callerIdentifier:tf,handleAuthSuccess:()=>{o("enabled_foccacia",!0)}}),v=to();if(p&&f&&m||p&&!f||f&&!b.firstParty||!d&&!i)return null;let y={icon:tm,label:a.formatMessage({defaultMessage:"{drive} search",id:"nUykp097rV"},{drive:"Drive"})};if(!d&&i)return{item:{...y,type:"button",suffix:(0,s.jsx)(tc.M,{}),onAction:()=>{n.push("/upgrade")}},isConnected:!1};if(!m){let e=a.formatMessage({defaultMessage:"Connect",id:"+vVZ/G11Zg"}),t=a.formatMessage({defaultMessage:"Reconnect",id:"Eg11ZYmdyO"});return{isConnected:!1,item:{...y,type:"button",suffix:(0,s.jsx)(th,{overrideCopy:p?t:e}),onAction:()=>x(),...p?{tooltip:a.formatMessage({defaultMessage:"Sign back into Google to use our improved connectors",id:"NHTRwY1ogC"})}:{},...c?null:v}}}let j=m&&u;return{isConnected:!0,item:{...y,type:"toggle",checked:j,onAction:()=>{r("enabled_bananagrams",!j)},closeOnClick:!1,...c?null:v}}})({currentModel:n}),r=(e=>{let{currentModel:t}=e,a=(0,g.A)(),n=(0,e9.useRouter)(),{setGmailAuthModalIsOpen:l}=(0,e7.CH)(),{conversation:i}=(0,V.lE)(),r=(0,e8.Ob)(),{toggleSearchTool:o,toggleConversationSetting:c}=(0,tu.D$)(i),u=(0,et.Ys)(J.v8.GMAIL),m=(0,em.Wq)()(t,"gsuite_tools"),x=(0,et.X0)(J.v8.GMAIL,i),p=to(),f=(0,et.vm)(),h=(0,et.dJ)(J.v8.GMAIL),{isAuthenticated:b,startAuth:v,authBreakdown:y}=(0,et.ob)(J.v8.GMAIL,{callerIdentifier:tf,handleAuthSuccess:()=>{c("enabled_sourdough",!0)}}),j=(0,d.useCallback)(()=>{l(!0)},[l]);if(f&&h&&b||f&&!h||f&&!y.firstParty||!u&&!r)return null;let w=a.formatMessage({defaultMessage:"Gmail search",id:"v0qteoUCm+"}),k=a.formatMessage({defaultMessage:"Gmail",id:"2hslSeuDXe"}),C={label:f?k:w,icon:tp};if(!u&&r)return{item:{...C,type:"button",suffix:(0,s.jsx)(tc.M,{}),onAction:()=>{n.push("/upgrade")}},isConnected:!1};if(!b){let e=a.formatMessage({defaultMessage:"Connect",id:"+vVZ/G11Zg"}),t=a.formatMessage({defaultMessage:"Reconnect",id:"Eg11ZYmdyO"});return{isConnected:!1,item:{...C,type:"button",suffix:(0,s.jsx)(th,{overrideCopy:f?t:e}),onAction:()=>{f?v():j()},...f?{tooltip:a.formatMessage({defaultMessage:"Sign back into Google to use our improved connectors",id:"NHTRwY1ogC"})}:{},...m?null:p}}}let M=b&&x;return{isConnected:!0,item:{...C,type:"toggle",checked:M,onAction:()=>{o("enabled_sourdough",!M)},closeOnClick:!1,...m?null:p}}})({currentModel:n}),o=(e=>{let{currentModel:t}=e,a=(0,g.A)(),n=(0,e9.useRouter)(),{conversation:l}=(0,V.lE)(),i=(0,e8.Ob)(),{toggleSearchTool:r,toggleConversationSetting:o}=(0,tu.D$)(l),d=(0,et.Ys)(J.v8.GCAL),c=(0,em.Wq)()(t,"gsuite_tools"),u=(0,et.X0)(J.v8.GCAL,l),m=(0,et.vm)(),x=(0,et.dJ)(J.v8.GCAL),{isAuthenticated:p,startAuth:f,authBreakdown:h}=(0,et.ob)(J.v8.GCAL,{callerIdentifier:tf,handleAuthSuccess:()=>{o("enabled_foccacia",!0)}}),b=to();if(m&&x&&p||m&&!x||m&&!h.firstParty||!d&&!i)return null;let v=a.formatMessage({defaultMessage:"Calendar search",id:"b7aUhdL5nd"}),y=a.formatMessage({defaultMessage:"Google Calendar",id:"kjenxGoM59"}),j={label:m?y:v,icon:tx};if(!d&&i)return{item:{...j,type:"button",suffix:(0,s.jsx)(tc.M,{}),onAction:()=>{n.push("/upgrade")}},isConnected:!1};if(!p){let e=a.formatMessage({defaultMessage:"Connect",id:"+vVZ/G11Zg"}),t=a.formatMessage({defaultMessage:"Reconnect",id:"Eg11ZYmdyO"});return{isConnected:!1,item:{...j,type:"button",suffix:(0,s.jsx)(th,{overrideCopy:m?t:e}),onAction:()=>f(),...m?{tooltip:a.formatMessage({defaultMessage:"Sign back into Google to use our improved connectors",id:"NHTRwY1ogC"})}:{},...c?null:b}}}let w=p&&u;return{isConnected:!0,item:{...j,type:"toggle",checked:w,onAction:()=>{r("enabled_foccacia",!w)},closeOnClick:!1,...c?null:b}}})({currentModel:n});return(0,d.useMemo)(()=>{if(l)return{connectedSearchOptions:[],disconnectedSearchOptions:[]};let e=[],t=[];return i&&(i.isConnected?e.push(i.item):t.push(i.item)),o&&(o.isConnected?e.push(o.item):t.push(o.item)),r&&(r.isConnected?e.push(r.item):t.push(r.item)),{connectedSearchOptions:e,disconnectedSearchOptions:t}},[i,o,r,l])})(),{connectedServers:r,connectingCount:o}=(()=>{var e,t;let a=(0,g.A)(),{conversation:n,model:l}=(0,k.oM)(),r=(0,el.Z3)((null==n?void 0:n.id)||null),o=null!=(t=null!=l?l:null==n?void 0:n.model)?t:r,c=!!((null==n?void 0:n.sessionId)&&(null==n?void 0:n.isSessionActivelyWorking)),u=(0,eo.mL)(),x=(0,m.T9)("yukon_gold_bad","hostnames",[],tn),p=(0,ta.yM)(),f=(0,te.VY)(),{account:h}=(0,i.YL)(),b=(0,y.vP)("enabled_mcp_tools"),v=null==h||null==(e=h.settings)?void 0:e.enabled_mcp_tools,j=(0,d.useMemo)(()=>(null==n?void 0:n.sessionId)?null!=v?v:{}:null!=b?b:{},[null==n?void 0:n.sessionId,v,b]),w=(0,en.Uz)(),{toggleMcpToolEnabled:C}=(0,ee.es)(),M=(0,d.useRef)(null);null===M.current&&(M.current=(0,ts.U6)());let N=M.current;return(0,d.useMemo)(()=>{let e=[],t=0;for(let l of w){var n;if(l.isConnecting){let e=N[l.uuid];(!e||e.isConnected)&&t++;continue}if(!l.isConnected)continue;let i=l.tools.map(e=>e.enabledKey),r=(0,te.Xf)({name:l.name,uuid:l.uuid},o,p,f),d=(0,te.sw)(i,j,r.isChromeExt),m=u&&tl(null!=(n=l.url)?n:"",x),h=ti({intl:a,shouldDisableToggle:c,hasAgentIssues:m,isChromeExtDisabledDueToSettings:r.disabledDueToSettings,isChromeExtDisabledDueToModel:r.disabledDueToModel});e.push({type:"button",label:l.name,icon:(0,s.jsx)(tt.z,{size:16,type:l.iconType,src:l.iconSrc,name:l.name}),disabled:c||r.isDisabled,tooltip:h,suffix:m||r.isDisabled?(0,s.jsx)(ep.Warning,{size:14,className:"text-warning-100"}):(0,s.jsx)(eZ,{onClick:e=>{e.stopPropagation(),c||C(i,!d,l.url)},checked:d,disabled:c}),onAction:()=>{c||r.isDisabled||C(i,!d,l.url)},closeOnClick:!1})}return{connectedServers:e,connectingCount:t}},[w,c,a,C,u,x,N,p,o,j,f])})(),c=(0,d.useCallback)(()=>{(0,e6.G)()?window.open("/settings/connectors","_blank"):a.push("/settings/connectors")},[a]);return{items:(0,d.useMemo)(()=>{let a={type:"button",icon:tb,label:t.formatMessage({defaultMessage:"Manage connectors",id:"cqx+RdJnHp"}),onAction:c},s=n.length>0||r.length>0,i=o>0&&!s?[{type:"loading"}]:[],d=l.length>0,u=o>0;return e?[...n,...r]:[...n,...r,...i,...s&&d?[{type:"separator",label:"separator-connectors-0"}]:[],...l,...s||d||u?[{type:"separator",label:"separator-connectors-1"}]:[],a]},[e,t,c,n,r,o,l]),connectedServerCount:r.length,connectingCount:o,connectedSearchCount:n.length}};var ty=a(0xe0c26d90);let tj=(0,s.jsx)(tr.A9,{type:J.v8.GITHUB,size:20}),tw=(0,s.jsx)(tr.A9,{type:J.v8.GDRIVE,size:16}),tk=(0,s.jsx)(tr.A9,{type:J.v8.GDRIVE,variant:tr.UF.DOCS,size:16});var tC=a(0x14a42df1b),tM=a(0x21d170f9);let tN=(0,s.jsx)(tM.LE,{});var tA=a(0x1cee1d89),tS=a(0x1d302b010);let t_=(0,s.jsx)(ep.Chat,{size:16}),tE=(0,s.jsx)(ep.File,{size:16});var tI=a(0xbebfc702),tT=a(0xd5e0c33c),tR=a(0x1214e4a54);let tD=(0,s.jsx)(ep.Projects,{}),tP=(0,s.jsx)(ep.Add,{}),tF=()=>{let e=(0,g.A)(),t=(0,V.QN)(),a=(0,tT.K)(),{data:s=[]}=(0,tI.CB)({enabled:a,creatorFilter:"is_creator",limit:8}),{data:n=[]}=(0,tI.CB)({enabled:a,creatorFilter:"is_not_creator",limit:8}),l=(0,d.useMemo)(()=>[...s,...n],[s,n]),i=tL(),{setCreateProjectModalIsOpen:r}=(0,e7.CH)();return(0,d.useMemo)(()=>{if(!a)return[];let s=(null==l?void 0:l.slice(0,8).map(e=>({type:"checkbox",label:e.name,subtitle:e.creator.full_name,onAction:()=>void i(e.uuid,e.name),icon:tD,checked:e.uuid===t,closeOnClick:!0})))||[],n={type:"button",icon:tP,label:e.formatMessage({defaultMessage:"Start a new project",id:"0y7bg6nA29"}),onAction:()=>r({isOpen:!0,moveAttachments:!1})};return[...s,...s.length>0?[{type:"separator",label:"projects-separator"}]:[],n]},[a,l,e,t,i,r])},tL=()=>{let{projectUuid:e,conversation:t}=(0,V.lE)(),a=(0,V.EL)(),{moveToProject:s}=(0,tR.j)(),{removeFromProject:n}=(0,tI.nl)();return(0,d.useCallback)(async(l,i)=>{e===l?(null==t?void 0:t.id)?await n([t.id],{showSuccess:!1}):a(void 0):(null==t?void 0:t.id)&&l?await s([t.id],l,i,{enableNavigation:!0}):a(l)},[null==t?void 0:t.id,s,e,n,a])},tz=(0,s.jsx)(ep.Research,{size:20}),tO=()=>{let{conversation:e}=(0,V.lE)(),{model:t}=(0,V.TQ)(),a=(0,y.vP)("compass_mode"),s=(0,eE.g7)(),n=(0,eE.BU)(),l=null!=e?e:void 0,i=(0,eE.Gm)(l),r=(0,el.Z3)((null==e?void 0:e.id)||null),o=(0,eE.G8)()(null!=t?t:r),d=(0,eE.G8)()(r),{canAutoEnableWebSearch:c}=(0,tu.D$)(l),u=(0,e8.lS)(),m=!e&&!o&&d,x=!1,p=!1;return u?x=!0:n&&(i||c)?o||m||(p=!0):x=!0,{checked:"advanced"===a,disabled:x,isModelIncompatible:p,shouldHide:!s,switchToDefaultModelUponEnabling:m,isSessionsChatActive:u,searchToolsAllowed:n,searchToolsEnabled:i,canAutoEnableWebSearch:c}},tU=e=>{let{initialValue:t,switchToDefaultModelUponEnabling:a,isModelIncompatible:s}=e,{conversation:n}=(0,V.lE)(),{setModel:l}=(0,V.TQ)(),i=(0,el.Z3)((null==n?void 0:n.id)||null),r=null!=n?n:void 0,{toggleResearchMode:o}=(0,tu.D$)(r);return(0,d.useCallback)(()=>{s||(a&&l(i),o(!t))},[t,i,l,a,o,s])},tY=()=>{let e=(0,g.A)(),t=to({checked:!1}),{checked:a,disabled:s,isModelIncompatible:n,shouldHide:l,switchToDefaultModelUponEnabling:i,isSessionsChatActive:r,searchToolsAllowed:o,searchToolsEnabled:c,canAutoEnableWebSearch:u}=tO(),m=tU({initialValue:a,switchToDefaultModelUponEnabling:i,isModelIncompatible:n}),x=(0,d.useMemo)(()=>r?e.formatMessage({defaultMessage:"Coming soon",id:"e61Jf3TcmS"}):o?c||u?void 0:e.formatMessage({defaultMessage:"Enable a search integration to use research",id:"WyiVeak7w5"}):e.formatMessage({defaultMessage:"Your administrator must enable a search tool to use research",id:"CzjOV5rgPZ"}),[u,e,r,o,c]);return(0,d.useMemo)(()=>l?null:{type:"checkbox",label:e.formatMessage({defaultMessage:"Research",id:"JEe7dVso7F"}),icon:tz,checked:a,disabled:s,tooltip:x,onAction:m,closeOnClick:!0,...n?{...t,checked:!1}:{}},[l,e,a,s,x,m,n,t])};var tG=a(0x18312bc5b),tH=a(0xf32c56dd),tq=a(0x1bd175d8c),tB=a(0x253a5c787);let tK=(0,s.jsx)(ep.Camera,{}),tV=()=>{let e=(0,g.A)(),t=(0,tq.V)(),{addError:a}=(0,r.Yf)(),{handleUpload:s}=(0,k.oM)(),n=(0,tH.st)(),l=(0,d.useCallback)(async()=>{n.track({event_key:"claudeai.plus_menu.screenshot_clicked"});let t=null;try{t=await (0,tG.N)({width:1568,height:1568})}catch(t){(0,tB.Cp)(t),a(e.formatMessage({defaultMessage:"Could not capture screen.",id:"uGOETn5bfV"}),{error:t,messageForLogging:"Could not capture screen"})}if(!t)return;let l=new File([await fetch(t.imageDataUrl).then(e=>e.blob())],"screenshot.png",{type:"image/png"});await s([l])},[n,a,e,s]);return(0,d.useMemo)(()=>t||(0,G.fJ)()?null:{type:"button",label:e.formatMessage({defaultMessage:"Take a screenshot",id:"aTaOpCB71M"}),icon:tK,onAction:l},[e,t,l])};var tW=a(0x252daebb2),t$=a(0x1e61aab5a),tJ=a(0x1fb2770f2),tX=a(0x6b95b9a1);let tQ=(0,s.jsx)(ep.Styles,{}),tZ=(0,s.jsx)(ep.Add,{}),t0=()=>{let e=(0,g.A)(),t=(()=>{let e=(0,g.A)(),t=(0,tH.st)(),{personalizedStyle:a,setPersonalizedStyle:s}=(0,V.RK)(),{personalizedStyleOptions:n,setStoredStyle:l}=(0,tJ.p)(),{setStyleModalOpenWithScreen:i}=(0,e7.CH)(),r=(0,d.useCallback)(e=>{let a=n.find(t=>t.key===e);if(!a)return;s(a);let i=(0,tX.X)(a);l({styleKey:i,timestamp:new Date}),t.track({event_key:"styles.selected",style_key:i})},[t,n,s,l]),o=(0,d.useCallback)(()=>{i(t$.I.LIST)},[i]),c=(0,d.useMemo)(()=>n.map(t=>{let s=(null==a?void 0:a.key)===t.key;return{type:"checkbox",label:"default"===t.type&&t.nameKey?(0,tW.fl)({id:t.nameKey,intl:e}):t.name,icon:tQ,onAction:()=>{s?r("Default"):r(t.key)},checked:s,closeOnClick:!0}}),[r,e,a,n]);return(0,d.useMemo)(()=>[...c,{type:"separator",label:"styles-separator"},{type:"button",icon:tZ,label:e.formatMessage({defaultMessage:"Create & edit styles",id:"cY+Fgc8HvE"}),onAction:o}],[e,o,c])})(),a=e.formatMessage({defaultMessage:"Use style",id:"f7VY0ldE+0"});return(0,d.useMemo)(()=>({type:"submenu",icon:tQ,label:a,items:t}),[a,t])};var t1=a(0x1e9786782),t2=a(0x654fb8f7);let t5=(0,s.jsx)(ep.Attachment,{}),t3=e=>{let t=(0,g.A)(),a=(0,d.useCallback)(()=>(0,t2.U)(e),[e]),{shortcutString:n}=(0,er.wk)("file_upload"),l=(0,t1.w)(n);return(0,d.useMemo)(()=>({type:"button",label:t.formatMessage({defaultMessage:"Add files or photos",id:"0S+iNJivmx"}),icon:t5,onAction:a,suffix:(0,s.jsx)(td,{text:l,showOnHover:!0})}),[t,a,l])};var t4=a(0x3769f4df);let t8=(0,s.jsx)(ep.Globe,{}),t6=()=>{let e,t,a=(0,g.A)(),n=to(),{checked:l,disabled:i,isModelIncompatible:r,shouldShowUpsell:o,isEnabledForOrg:c,shouldHide:u}=(()=>{let{conversation:e}=(0,V.lE)(),t=(0,t4.fy)(e),{model:a}=(0,V.TQ)(),s=(0,el.Z3)((null==e?void 0:e.id)||null),n=(0,t4.Eu)(null!=a?a:s),l=(0,e8.Ob)(),i=(0,t4.be)(),r=(0,t4.WJ)(),o=!i&&l,d=t&&n,c=!1,u=!1;return o?d=!1:r?n||(u=!0):c=!0,{checked:d,disabled:c,isModelIncompatible:u,shouldShowUpsell:o,isEnabledForOrg:r,shouldHide:!i&&!l}})(),m=(e=>{let{checked:t,shouldShowUpsell:a}=e,s=(0,e9.useRouter)(),{conversation:n}=(0,V.lE)(),{toggleSearchTool:l}=(0,tu.D$)(n);return(0,d.useCallback)(()=>{if(a)return s.push("/upgrade");l("enabled_web_search",!t)},[t,s,a,l])})({checked:l,shouldShowUpsell:o});return o?t=(0,s.jsx)(tc.M,{}):c||(e=a.formatMessage({defaultMessage:"This feature has been disabled by your administrator.",id:"Jpvq2WYysx"})),(0,d.useMemo)(()=>u?null:{type:"checkbox",label:a.formatMessage({defaultMessage:"Web search",id:"x0W7xxxEcv"}),icon:t8,checked:l,disabled:i,onAction:m,tooltip:e,suffix:t,closeOnClick:!0,...r?n:{}},[u,a,l,i,m,e,t,r,n])},t9=e=>{let{trigger:t,chatInputPlacement:a,disabled:n}=e,l=(0,d.useCallback)((e,a)=>t||(0,s.jsx)(ae,{...e,disabled:n}),[t,n]);return(0,s.jsxs)(eU.i,{children:[(0,s.jsx)(eY.c,{render:l}),(0,s.jsx)(eq.$,{align:"start",alignOffset:-10,side:"bottom",sideOffset:4,children:(0,s.jsxs)(eG._,{className:"outline-none",children:[(0,s.jsx)(eH.J,{}),(0,s.jsx)(t7,{chatInputPlacement:a})]})})]})},t7=e=>{let{chatInputPlacement:t}=e,a=(e=>{let{placement:t}=e,a=(0,e8.lS)(),n=t3(t),l=tV(),i=(()=>{let e=(0,g.A)(),t=(()=>{let{addError:e}=(0,r.Yf)(),{setIsUploadingDriveSync:t}=(0,V.fT)(),{setSyncSourceUuids:a}=(0,V.lE)(),{mutate:s}=(0,b.EF)({onMutate:()=>{t(!0)},onSuccess:e=>{t(!1),a(t=>[...t,e.uuid])},onError:a=>{t(!1),e((0,es.J)(a),{error:a,errorContext:{tags:{source:"chat_input_drive_sync_create"}}})},meta:{noToast:!0}});return e=>s({sync_source_type:J.v8.GDRIVE,sync_source_config:{uri:e}})})(),a=(0,Z.LP)(),{isDriveAuthenticated:s}=(0,Z.cI)(),{recentDriveDocs:n,isLoading:l}=(0,Z.zH)(!0),i=(0,d.useMemo)(()=>({icon:tw,label:e.formatMessage({defaultMessage:"Add from {drive}",id:"hwJ50OkM/9"},{drive:"Google Drive"})}),[e]),o=(0,d.useMemo)(()=>l?[{type:"button",label:e.formatMessage({defaultMessage:"{drive} documents loading...",id:"PjuSZ/7RIb"},{drive:"Drive"}),disabled:!0}]:n.length?n.slice(0,8).map(e=>{var a;return{type:"button",label:null!=(a=e.title)?a:"Untitled",icon:tk,onAction:()=>t(e.uri)}}):[{type:"button",label:e.formatMessage({defaultMessage:"No recent {drive} documents",id:"XepM9W1Mo/"},{drive:"Drive"}),disabled:!0}],[t,e,l,n]);return(0,d.useMemo)(()=>a&&s?{...i,type:"submenu",items:o,align:"start"}:null,[i,s,a,o])})(),o=(0,et.kO)(),c=(()=>{let e=(0,g.A)(),t=(0,ty.Cq)(),{isGithubAuthenticated:a}=(0,ty.nB)({fetchImmediately:!0}),{setGithubModalIsOpen:s}=(0,e7.CH)(),n=(0,d.useCallback)(()=>{s(!0)},[s]);return(0,d.useMemo)(()=>t&&a?{type:"button",icon:tj,label:e.formatMessage({defaultMessage:"Add from {github}",id:"h3J3E4bRfj"},{github:"GitHub"}),onAction:n}:null,[e,a,n,t])})(),u=(()=>{let e=(0,g.A)(),t=(0,en.Uz)(),a=(0,d.useRef)(null);null===a.current&&(a.current=(0,ts.U6)());let{connectedServers:n,placeholderConnectors:l}=(0,d.useMemo)(()=>{var e;let s=null!=(e=a.current)?e:{};return{connectedServers:t.filter(e=>e.isConnected&&(e=>{var t,a;return((null==(t=e.prompts)?void 0:t.length)||0)>0||((null==(a=e.resources)?void 0:a.filter(e=>e.mimeType!==tA.ls).length)||0)>0})(e)),placeholderConnectors:t.filter(e=>{var t,a;return e.isConnecting&&(null==(t=s[e.uuid])?void 0:t.isConnected)&&(null==(a=s[e.uuid])?void 0:a.hasPromptsOrResources)})}},[t]),i=(0,tS.R4)(),r=(0,tS.vW)(),{setCreatePromptArgumentModalIsOpen:o}=(0,e7.CH)(),[c,u]=(0,d.useState)({}),m=(0,d.useRef)({}),x=(0,d.useRef)({}),p=(0,d.useCallback)((e,t)=>{o({isOpen:!0,serverUuid:e,prompt:t})},[o]),f=(0,d.useCallback)((e,t)=>{u(a=>({...a,[e]:t}))},[]),h=(0,d.useCallback)((e,t,a)=>{let s=c[e]||"";if("ArrowLeft"===t.key&&s)t.stopPropagation();else if("ArrowDown"===t.key&&a){var n;t.preventDefault(),t.stopPropagation(),null==(n=x.current[e])||n.focus()}},[c]);return(0,d.useMemo)(()=>[...n.map(t=>{let a=c[t.uuid]||"",n=t.resources.filter(e=>e.mimeType!==tA.ls),l=n.length>0,o=t.prompts.filter(e=>{var t,s;if(!a)return!0;let n=a.toLowerCase(),l=(null==(t=e.name)?void 0:t.toLowerCase())||"",i=(null==(s=e.description)?void 0:s.toLowerCase())||"";return l.includes(n)||i.includes(n)}),d=o.map(e=>({type:"button",icon:t_,label:e.displayName,onAction:()=>{var a;return(null==(a=e.arguments)?void 0:a.length)?p(t.uuid,e):void r({serverUuid:t.uuid,prompt:e,args:{}})}})),u=l?n.filter(e=>{var t,s,n;if(!a)return!0;let l=a.toLowerCase(),i=(null==(t=e.name)?void 0:t.toLowerCase())||"",r=(null==(s=e.description)?void 0:s.toLowerCase())||"",o=(null==(n=e.uri)?void 0:n.toLowerCase())||"";return i.includes(l)||r.includes(l)||o.includes(l)}):[],g=u.map((e,a)=>({type:"button",icon:tE,label:e.displayName,onAction:()=>void i({serverUuid:t.uuid,resource:e}),ref:0===a?e=>{x.current[t.uuid]=e}:void 0,onKeyDown:e=>{if("ArrowUp"===e.key&&0===a){var s;e.preventDefault(),null==(s=m.current[t.uuid])||s.focus()}}})),b=[];if(l){var v;b.push({type:"search-input",placeholder:e.formatMessage({defaultMessage:"Search...",id:"0BUTMvePvK"}),label:e.formatMessage({defaultMessage:"Search",id:"xmcVZ0BU63"}),value:a,onChange:e=>f(t.uuid,e),onKeyDown:e=>h(t.uuid,e,u.length>0||o.length>0),inputRef:{current:null!=(v=m.current[t.uuid])?v:null},autoFocus:!0})}return b.push(...d),l&&(u.length>0?b.push(...g):a&&0===o.length&&b.push({type:"button",label:e.formatMessage({defaultMessage:"No results",id:"jHJmjfxD4s"}),disabled:!0})),{type:"submenu",label:e.formatMessage({defaultMessage:"Add from {server}",id:"qEj6u51OfR"},{server:t.name}),icon:(0,s.jsx)("div",{className:"flex justify-center items-center size-5",children:(0,s.jsx)(tt.z,{size:16,type:t.iconType,src:t.iconSrc,name:t.name})}),items:b,align:"start"}}),...l.map(t=>({type:"submenu",label:e.formatMessage({defaultMessage:"Add from {server}",id:"qEj6u51OfR"},{server:t.name}),icon:(0,s.jsx)("div",{className:"flex justify-center items-center size-5",children:(0,s.jsx)(tt.z,{size:16,type:t.iconType,src:t.iconSrc,name:t.name})}),items:[{type:"loading"}],align:"start"}))].sort((e,t)=>{var a,s;return(null!=(a=e.label)?a:"").localeCompare(null!=(s=t.label)?s:"")}),[r,i,n,h,f,e,p,l,c])})(),m=(()=>{let{haystackProject:e,checked:t,shouldHide:a,disabled:s}=(()=>{let{haystackProject:e}=(0,ez.Sc)(),t=(0,V.QN)(),a=(0,ez.C0)(),s=(0,ez._Y)(),n=t===(null==e?void 0:e.uuid);return{haystackProject:e,checked:n,shouldHide:!e||!a,disabled:s}})(),n=(0,tC.$V)(),l=(0,ez.Af)(),i=(0,d.useCallback)(()=>{e&&n(e.uuid)},[e,n]);return(0,d.useMemo)(()=>a?null:{type:"checkbox",label:l,icon:tN,checked:t,onAction:i,disabled:s,closeOnClick:!0},[a,t,s,l,i])})(),x=tY(),p=t6(),f=(()=>{let e=(0,en.Q1)(),{items:t,connectedServerCount:a,connectingCount:s,connectedSearchCount:n}=tv(),l=e&&!(a>0||s>0||n>0),i=n>0||a>0||s>0,{setMcpDirectoryModalIsOpen:r}=(0,e7.tl)(),o=(0,g.A)(),c=(0,d.useCallback)(()=>{r(!0)},[r]);return(0,d.useMemo)(()=>l?{type:"loading"}:i?{type:"submenu",label:o.formatMessage({defaultMessage:"Connectors",id:"2mMJRvsAg1"}),icon:tg,items:t}:{type:"button",label:o.formatMessage({defaultMessage:"Add connectors",id:"2dXigF1Pil"}),icon:tg,onAction:c},[l,i,o,c,t])})(),h=(()=>{let e=(0,g.A)(),{isProjectLocked:t}=(0,V.Jy)(e=>({isProjectLocked:e.isProjectLocked})),a=(0,tT.K)(),s=(()=>{let e=(0,e9.usePathname)();return"string"==typeof e&&e.startsWith("/project/")})(),n=tF(),l=e.formatMessage({defaultMessage:"Add to project",id:"+mqxxzVczn"});return(0,d.useMemo)(()=>t||!a||s?null:{type:"submenu",icon:tD,label:l,items:n},[t,a,s,l,n])})(),v=t0();return(0,d.useMemo)(()=>{let e=f?[f]:[],t=[...h?[h]:[],...i&&!o?[i]:[],...c?[c]:[],...u.length>0?u:[],{type:"separator",label:"separator-1"},...m?[m]:[],...x?[x]:[],...p?[p]:[],...v?[v]:[]];return a?[n,...l?[l]:[],...e]:[n,...l?[l]:[],...t,...e]},[n,l,h,i,c,u,m,x,p,f,v,o,a])})({placement:t});return(0,s.jsx)(s.Fragment,{children:a.map((e,t)=>{let a="search-input"===e.type?"search-input-".concat(t):"label"in e?"".concat(e.label,"-").concat(t):t;return(0,s.jsx)(e1,{...e},a)})})},ae=e=>{let{disabled:t,...a}=e,n=(0,g.A)(),l=n.formatMessage({defaultMessage:"Add files, connectors, and more",id:"ITCmbu5TgN"}),i=n.formatMessage({defaultMessage:"Toggle menu",id:"NuF5YcKWhi"});return(0,s.jsx)(eC.m,{tooltipContent:l,side:"bottom",delayDuration:0,keyboardShortcut:"/",children:(0,s.jsx)(eu.$,{...a,"aria-label":i,className:"!rounded-lg hover:!bg-bg-200 aria-expanded:!bg-bg-300 active:!scale-100 ml-[2px]",size:"icon_sm",variant:"ghost",disabled:t,children:(0,s.jsx)(ep.Add,{})})})};var at=a(0x14023fbb8),aa=a(0x8774d407),as=a(0x18f9bc151);let an=e=>{let{remaining:t,total:a}=e;return(0,s.jsxs)("span",{className:"inline-flex items-center gap-0.5 text-accent-secondary-100 bg-bg-000 border-0.5 border-border-300 rounded-full px-2 py-0.5 text-xs ml-1",children:[(0,s.jsx)("span",{children:t}),(0,s.jsx)("span",{children:"/"}),(0,s.jsx)("span",{children:a})]})};var al=a(0x1d1a079e9);let ai={legacy:{border:"border-0.5",active:"text-accent-secondary-100 bg-accent-secondary-100/[8%] border-accent-secondary-200/20",inactive:"text-text-300 border-border-300",activeHover:"hover:text-accent-secondary-000 hover:bg-accent-secondary-100/[12%]",inactiveHover:"hover:text-text-200/90 hover:bg-bg-100"},simplified:{border:"",active:"text-accent-secondary-100 bg-accent-secondary-100/[8%]",inactive:"text-text-300",activeHover:"hover:text-accent-secondary-000 hover:bg-accent-secondary-900",inactiveHover:"hover:text-text-200/90 hover:bg-bg-200"}},ar=d.forwardRef((e,t)=>{let{indicatorActive:a,disabled:n,text:l,tag:i,className:r,buttonClassName:o,tooltip:d,tooltipShortcut:c,hideIndicatorText:u,icon:m,showRemoveIcon:x,showCaretIcon:f,limitInfo:g,layoutId:b,...v}=e,y=M(),j=y?ai.simplified:ai.legacy,w=g?(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[m,(0,s.jsx)(an,{remaining:g.remaining,total:g.total})]}):m,k=(0,s.jsx)(h.P.div,{layoutId:b,className:(0,p.A)("flex",l?"shrink min-w-8":"shrink-0",r),initial:y?{opacity:0}:{opacity:0,scale:.6},animate:y?{opacity:1}:{opacity:1,scale:1},exit:y?{opacity:0}:void 0,transition:y?{duration:.075,delay:.05,ease:"easeOut"}:{type:"spring",stiffness:700,damping:32,mass:.7},children:(0,s.jsxs)("button",{className:(0,p.A)(j.border,"transition-all h-8 flex items-center group !pointer-events-auto !outline-offset-1 overflow-hidden px-1.5",u||!l?"min-w-8 rounded-lg justify-center":"min-w-8 rounded-lg",a?j.active:j.inactive,!n&&(a?j.activeHover:j.inactiveHover),!n&&"active:scale-[0.98]",n&&"opacity-50 cursor-not-allowed",o),disabled:n,"aria-pressed":a,"aria-label":d,...v,children:[w,!!l&&!u&&(0,s.jsxs)("div",{className:"min-w-0 flex items-center",children:[(0,s.jsx)("p",{className:"min-w-0 pl-1 text-xs text-ellipsis whitespace-nowrap break-words overflow-hidden shrink",children:l}),!!i&&(0,s.jsx)(al.u,{tag:i,className:"!top-0 !ml-1"})]}),f&&(0,s.jsx)(as.a,{size:12,className:"ml-1 opacity-70"}),!n&&x&&(0,s.jsx)("div",{className:"duration-100 w-0 group-hover:w-3 opacity-0 group-hover:opacity-100 transition-all ml-0 group-hover:ml-0.5 group-hover:mr-1",children:(0,s.jsx)(ep.XSmall,{})})]})},b);return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(eC.m,{tooltipContent:d,disableHoverableContent:!0,side:"bottom",align:"center",keyboardShortcut:c,children:k})})});ar.displayName="InputMenuButton";let ao=e=>{let{onClick:t,indicatorActive:a,disabled:n,...l}=e;return!a||n?null:(0,s.jsx)(ar,{onClick:t,indicatorActive:a,disabled:n,showRemoveIcon:!0,...l})},ad=(0,s.jsx)(ep.Owl,{}),ac=(0,s.jsx)(ep.Research,{size:20}),au=(0,s.jsx)(ep.Projects,{}),am=(0,s.jsx)(tM.LE,{}),ax=(0,s.jsx)(ep.Styles,{}),ap=e=>{let{hideIndicators:t}=e,a=M();return t?null:(0,s.jsx)(aa.o,{children:(0,s.jsx)("div",{className:(0,p.A)("flex flex-row items-center min-w-0",a?"gap-1":"gap-2"),children:(0,s.jsxs)(f.N,{children:[(0,s.jsx)(af,{},"research"),(0,s.jsx)(ah,{},"project"),(0,s.jsx)(ag,{},"style")]})})})},af=()=>{let e=(0,g.A)(),t=M(),{checked:a,disabled:n,shouldHide:l,switchToDefaultModelUponEnabling:i,isModelIncompatible:r}=tO(),o=tU({initialValue:a,switchToDefaultModelUponEnabling:i,isModelIncompatible:r});return l?null:(0,s.jsx)(ao,{indicatorActive:a,disabled:n,onClick:o,icon:t?ac:ad,tooltip:e.formatMessage({defaultMessage:"Research mode",id:"lYf0AUt2RH"}),hideIndicatorText:!0,layoutId:"research-indicator"})},ah=()=>{let e=(0,V.QN)(),{conversation:t}=(0,V.lE)(),a=(0,V.EL)(),{removeFromProject:n,isRemovingConversation:l}=(0,tI.nl)(),{data:i}=(0,tI.fo)(e),r=(0,ez.Lq)(),o=(0,e9.usePathname)().includes("/project/"),d=(0,ez._Y)();if(o)return null;let c=!r||!d,u=null!=t&&!!t.id&&l(t.id),m=async()=>{e&&!u&&c&&((null==t?void 0:t.id)?await n([t.id]).catch(()=>{}):a(void 0))};return d?(0,s.jsx)(ar,{indicatorActive:!0,showRemoveIcon:c,disabled:!0,hideIndicatorText:!0,icon:am,tooltip:null==i?void 0:i.name,layoutId:"project-indicator"}):(0,s.jsx)(ao,{indicatorActive:!!e,hideIndicatorText:!0,icon:u?(0,s.jsx)(at.R,{size:"sm",inheritColor:!0}):r?am:au,showRemoveIcon:c,onClick:m,disabled:u,tooltip:null==i?void 0:i.name,layoutId:"project-indicator"})},ag=()=>{let{personalizedStyle:e,setPersonalizedStyle:t}=(0,V.RK)(),{defaultStyle:a,personalizedStyleOptions:n,clearStoredStyle:l}=(0,tJ.p)(),i=!!(e&&e.key!==(null==a?void 0:a.key));return(0,s.jsx)(ao,{indicatorActive:i,hideIndicatorText:!0,icon:ax,onClick:()=>{let e=n.find(e=>"Default"===e.key)||a;e&&t(e),l()},tooltip:null==e?void 0:e.name,layoutId:"style-indicator"})};var ab=a(0x17f3a2521);let av=e=>{let{menuItem:t,handleClick:a,limitInfo:n,disabled:l,...i}=e,{handleClickItem:r}=(0,e7.CH)();if(!t||t.isDisabled||"pro"===t.tag||"new chat"===t.tag||!t.indicatorActive)return null;let{indicatorActive:o}=t,d=l||!!t.menuItemHidden,c=n?(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[i.icon,(0,s.jsx)(an,{remaining:n.remaining,total:n.total})]}):i.icon;return(0,s.jsx)(ar,{onClick:null!=a?a:()=>r(t),indicatorActive:o,disabled:d,showRemoveIcon:!0,...i,icon:c})},ay=e=>{let{hideIndicatorText:t,hideIndicators:a}=e,n=(0,g.A)();return a?null:(0,s.jsx)(aa.o,{children:(0,s.jsxs)("div",{className:"flex flex-row items-center gap-2 min-w-0",children:[(0,s.jsx)(aj,{itemKey:ab.xd.COMPASS,tooltip:n.formatMessage({defaultMessage:"Research mode",id:"lYf0AUt2RH"})}),(0,s.jsx)(aw,{hideIndicatorText:t}),(0,s.jsx)(ak,{hideIndicatorText:t})]})})},aj=e=>{let{itemKey:t,tooltip:a}=e,{menuView:{rootItems:n}}=(0,e7.CH)(),{menuView:{rootItems:l}}=(0,e7.tl)(),i=[...n,...l].find(e=>e.key===t);return i?(0,s.jsx)(av,{hideIndicatorText:!0,menuItem:i,icon:i.icon,tooltip:a}):null},aw=e=>{let{hideIndicatorText:t}=e,{menuView:{rootItems:a}}=(0,e7.tl)(),n=(0,tC.pi)(),l=a.find(e=>"styles"===e.key);return l&&"optionGroup"===l.type?(0,s.jsx)(av,{hideIndicatorText:t,menuItem:l,icon:(0,s.jsx)(ep.Styles,{size:16}),text:l.secondaryText,buttonClassName:"!shrink",handleClick:()=>n("Default")}):null},ak=e=>{let{hideIndicatorText:t}=e,{menuView:{rootItems:a}}=(0,e7.CH)(),n=(0,V.QN)(),{conversation:l,setProjectUuid:i,isProjectLocked:r,isNewConversation:o}=(0,k.oM)(),{removeFromProject:d,isRemovingConversation:c}=(0,tI.nl)(),u=a.find(e=>e.key===ab.xd.PROJECTS);if(!u||"optionGroup"!==u.type||r&&o)return null;let m=null!=l&&!!l.id&&c(l.id),x=async()=>{n&&!m&&((null==l?void 0:l.id)?await d([l.id]):i(void 0))};return(0,s.jsx)(av,{"data-testid":"projects-indicator",hideIndicatorText:t,menuItem:u,icon:m?(0,s.jsx)(at.R,{size:"sm",inheritColor:!0}):(0,s.jsx)(ep.Projects,{size:16}),text:u.secondaryText,buttonClassName:"!shrink-[2]",handleClick:()=>x(),disabled:m})},aC=e=>{let{style:t,children:a,duration:n=200,delay:l=0,easing:i="ease-in-out",className:r="",onTransitionEnd:o=()=>void 0}=e,c=(0,d.useRef)(null),[u,m]=(0,d.useState)("auto"),x=(0,d.useRef)(null);return(0,d.useEffect)(()=>{if(c.current)return x.current=new ResizeObserver(e=>{for(let t of e){let e=t.contentRect.height;m("".concat(e,"px"))}}),x.current.observe(c.current),()=>{x.current&&x.current.disconnect()}},[]),(0,s.jsx)("div",{style:{height:u,transitionDelay:"".concat(l,"ms"),transitionTimingFunction:i,transitionDuration:"".concat(n,"ms"),transitionProperty:"height",...t},className:r,onTransitionEnd:()=>{o()},children:(0,s.jsx)("div",{className:"w-full",ref:c,children:a})})};var aM=a(0x31075f4f),aN=a(0x5a5d1f8b),aA=a(0x12d9a90e8),aS=a(0xd236a749),a_=a(0x1f4f9b2db),aE=a(0xfce0e9a4),aI=a(0x1e6127894);let aT=e=>{let{path:t}=e,a={drive:(0,g.A)().formatMessage({defaultMessage:"Paste a Drive link in the chat to upload it",id:"ZJxjEilF0C"})},n=t&&t in a?a[t]:null;return n?(0,s.jsxs)("div",{className:"w-full bg-bg-100 border-t-0.5 border-border-300 opacity-80 text-text-500 flex flex-row items-center gap-2.5 px-3 py-1 font-small",children:[(0,s.jsx)(aI.R,{size:14}),n]}):null};var aR=a(0x17ced59d0),aD=a(0x88148a10),aP=a(0xbd872f26);let aF=e=>{let{tooltip:t,text:a,tag:n,showCaretIcon:l,indicatorActive:i=!1,hideIndicatorText:r,canShowDot:o,onDoubleClick:c,menuType:u,menuView:m,inputMenuIsOpen:x,setInputMenuIsOpen:p,disabled:f,disabledTooltip:b}=e,v=(0,g.A)(),y=(0,d.useRef)(null),{rootItems:j}=m,w={indicatorActive:i,text:a||"",tooltip:t},k=(0,e8.gB)(),C="tools"===u&&k;if(f&&b)w.tooltip=b;else if(C){w.tooltip=v.formatMessage({defaultMessage:"Style",id:"7mL9QEUFav"});let e=j.find(e=>"option"===e.type&&e.isChecked);e&&"Default"!==e.key&&(w.indicatorActive=!0,w.text=e.label)}let M=j.filter(e=>{let{indicatorActive:t}=e;return t}).length,N=(0,s.jsxs)("div",{className:"flex flex-row items-center justify-center gap-1",children:["plus"===u?(0,s.jsx)(h.P.div,{animate:{rotate:45*!!x},transition:{type:"spring",stiffness:650,damping:32,duration:.1},children:(0,s.jsx)(aD.F,{size:16})}):"research"===u?(0,s.jsx)(ep.Research,{size:16}):C?(0,s.jsx)(ep.Styles,{size:16}):(0,s.jsx)(aP.l,{size:16}),(0,s.jsx)(aL,{isShown:o&&M>0})]}),A="plus"===u?v.formatMessage({defaultMessage:"attachments",id:"whkEDsy4V6",description:"Menu heading that will be used within the string â€˜Open {menuType} menuâ€™"}):"research"===u?v.formatMessage({defaultMessage:"research",id:"PUcnDUZD0/",description:"Menu heading that will be used within the string â€˜Open {menuType} menuâ€™"}):C?v.formatMessage({defaultMessage:"styles",id:"G91kUvt+GD",description:"Menu heading that will be used within the string â€˜Open {menuType} menuâ€™"}):v.formatMessage({defaultMessage:"tools",id:"yd3KUET1r+",description:"Menu heading that will be used within the string â€˜Open {menuType} menuâ€™"});return(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsx)(ar,{disabled:f,tag:n,showCaretIcon:l,hideIndicatorText:!!r,icon:N,id:"input-".concat(u,"-menu-trigger"),ref:y,onClick:()=>{p(!x)},onKeyDown:e=>{x||"Space"!==e.code&&"ArrowDown"!==e.code||p(!0)},onDoubleClick:c?e=>{e.preventDefault(),null==c||c()}:void 0,"aria-expanded":x,"aria-haspopup":"listbox","aria-controls":"input-menu","data-testid":"input-menu-".concat(u),"aria-label":v.formatMessage({defaultMessage:"Open {menuType} menu",id:"Larie1pvYJ"},{menuType:A}),...w})})},aL=e=>{let{isShown:t}=e;return!!t&&(0,s.jsx)(h.P.div,{initial:{width:0,opacity:0},animate:{width:"auto",opacity:1},children:(0,s.jsx)("div",{className:"h-1.5 w-1.5 bg-accent-secondary-200 rounded-full mr-0.5"})})};var az=a(0x1ddbde9f);let aO={forward:{initial:{x:"20%",opacity:0},animate:{x:0,opacity:1}},back:{initial:{x:"-20%",opacity:0},animate:{x:0,opacity:1}},none:{initial:{x:0},animate:{x:0}}},aU=e=>{let{placement:t,canShowDot:a}=e,n=(0,d.useRef)(null),l=(0,g.A)(),i=(0,e7.tl)(),r=(0,ee.AY)(),o=(0,ee.M8)(),c=(0,eE.g7)(),u=(0,m.fS)("claudeai_research_button_moved_nux_enabled");return(0,s.jsxs)("div",{ref:n,children:[(0,s.jsx)(aH,{canShowDot:a,placement:t,menuType:"tools",...i,tooltip:l.formatMessage({defaultMessage:"Search and tools",id:"lhFEU+uT6i"})}),(0,s.jsx)(aA.V,{canShowNux:o,anchorRef:n,side:"bottom",text:l.formatMessage({defaultMessage:"Add your everyday tools and apps to get the best out of Claude",id:"olaMSdwPL6"}),id:"research-rmcp-tools-nux-1",nuxItem:{dateAdded:"2025-05-14",priority:a_.c.HIGH,showAfterOthersDismiss:!0}}),(0,s.jsx)(aA.V,{canShowNux:r,anchorRef:n,side:"bottom",text:l.formatMessage({defaultMessage:"MCP is here now! Access integrations in this menu.",id:"NkJar0wFk+"}),id:"mcp-tools-nux-1",nuxItem:{dateAdded:"2025-04-29",priority:a_.c.HIGH,showAfterOthersDismiss:!0}}),(0,s.jsx)(aA.V,{canShowNux:u&&c,anchorRef:n,side:"bottom",align:"start",text:l.formatMessage({defaultMessage:"Research moved to a new spot",id:"8jLw1VEgKA"}),id:"research-moved-nux",nuxItem:{dateAdded:"2025-10-02",priority:a_.c.MEDIUM,showAfterOthersDismiss:!1}})]})},aY=e=>{let{placement:t,canShowDot:a}=e,n=(0,e7.CH)(),l=(0,e8.lS)();return(0,s.jsx)(aH,{placement:t,menuType:"plus",canShowDot:a,disabled:l,disabledTooltip:l?"Coming soon":void 0,...n})},aG={id:"mcp-add-connectors-nux",nuxItem:{dateAdded:"2025-07-11",priority:a_.c.HIGH,showAfterOthersDismiss:!0}},aH=e=>{let{text:t,tag:a,showCaretIcon:n,indicatorActive:l,canShowDot:i,hideIndicatorText:r,tooltip:o,placement:c,menuType:u,path:m,menuView:x,highlightedItemKey:g,setHighlightedItemKey:b,handleClickItem:v,inputMenuIsOpen:y,setInputMenuIsOpen:j,inputMenuSearchQuery:w,setInputMenuSearchQuery:k,handleBack:C,animationDirection:M,disabled:N,disabledTooltip:A}=e,{currentItems:S}=x,_=(0,aN.L)(()=>{j(!1)},["mouseup","touchend"]),E=(0,d.useRef)(null),I=(0,d.useRef)(null),T=(0,d.useRef)(null),R=(0,d.useRef)(null),[D,P]=(0,d.useState)(void 0),[F,L]=(0,d.useState)("bottom"===c?"top":"bottom"),[z,O]=(0,d.useState)(0),U=(0,e9.useSearchParams)(),{shouldShow:Y}=(0,aE.z)(aG.id,aG.nuxItem),G="true"===U.get(aS.HU)&&Y&&"tools"===u;(0,d.useEffect)(()=>{G&&(j(!0),T.current&&(T.current.scrollTop=T.current.scrollHeight))},[G,j]),(0,d.useEffect)(()=>{if(!E.current||!I.current)return;let e=E.current.getBoundingClientRect(),{updatedHeightAvailable:t,updatedDropdownSide:a}=aq({placement:c,triggerRectTop:e.top,triggerRectBottom:e.bottom});P(Math.min(422,t)),L(a);let s=I.current.getBoundingClientRect();O(Math.min(0,window.innerWidth-s.right-8))},[c,y]);let H=(0,e8.Hd)(),q=("plus"===u||"tools"===u)&&H?(0,s.jsx)(aR.s,{path:m,inputMenuSearchQuery:w,setInputMenuSearchQuery:k,handleBack:C}):null;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"relative shrink-0",onClick:e=>{e.preventDefault()},ref:_,children:[(0,s.jsx)("div",{ref:E,children:(0,s.jsx)(aF,{disabled:N,disabledTooltip:A,tag:a,tooltip:o,text:t,showCaretIcon:n,indicatorActive:l,hideIndicatorText:r,canShowDot:i,menuType:u,menuView:x,inputMenuIsOpen:y,setInputMenuIsOpen:j,onDoubleClick:"plus"===u?()=>(0,tC.U_)(c):void 0})}),(0,s.jsx)("div",{ref:I,className:(0,p.A)("w-[20rem] absolute max-w-[calc(100vw-16px)]","top"===F?"bottom-10":"top-10",y?"block":"hidden"),children:(0,s.jsx)(f.N,{children:y&&(0,s.jsx)(h.P.div,{ref:T,initial:{opacity:0,scale:.95,y:"top"===F?8:-8,x:-8},animate:{opacity:1,scale:1,y:0,x:0},exit:{opacity:0,scale:.95,y:"top"===F?8:-8,x:-8},transition:{type:"spring",stiffness:650,damping:23,mass:.6,height:{ease:"easeInOut"}},className:(0,p.A)("relative w-full will-change-transform h-auto overflow-y-auto overscroll-auto flex z-dropdown bg-bg-000 rounded-2xl overflow-hidden border-border-300 border-0.5 shadow-diffused shadow-[hsl(var(--always-black)/6%)]","top"===F?"flex-col-reverse":"flex-col"),onMouseEnter:()=>b(null),style:{maxHeight:D?"".concat(D,"px"):void 0,left:z},onClick:e=>{e.stopPropagation(),(0,az.l)()},children:(0,s.jsxs)(aC,{duration:100,className:(0,p.A)("flex flex-col min-h-0 w-full !ease-out","top"===F?"justify-end":"justify-start"),children:[(0,s.jsxs)("div",{className:"p-1.5 flex flex-col",children:["bottom"===F&&q,(0,s.jsx)(h.P.div,{variants:aO[M],initial:"initial",animate:"animate",className:"flex flex-col",transition:{x:{duration:.15,ease:aM.A.outCirc},opacity:{duration:.25,ease:"easeInOut"}},children:("top"===F?[...S].reverse():S).filter(e=>{let{menuItemHidden:t}=e;return!t}).map(e=>"addIntegrations"===e.key?(0,s.jsx)("div",{ref:R,children:(0,s.jsx)(al.$,{item:e,onClick:()=>v(e),isHighlighted:g===e.key})},e.key):(0,s.jsx)(al.$,{item:e,onClick:()=>v(e),isHighlighted:g===e.key},e.key))},null!=m?m:"root"),"top"===F&&q]}),(0,s.jsx)(aT,{path:m})]})})})})]}),(0,s.jsx)(aA.V,{canShowNux:G&&!!R.current&&y,anchorRef:R,side:"right",text:(0,s.jsx)(X.A,{defaultMessage:"Find and add more of your favorite tools in <span>Add connectors</span>.",id:"2icgWBPsqj",values:{span:e=>(0,s.jsx)("span",{className:"font-bold",children:e})}}),...aG})]})},aq=e=>{let{placement:t,triggerRectTop:a,triggerRectBottom:s}=e,n=window.innerHeight-s-8-8;if("bottom"===t){let e=a-76-8;return e<160&&n>e?{updatedDropdownSide:"bottom",updatedHeightAvailable:n}:{updatedDropdownSide:"top",updatedHeightAvailable:e}}{let e=a-8-8;return n<160&&e>n?{updatedDropdownSide:"top",updatedHeightAvailable:e}:{updatedDropdownSide:"bottom",updatedHeightAvailable:n}}};var aB=a(0x9f369389);a(0x1cf5ab98a);var aK=a(0xdd00a1e9);a(0xb3796c53);var aV=a(0x4bf5e44c),aW=a(0x141440998);(0,d.memo)(e=>{var t,a;let{target:n,isSelected:l,onToggle:i}=e,r=null!=(a=null!=(t=n.displayName)?t:n.path.split("/").pop())?a:n.path,o=(0,d.useCallback)(()=>{i(n.path)},[i,n.path]);return(0,s.jsx)(aK.tJ,{onClick:o,icon:(0,s.jsx)(aV.sj,{size:16,className:"text-text-400"}),trailing:l?(0,s.jsx)(aW.S,{size:12,className:"text-accent-brand shrink-0"}):void 0,children:(0,s.jsxs)("div",{className:"flex flex-col min-w-0",children:[(0,s.jsx)("span",{className:"text-sm truncate",children:r}),(0,s.jsx)("span",{className:"text-xs text-text-500 truncate",children:n.path})]})})}).displayName="FolderMultiSelectItem",a(0xe41b440d);let a$=eg.Ik({enabled:eg.zM()}),aJ=e=>{let t,{model:a,hideIndicatorText:n}=e,l=(0,g.A)(),{toggleConversationSetting:r}=(0,y.rX)({source:"extendedThinkingButton"}),o=(0,y.vP)("paprika_mode"),c=(0,ev.j)()(a),u=(0,i.h0)(),m=(0,D.useLayer)("trials_freemium"),{data:x}=(0,eb.EY)(),p=(0,e8.lS)(),f=(0,V.QN)(),{haystackProject:h}=(0,ez.Sc)(),b=(0,ez.Af)(),v=!!h&&f===(null==h?void 0:h.uuid);(0,d.useEffect)(()=>{!o&&c&&v&&r("paprika_mode","extended")},[o,c,v,r]);let j=!u,w=m.get("free_thinking",!1);if(j&&w&&(null==x?void 0:x.remaining)===0||p)return null;let k=j&&w&&x&&void 0!==x.remaining&&void 0!==x.limit&&!!o;c?v&&(t=l.formatMessage({defaultMessage:"{haystackProjectDisplayName} requires extended thinking to coordinate your connected tools",id:"yx2ockglUA"},{haystackProjectDisplayName:b})):t=l.formatMessage({defaultMessage:"Select a different model to use this feature",id:"/9vSDy2Wm0"});let C=p||!!t;return(0,s.jsx)(ar,{disabled:C,tooltip:t||l.formatMessage({defaultMessage:"Extended thinking",id:"5j4WakKa2u"}),tooltipShortcut:C?void 0:"Cmd+Shift+E",hideIndicatorText:n,icon:(0,s.jsx)(ep.ExtendedThinking,{size:16}),onClick:()=>{C||r("paprika_mode",o?null:"extended")},indicatorActive:!C&&!!o||p||v,text:l.formatMessage({defaultMessage:"Extended thinking",id:"5j4WakKa2u"}),limitInfo:k?{remaining:x.remaining,total:x.limit}:null,className:"!shrink-0"})},aX=e=>{let{placement:t,isDisabled:a,disabled:n,skipInitialAnimation:l=!1}=e,i=(0,g.A)(),r=(0,ex.q)();(0,m.iW)("prompt_improver_config_enabled",{enabled:!1},a$);let o=M(),c=(0,em.A9)(),u=(0,V.N3)(),x=(0,V.QN)(),{attachments:f,files:h,syncSourceUuids:b}=(0,V.Jy)(e=>({attachments:e.attachments,files:e.files,syncSourceUuids:e.syncSourceUuids})),{model:v,setModel:y,sendMessage:j,stopSampling:w,conversation:C,isSending:N,isChatSyncing:A,isProjectSyncing:S,isModelSelectorOpen:_,setIsModelSelectorOpen:E,isNewConversation:I,currentCompassTask:T,improvePrompt:R,isImprovingPrompt:D}=(0,k.oM)(),P=(0,el.Z3)((null==C?void 0:C.id)||null),F=null!=v?v:P,L=A||S?i.formatMessage({defaultMessage:"Syncing knowledge...",id:"QuwefnZNVj"}):void 0,z=(0,d.useMemo)(()=>{var e;return[...h,...null!=(e=null==C?void 0:C.files)?e:[]].some(e=>e.file_kind===ef.Mr.Image||e.file_kind===ef.Mr.SanitizedDocument)},[h,C]),O=(0,d.useCallback)(e=>y(e.model),[y]),[U,Y]=(0,eh.w)({box:"border-box"}),G=Y.width||null,H=null===G||G<396,q=(0,e8.nb)(),B=(0,eo.PF)(),K=(0,eo.qX)();(0,eO.q)();let W=(0,ez._Y)();return(0,s.jsxs)("div",{className:"flex gap-2 w-full items-center",ref:U,children:[(0,s.jsxs)("div",{className:(0,p.A)("relative flex-1 flex items-center shrink min-w-0",o?"gap-1":"gap-2"),children:[W?null:o?(0,s.jsx)(t9,{chatInputPlacement:t,disabled:n}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(aY,{placement:t,canShowDot:null!==G&&H}),(0,s.jsx)(aU,{placement:t,canShowDot:null!==G&&H})]}),"","",(0,s.jsx)(aJ,{model:F,hideIndicatorText:!0}),null!==G&&(o?(0,s.jsx)(ap,{hideIndicators:H}):(0,s.jsx)(ay,{hideIndicatorText:null===G||G<480,hideIndicators:H})),(0,s.jsx)(ej,{model:v,projectUuid:x})]}),!r&&(0,s.jsx)(ew.B,{selectedModel:v,onSelect:O,hasMultiModalContent:z,placement:t,open:_,onOpenChange:E,isNewConversation:I,modelsConfig:c,disabled:n}),(0,s.jsx)(eR,{isSending:N,isDisabled:a,disabledReason:L,isPromptEmpty:u,files:h,attachments:f,syncSourceUuids:b,conversation:C,currentCompassTask:T,onSend:()=>j(),onStop:()=>w(),skipInitialAnimation:l,canQueueMessages:q||B,isNewAgentModeChat:K&&I})]})};var aQ=a(0x21870d616),aZ=a(0x6389c291),a0=a(0x24635187b),a1=a(0x15068fa65);let a2=e=>{let{disabled:t=!1,enableScreenDrop:a=!1}=e,{onDrop:n}=(0,k.oM)();return(0,s.jsx)(aZ.wC,{disabled:t,onDrop:n,enableScreenDrop:a,children:a?(0,s.jsx)(a3,{}):(0,s.jsx)(a5,{})})},a5=()=>{let{dragState:e}=(0,aZ.t1)(),t=e===aZ.mq.DRAGGING_ON_TARGET,a=e===aZ.mq.DRAGGING_OFF_TARGET||e===aZ.mq.DRAGGING_ON_TARGET;return a?(0,s.jsx)(f.N,{children:a&&(0,s.jsx)(h.P.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.2},className:"absolute top-0 border border-dashed bg-clip-padding rounded-2xl min-h-4 h-full w-full border-accent-secondary-100 bg-bg-000 overflow-hidden z-10",children:(0,s.jsx)("div",{className:(0,p.A)("flex items-center justify-center h-full w-full transition-colors",t?"bg-accent-secondary-900":"bg-accent-secondary-900/50"),children:(0,s.jsxs)("p",{className:"text-accent-secondary-100 flex flex-row items-center gap-2.5",children:[(0,s.jsx)(a0._,{size:20,className:"opacity-50"}),(0,s.jsx)(X.A,{defaultMessage:"Drop files here to add to chat",id:"IYBR/J+nuA"})]})})},"chat-input-drop-zone-overlay")}):null},a3=()=>{let{dragState:e}=(0,aZ.t1)(),t=e===aZ.mq.DRAGGING_OFF_TARGET||e===aZ.mq.DRAGGING_ON_TARGET;return t?(0,a1.createPortal)((0,s.jsx)(f.N,{children:t&&(0,s.jsx)(h.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.1},className:"fixed inset-0 z-toast pointer-events-none",children:(0,s.jsx)("div",{className:"absolute inset-0 bg-bg-100/90 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"flex flex-col items-center gap-2 text-text-100",children:[(0,s.jsx)(aQ.ObjectDocumentAdd,{}),(0,s.jsx)(X.A,{defaultMessage:"Drop files here to add to chat",id:"IYBR/J+nuA"})]})})},"full-screen-drop-zone-overlay")}),document.body):null};var a4=a(0x12c9046cd),a8=a(0x246846ae8),a6=a(0x23b9f35d7),a9=a.n(a6),a7=a(0x22fc8d729),se=a(0x212aec62a);function st(e){let{text:t,className:a}=e,[n,l]=(0,d.useState)(!1),i=(0,d.useRef)(null),r=(0,d.useRef)(0),[o,c]=(0,d.useState)(42),u=o>42;return((0,d.useLayoutEffect)(()=>{var e;c((null==(e=i.current)?void 0:e.scrollHeight)||0)},[t]),t)?(0,s.jsxs)("div",{className:(0,p.A)("overflow-hidden relative transition-[height] duration-150 ease-in-out","text-text-300 text-sm",a),style:{height:n?o+32*!!u:40},children:[(0,s.jsx)("div",{ref:i,className:"whitespace-pre-wrap",style:{wordBreak:"break-word",overflowWrap:"anywhere"},children:t}),u&&(0,s.jsx)("div",{className:"absolute bottom-0 right-0 bg-bg-100 bottom-0",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"absolute top-0 bottom-0 -left-4 w-6 bg-gradient-to-r from-transparent to-bg-100"}),(0,s.jsx)(a7.Y,{onClick:()=>{var e;let t=null==(e=i.current)?void 0:e.closest(".overflow-y-auto");!n&&t?r.current=t.scrollTop:n&&t&&t.scrollTo({top:r.current,behavior:"instant"}),l(e=>!e)},className:"font-medium flex gap-1 items-center relative ",children:n?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(se.Z,{size:12,weight:"bold"}),(0,s.jsx)(X.A,{defaultMessage:"Less",id:"mFYgAXM/x4"})]}):(0,s.jsx)(X.A,{defaultMessage:"{ellipsis}More",id:"eRW5dl5m34",values:{ellipsis:"..."}})})]})})]}):null}function sa(e){var t,a;let{isOpen:n,onClose:l,prompt:i,serverUuid:r}=e,o=(0,g.A)(),c=(0,d.useCallback)(()=>{x({}),l()},[l]),u=(0,tS.vW)(c),[m,x]=(0,d.useState)({}),p=null==i||null==(t=i.arguments)?void 0:t.some(e=>!!(e.required&&!m[e.name]));return i?(0,s.jsxs)(eI.aF,{title:o.formatMessage({defaultMessage:"Enter prompt inputs",id:"zDs90mJ5UJ"}),subtitle:(0,s.jsxs)("div",{className:"flex flex-col gap-1 mt-1",children:[i.name,(0,s.jsx)(st,{text:i.description})]}),isOpen:n,onClose:c,modalSize:"lg",children:[(0,s.jsx)("div",{className:"flex flex-col gap-4 max-h-[500px] mb-4 overflow-y-auto",children:null==(a=i.arguments)?void 0:a.map(e=>(0,s.jsx)("div",{className:"flex flex-col gap-1",children:(0,s.jsx)(a8.ks,{required:e.required,label:"".concat(a9()(e.name.toLowerCase())).concat(e.required?"*":""),placeholder:e.description,value:m[e.name]||"",onValueChange:t=>x(a=>({...a,[e.name]:null!=t?t:""})),onBlur:()=>{x(t=>{var a;return{...t,[e.name]:(null!=(a=t[e.name])?a:"").trim()}})},error:e.required&&""===m[e.name]},e.name)},e.name))}),(0,s.jsxs)(eI.vW,{children:[(0,s.jsx)(eu.$,{disabled:p,onClick:()=>void u({serverUuid:r,prompt:i,args:m}),children:(0,s.jsx)(X.A,{defaultMessage:"Add prompt",id:"8UhdEv01LN"})}),(0,s.jsx)(eu.$,{variant:"secondary",onClick:c,children:(0,s.jsx)(X.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})})]})]}):null}var ss=a(0x1ab362a20),sn=a(0x1dbad8fd1),sl=a(0x1bd42f6d2),si=a(0x220ad18d4),sr=a(0x6e0ffcda);let so=e=>{let{moveAttachments:t=!1,handleProjectCreated:a,isOpen:n,handleClose:l,syncSources:i=[],attachments:o=[],setSyncSourceUuids:c,setAttachments:u}=e,[m,x]=(0,d.useState)(null),{addError:p}=(0,r.Yf)(),f=(0,si.n)();return sd({project:m,syncSources:i,attachments:o,setSyncSourceUuids:c,setAttachments:u}),(0,s.jsxs)(eI.aF,{isOpen:n,onClose:l,modalSize:"xl",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsx)("h1",{className:"font-heading text-text-200 mb-4",children:t?(0,s.jsx)(X.A,{defaultMessage:"Create a project with attachments",id:"wSxz4Q9mjA"}):(0,s.jsx)(X.A,{defaultMessage:"Create a project",id:"HR5A+UPiIu"})}),(0,s.jsx)(eu.$,{onClick:l,size:"icon",variant:"ghost",children:(0,s.jsx)(ss.X,{size:16})})]}),n&&(0,s.jsx)(sr.Kk,{syncSources:t?i:void 0,onProjectCreated:e=>{t&&x(e),a(e)},onError:e=>p(e.message,{error:e,errorContext:{tags:{source:"create_project_modal"}}}),onCancel:l,strings:f})]})},sd=e=>{let{project:t,syncSources:a,attachments:s,setSyncSourceUuids:n,setAttachments:l}=e,i=(0,d.useRef)(!1),{addSuccess:o}=(0,r.Yf)(),c=(0,g.A)(),{mutate:u}=(0,sn.fh)(null==t?void 0:t.uuid),{mutate:m}=(0,sl.pz)(null==t?void 0:t.uuid),x=(0,d.useCallback)(()=>{t&&(s.length||a.length&&t.is_private)&&(s.forEach(e=>{let{file_name:t,extracted_content:a}=e;u({file_name:t,content:a})}),t.is_private&&(a.forEach(e=>{let t=(0,et.tS)(e);t&&m(t)}),n([])),l([]),o(c.formatMessage({defaultMessage:"Attachments added to {projectName}",id:"dodZw3agKz"},{projectName:t.name||"your project"})))},[t,o,s,u,l,m,n,a,c]);(0,d.useEffect)(()=>{t&&!i.current&&(i.current=!0,x())},[t,x])};var sc=a(0x761f2ec),su=a(0xa1ce28b4),sm=a(0xc9dabb82),sx=a(0x1b03847fb),sp=a(0xe3061179),sf=a(0x21baeb1ec),sh=a(0x37b42168),sg=a(0x12a35f493),sb=a(0x1ae4a2f26),sv=a(0x23506e4da),sy=a(0x1016c6ed2),sj=a(0x8c555bbe),sw=a(0xe885efe2);let sk=()=>{let{addError:e}=(0,r.Yf)();return{handleRateLimitError:(t,a)=>{if(t instanceof sy.LG&&429===t.statusCode){let a=null;if(t.message.includes("{"))try{a=JSON.parse(t.message)}catch(e){}(null==a?void 0:a.type)==="exceeded_limit"&&"concurrents"===a.representativeClaim?e("Looks like you have too many chats going. Please close a tab to continue.",{error:t}):"thinking_messages_rate_limit_exceeded"===t.errorCode?e("Youâ€™ve reached your weekly limit for thinking messages. Please try again next week.",{error:t}):"opus_messages_rate_limit_exceeded"===t.errorCode?(0,sw.T)():(e("Youâ€™ve reached the limit for Claude messages at this time. Please wait before trying again.",{error:t}),(0,sj.D)())}else e(a,{error:t,errorContext:{tags:{source:"api_error_handler_default"}}})}}},sC=(0,sv.default)(()=>a.e(10320).then(a.bind(a,0xad3190)).then(e=>({default:e.WritingAnimation})),{loadableGenerated:{webpack:()=>[0xad3190]},ssr:!1}),sM={default:{type:"spring",stiffness:650,damping:60},opacity:{type:"tween",ease:"easeOut",duration:.35}},sN=(0,d.forwardRef)((e,t)=>{let{setScreen:a,onStyleChange:n,animateBoolRef:l}=e,o=(0,g.A)(),c=(0,tH.st)(),[u,m]=(0,d.useState)(!1),[x,p]=(0,d.useState)(""),{handleRateLimitError:b}=sk(),{mutateAsync:v}=(0,sm.f$)(),y=(0,d.useRef)(null),j=(0,d.useRef)(null);(0,d.useEffect)(()=>{u&&setTimeout(()=>{var e;return null==(e=j.current)?void 0:e.focus()},50)},[u]);let[w,k]=(0,d.useState)(!1),[C,M]=(0,d.useState)(!1),N=(0,d.useRef)(null),A=(0,d.useRef)(null),S=4e3,{handleFileUpload:_,handleTextUpload:E}=function(e){let[t,a]=(0,d.useState)(!1),{activeOrganization:s}=(0,i.YL)(),{addError:n}=(0,r.Yf)(),l=(0,a4.mn)();return{handleFileUpload:async i=>{if(t||!s)return;if(a(!0),!(0,$.eT)(i))try{let t=await (0,$.F9)(i);await e(t),a(!1);return}catch(e){}let r=new FormData;r.append("file",i);try{let t=await l("/api/organizations/".concat(s.uuid,"/convert_document"),{method:"POST",body:r});if(!t.ok)throw Error("Document conversion failed");let a=await t.json();if(!(null==a?void 0:a.extracted_content))throw Error("Document conversion failed: No extracted content");await e(a.extracted_content)}catch(e){n(e instanceof Error?e.message:"Error uploading file",{error:e,errorContext:{tags:{source:"example_upload_document_conversion"}}})}finally{a(!1)}},handleTextUpload:async n=>{!t&&s&&0!==n.trim().length&&(a(!0),await e(n),a(!1))},isUploading:t}}(async e=>{try{N.current=await v({content_example:e})}catch(e){b(e,o.formatMessage({defaultMessage:"Failed to create style. Please try again.",id:"GF2W10J5zb"})),k(!1)}}),I=()=>{N.current?n(N.current,!0):A.current=setTimeout(I,S=1e3)},T=async()=>{P(),await E(x)},R=async e=>{let t=Array.from(e.dataTransfer.files);t&&(M(!0),setTimeout(P,20),await _(t[0]))},D=async e=>{let t=e.target.files;t&&(P(),await _(Array.from(t)[0])),e.target.value=""},P=()=>{k(!0),A.current=setTimeout(I,S)};return(0,s.jsx)(h.P.div,{ref:t,className:"w-full h-full grid place-items-center",exit:{opacity:0,scale:.8},transition:l.current?sM:{duration:0},children:(0,s.jsxs)(f.N,{mode:"popLayout",children:[w&&(0,s.jsx)(h.P.div,{className:"w-full h-full grid place-items-center",initial:{opacity:0},animate:{opacity:1},transition:sM,children:(0,s.jsx)(sS,{})},"CreateStyleAnalyzingContentScreen"),!w&&(0,s.jsxs)(h.P.div,{className:"w-full h-full pt-1 flex flex-col sm:grid sm:grid-cols-2 sm:gap-4",children:[(0,s.jsxs)(h.P.div,{exit:{opacity:0,y:40,transition:sM},className:"sm:h-full text-center flex flex-col gap-2 items-center justify-center px-2 pt-8 pb-8 sm:pt-14 sm:pb-20",children:[(0,s.jsx)("div",{className:"relative pb-2 w-full flex items-center justify-center",children:(0,s.jsx)(sC,{})}),(0,s.jsx)("p",{className:"text-text-300 font-claude-response sm:text-lg",children:(0,s.jsx)(X.A,{defaultMessage:"Share a writing example or describe your style and Claude will make a custom writing style tailored just for you.",id:"2qm6Zfzfx3"})})]},"CreatStyleStartScreenExplainer"),(0,s.jsx)(h.P.div,{className:"h-full flex-1",exit:{opacity:0,x:0,scale:.8,transition:{basicTransition:sM}},children:u?(0,s.jsxs)("div",{className:"h-full flex flex-col gap-2 p-2 rounded-xl border-0.5 border-border-300",children:[(0,s.jsx)("textarea",{ref:j,className:" flex-1 min-h-0 bg-bg-000 border border-border-200 p-3 leading-5 rounded-lg transition-colors hover:border-border-100 placeholder:text-text-500 focus:border-accent-secondary-100 focus:ring-0 focus:outline-none disabled:cursor-not-allowed disabled:opacity-50 whitespace-pre-wrap resize-none",name:"inputText",placeholder:o.formatMessage({defaultMessage:"Paste at least a few paragraphs of example writing, including from multiple various sources if youâ€™d like, for Claude to analyze and the match style of...",id:"mC+9IzmmMY"}),value:x,onChange:e=>p(e.target.value),required:!0}),(0,s.jsxs)("div",{className:"flex gap-2 justify-center",children:[(0,s.jsx)(eu.$,{variant:"secondary",onClick:()=>m(!1),children:(0,s.jsx)(X.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})}),(0,s.jsx)(eu.$,{onClick:T,children:(0,s.jsx)(X.A,{defaultMessage:"Create style",id:"OC52fhpn7g"})})]})]}):(0,s.jsxs)(aZ.wC,{className:"w-full h-full text-center border-dashed border border-border-300 bg-bg-000 rounded-xl relative grid place-items-center",onDrop:R,children:[(0,s.jsx)(sA,{showDropCover:C},"DropZoneOverlay"),(0,s.jsx)("input",{ref:y,type:"file",className:"hidden",accept:(0,$.cm)({imagesEnabled:!1}).join(","),onChange:D,multiple:!0}),(0,s.jsxs)("div",{children:[(0,s.jsxs)(sx.ms,{trigger:(0,s.jsx)(eu.$,{variant:"claude",className:"mt-2 font-medium !text-accent-secondary-100 bg-accent-secondary-900 hover:!bg-accent-secondary-100/15 gap-2",prepend:(0,s.jsx)(sp.C,{weight:"bold"}),children:(0,s.jsx)(X.A,{defaultMessage:"Add writing example",id:"EhXT0lXWRc"})}),children:[(0,s.jsx)(sx.tJ,{children:(0,s.jsxs)("div",{className:"flex items-center gap-2",onClick:()=>{y.current&&y.current.click()},children:[(0,s.jsx)(sf.x,{size:16}),(0,s.jsx)(X.A,{defaultMessage:"Upload from device",id:"vMaZk5Jcnv"})]})}),(0,s.jsx)(sx.tJ,{onClick:()=>m(!0),children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(sh.v,{size:16}),(0,s.jsx)(X.A,{defaultMessage:"Paste text content",id:"nVQ9XcjUIh"})]})})]}),(0,s.jsxs)("div",{className:"text-xs text-text-400 mt-3 flex flex-col gap-1 max-sm:pb-8",children:[(0,s.jsx)("p",{children:window.innerWidth<=640?(0,s.jsx)(X.A,{defaultMessage:"Select or paste existing doc, post, message, etc.",id:"7oFd31Vmu3"}):(0,s.jsx)(X.A,{defaultMessage:"Select, drop, or paste existing doc, post, message, etc.",id:"ugXnNZ7Ix/"})}),(0,s.jsx)("p",{children:(0,s.jsx)(X.A,{defaultMessage:"Content is not stored after matching style.",id:"bLEGIyr72h"})})]})]}),(0,s.jsx)("div",{className:"absolute w-full bottom-6",children:(0,s.jsxs)(a7.Y,{className:"text-sm gap-1.5",onClick:()=>{c.track({event_key:"styles.custom.describe_clicked"}),a(t$.I.CREATE_MANUALLY)},children:[(0,s.jsx)(sg.u,{}),(0,s.jsx)(X.A,{defaultMessage:"Describe style instead",id:"p6hP+KeXkD"})]})})]})},"CreatStyleStartScreenDropZone")]},"CreatStyleStartScreen")]})})});sN.displayName="CreateStyle";let sA=e=>{let{showDropCover:t}=e,{dragState:a}=(0,aZ.t1)(),n=a===aZ.mq.DRAGGING_OFF_TARGET||a===aZ.mq.DRAGGING_ON_TARGET||t;return(0,s.jsx)(f.N,{children:n&&(0,s.jsx)(h.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:(0,p.A)("absolute -inset-px z-10 flex flex-col justify-center rounded-xl border border-dashed transition-colors",a===aZ.mq.DRAGGING_ON_TARGET||t?"bg-accent-secondary-900 border-accent-secondary-200 text-accent-secondary-000":"bg-bg-100 border-border-200 text-text-300"),children:(0,s.jsxs)("div",{className:"py-1.5 text-center",children:[(0,s.jsx)("div",{className:"relative inline-block opacity-60",children:(0,s.jsx)(sb.p,{size:36,weight:"thin"})}),(0,s.jsx)("div",{className:"font-claude-response pt-2 pb-4 italic",children:(0,s.jsx)(X.A,{defaultMessage:"Drop example writing here to match the style",id:"VcDT1Dt8dq"})})]})},"drop-zone-overlay")})},sS=()=>(0,s.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,s.jsx)(sC,{animate:!0}),(0,s.jsx)(h.P.div,{className:"font-claude-response italic text-lg",initial:{opacity:0,y:-15},animate:{opacity:1,y:0},transition:{opacity:{delay:.2,ease:"easeOut",duraation:.6},y:{delay:.2,type:"spring",stiffness:230,damping:20}},children:(0,s.jsx)(X.A,{defaultMessage:"Analyzing your writing...",id:"AnDnGKCn6M"})})]});var s_=a(0xd43019f7),sE=a(0xa6cc430c),sI=a(0x18d937414),sT=a(0x1d373700c);let sR={objective:{label:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(s_.W,{})," ",(0,s.jsx)(X.A,{defaultMessage:"Define style objective",id:"gJB/90MGQ7"})]}),description:"Describe the main purpose and goal of this writing style â€” whether to teach, analyze, persuade, inspire, etc.",placeholder:"Try something like:\nI want to teach complex topics step-by-step, with a focus on building understanding.",promptPrepend:"Iâ€™d like the writing to serve this purpose:"},audience:{label:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(sT.t,{})," ",(0,s.jsx)(X.A,{defaultMessage:"Tailor to an audience",id:"TYdBxyl/f3"})]}),description:"Describe details of the target audience youâ€™d like Claude to write for including relevant information, needs, or preferences.",placeholder:"Try something like:\nWrite for marketing professionals. Theyâ€™re tech-savvy and appreciate a dash of humor with their data.",promptPrepend:"Iâ€™d like to tailor this style to a specific audience:"},voicetone:{label:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(sE.r,{})," ",(0,s.jsx)(X.A,{defaultMessage:"Use specific voice & tone",id:"1Vo908p7lJ"})]}),description:"Think about characteristics like formality, emotion, personality, and how you want the written responses to feel.",placeholder:"Try something like:\nWrite in a warm, approachable tone with light professional humor - like a friendly mentor.",promptPrepend:"Iâ€™d like to write in this voice and tone:"},general:{label:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(sg.u,{})," ",(0,s.jsx)(X.A,{defaultMessage:"Describe generally",id:"f3JnPS+B3+"})]}),description:"Describe in detail how you would like Claude to write. Be as specific as you can.",placeholder:"Try something like:\nWrite like an excited scientist explaining fascinating discoveries - technical but energetic.",promptPrepend:"Iâ€™d like to write like this:"},custom:{label:(0,s.jsx)(X.A,{defaultMessage:"Use custom instructions (advanced)",id:"hSfu0Sz47T"}),description:"Write exact custom instructions for this style instead of generating a style prompt automatically. Claude will ignore instructions that donâ€™t follow our guidelines.",placeholder:"Write style custom instructions here...",promptPrepend:""}},sD=(0,d.forwardRef)((e,t)=>{let{setScreen:a,onStyleChange:n}=e,l=(0,g.A)(),i=(0,tH.st)(),[r,o]=(0,d.useState)(!1),[c,u]=(0,d.useState)(""),[m,x]=(0,d.useState)(Object.keys(sR)[0]),{handleRateLimitError:b}=sk(),{mutateAsync:v}=(0,sm.f$)(),y=(0,d.useRef)(null);(0,d.useEffect)(()=>{setTimeout(()=>{var e;return null==(e=y.current)?void 0:e.focus()},50)},[m]);let j=c.replace(/\s/g,"").length>24,w=async()=>{if(!r&&j){o(!0);try{let e="custom"===m?{prompt:c}:{input_text:sR[m].promptPrepend+"\n"+c},t=await v(e);n(t,!1)}catch(e){b(e,l.formatMessage({defaultMessage:"Failed to create style. Please try again.",id:"GF2W10J5zb"}))}finally{o(!1)}}},k=e=>{i.track({event_key:"styles.custom.describe_selected",key:e}),x(e)};return(0,s.jsxs)(h.P.div,{ref:t,className:"w-full h-full flex flex-col sm:grid sm:grid-cols-2 gap-4 pt-3",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:h-full sm:pr-3",children:[(0,s.jsxs)("div",{className:"flex-1 text-text-300",children:[(0,s.jsx)("p",{className:"mb-1 sm:mb-2 text-sm font-medium",children:(0,s.jsx)(X.A,{defaultMessage:"Generate style from a starting point:",id:"cz09/5alWg"})}),(0,s.jsx)("ul",{className:"hidden sm:flex flex-col gap-1.5",children:Object.keys(sR).map(e=>(0,s.jsx)("li",{children:(0,s.jsxs)("button",{className:(0,p.A)("flex gap-1.5 items-center font-ui h-11 rounded-lg border border-border-400 hover:border-border-300 px-3 w-full text-left transition active:scale-[1.015] hover:bg-bg-200",m===e&&"!bg-accent-secondary-900 text-accent-secondary-000 !border-accent-secondary-100/80","custom"===e&&"mt-2 text-sm"),onClick:()=>k(e),children:[(0,s.jsx)("div",{className:"w-4 h-4 rounded-full bg-bg-100 grid place-items-center border border-border-300 mr-1",children:m===e&&(0,s.jsx)("div",{className:"w-2.5 h-2.5 rounded-full bg-accent-secondary-100"})}),sR[e].label]})},e))}),(0,s.jsx)("div",{className:"sm:hidden",children:(0,s.jsx)(sx.ms,{trigger:(0,s.jsx)(eu.$,{variant:"ghost",append:(0,s.jsx)(as.a,{}),className:"w-full !border !border-border-300",children:(0,s.jsx)("div",{className:"flex-1 text-left flex items-center gap-1",children:sR[m].label})}),children:Object.keys(sR).map(e=>(0,s.jsx)(sx.tJ,{onSelect:()=>k(e),children:(0,s.jsx)("div",{className:"flex items-center gap-1",children:sR[e].label})},e))})})]}),(0,s.jsx)("div",{className:"mb-4 max-sm:hidden",children:(0,s.jsxs)(a7.Y,{className:"text-sm gap-1",onClick:()=>a(t$.I.CREATE),children:[(0,s.jsx)(sI.f,{}),(0,s.jsx)(X.A,{defaultMessage:"Never mind, Iâ€™ll add an example",id:"PpPoeCEz4X"})]})})]}),(0,s.jsxs)("form",{className:"flex flex-col h-full rounded-xl border-0.5 border-border-300 bg-bg-200 px-3 py-2 gap-2",onSubmit:e=>{e.preventDefault(),w()},children:[(0,s.jsx)("p",{className:"pt-0 p-1 text-text-300 font-claude-response max-sm:text-sm",children:sR[m].description}),(0,s.jsxs)("div",{className:"relative flex-1 w-full",children:[(0,s.jsx)("textarea",{ref:y,className:" min-h-0 w-full h-full bg-bg-000 border border-border-200 p-3 leading-snug rounded-lg transition-colors hover:border-border-100 placeholder:text-text-500 focus:border-accent-secondary-100 focus:ring-0 focus:outline-none disabled:cursor-not-allowed disabled:opacity-50 whitespace-pre-wrap resize-none",name:"inputText",placeholder:sR[m].placeholder,value:c,required:!0,onChange:e=>u(e.target.value)}),(0,s.jsx)(f.N,{children:c.length>0&&!j&&(0,s.jsx)(h.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{ease:"easeIn",duration:.1},className:"absolute bottom-1 right-1 left-1 py-2 px-2 rounded-md text-sm bg-accent-secondary-900 text-text-200 text-center",children:(0,s.jsx)(X.A,{defaultMessage:"Be as descriptive as possible to help Claude generate the best possible style for you",id:"3ObAHHjHgF"})})})]}),(0,s.jsx)(eC.m,{tooltipContent:j?"":l.formatMessage({defaultMessage:"More description needed in order to generate style",id:"vX4dBOsKs3"}),side:"bottom",className:"text-center",children:(0,s.jsx)("div",{className:"flex items-center w-full justify-center pb-1",children:(0,s.jsx)(eu.$,{className:"w-full",type:"submit",loading:r,disabled:!j,children:"custom"===m?(0,s.jsx)(X.A,{defaultMessage:"Create style",id:"OC52fhpn7g"}):(0,s.jsx)(X.A,{defaultMessage:"Generate style",id:"tILvvoBa87"})})})})]})]})});sD.displayName="CreateStyleManually";var sP=a(0xbca8e388),sF=a(0xc288ff4d),sL=a(0x609a9c34),sz=a(0x1628a449c),sO=a(0x2b0ffc36),sU=a(0x20e6008b),sY=a(0xef94f97b),sG=a(0x54b74c3a),sH=a(0x103e44a54),sq=a(0x133b478a1),sB=a(0xb804d868);function sK(){let[e,t]=(0,sB.Vc)("userHiddenStyles",[]),a=(0,d.useCallback)(e=>{let a=(0,tX.X)(e);t(e=>[...e,a])},[t]),s=(0,d.useCallback)(()=>{t([])},[t]),n=(0,d.useCallback)(t=>t.filter(t=>{let a=(0,tX.X)(t);return!e.includes(a)}),[e]);return{hiddenPresetStyles:e,setHiddenPresetStyles:t,addHiddenPresetStyle:a,resetHiddenPresetStyles:s,filterHiddenStyles:n}}var sV=function(e){return e.VIEW="view",e.EDIT="edit",e.EDIT_MANUALLY="edit_manually",e}(sV||{});let sW=eg.YO(eg.Ik({key:eg.Yj(),name:eg.Yj(),nameKey:eg.Yj().optional(),text:eg.Yj(),textKey:eg.Yj().optional()})),s$=[],sJ=e=>{let{isSaveButton:t,children:a}=e;return(0,s.jsx)("div",{className:(0,p.A)("flex gap-1.5",t?"sm:absolute sm:top-5 sm:right-16 max-sm:mt-3 max-sm:-mb-2":"absolute top-5 right-16"),children:a})},sX=(0,d.forwardRef)((e,t)=>{let{animateBoolRef:a,style:n,setCurrentStyle:l,returnToListScreen:i,setChatStyle:r,setIsEditing:o,setIsEditingName:c}=e,u=(0,g.A)(),m=(0,tX.X)(n),x="default"===n.type,[p,f]=(0,d.useState)("view"),{mutateAsync:b}=(0,sm.lo)(m,x),{handleRateLimitError:v}=sk(),y=async e=>{let{prompt:t,editInput:a}=e;try{let e=await b({prompt:t,edit_instructions:a});e&&l(e)}catch(e){throw v(e,u.formatMessage({defaultMessage:"Failed to edit style. Please try again.",id:"1WkY08RVLW"})),Error}},j=e=>{o("edit"===e||"edit_manually"===e),f(e)};return(0,s.jsxs)(h.P.div,{className:"flex-1 min-h-0 grid sm:grid-cols-2 gap-3 pt-3",ref:t,children:["view"===p&&(0,s.jsxs)(sJ,{children:[(0,s.jsx)(eu.$,{variant:"secondary",className:"text-sm max-sm:hidden",onClick:()=>r(n),children:(0,s.jsx)(X.A,{defaultMessage:"Use style",id:"f7VY0ldE+0"})}),(0,s.jsx)(s2,{style:n,returnToListScreen:i,onRename:()=>c(!0),setStateToManualEdit:()=>j("edit_manually")})]}),(0,s.jsxs)(h.P.div,{className:"min-h-0",initial:!!a.current&&{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{scale:{type:"spring",stiffness:230,damping:15,delay:.1},opacity:{duration:.3,delay:.1}},children:["view"===p&&(0,s.jsx)(s0,{style:n,onClick:()=>j("edit")}),"edit"===p&&(0,s.jsx)(sQ,{style:n,updateStyle:y,onClose:()=>j("view")}),"edit_manually"===p&&(0,s.jsx)(sZ,{style:n,updateStyle:y,onClose:()=>j("view")})]}),(0,s.jsx)(s1,{style:n,animateBoolRef:a})]})});sX.displayName="EditStyle";let sQ=e=>{let{style:t,updateStyle:a,onClose:n}=e,l=(0,g.A)(),i=(0,d.useRef)(t.prompt),r=(0,d.useRef)(null),[o,c]=(0,d.useState)(!1),[u,m]=(0,d.useState)(!1),[x,b]=(0,d.useState)([]),[v,y]=(0,d.useState)(""),j=async e=>{if(e.preventDefault(),o||u)return!1;await w(v)},w=async e=>{y(""),c(!0),b([...x,e]);try{await a({editInput:e})}catch(e){y(v),b(e=>e.slice(0,-1))}c(!1)},k=async()=>{x.length&&(m(!0),await a({prompt:i.current}),m(!1)),n()},C=(0,d.useMemo)(()=>{if(!t.attributes)return[];let e=Math.floor(Math.random()*t.attributes.length),a=e+1<t.attributes.length?e+1:e-1;return[l.formatMessage({defaultMessage:"A bit more {attribute}",id:"au1WTQvqDg"},{attribute:t.attributes[e].name.toLowerCase()}),l.formatMessage({defaultMessage:"Much less {attribute}",id:"dIbq/Ow8Zn"},{attribute:t.attributes[a].name.toLowerCase()})]},[t.attributes,l]);return(0,d.useEffect)(()=>{if(x.length>0){var e;null==(e=r.current)||e.scrollTo({top:r.current.scrollHeight,behavior:"smooth"})}},[x,t.summary]),(0,s.jsxs)("div",{className:"h-full flex flex-col",children:[(0,s.jsxs)("div",{className:"flex-1 min-h-0 flex flex-col gap-2 p-2.5 rounded-xl border border-accent-secondary-100/50 bg-bg-100 ",children:[(0,s.jsxs)("div",{className:(0,p.A)("border-0.5 rounded-lg p-3 pt-2.5 mb-2 relative transition bg-gradient-to-b",o?"border-border-300 from-accent-secondary-900/50 to-accent-secondary-900/10":"border-accent-secondary-100/50 from-accent-secondary-900/75 to-accent-secondary-900/25"),children:[(0,s.jsx)("div",{className:(0,p.A)("font-claude-response font-normal text-pretty leading-snug text-text-200 transition",o?"opacity-0 scale-[0.975]":"delay-150 duration-150 ease-out"),children:t.summary}),(0,s.jsx)(f.N,{children:o&&(0,s.jsx)(h.P.div,{className:"absolute inset-0 grid place-items-center",initial:{scale:.75,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.75,opacity:0},children:(0,s.jsx)(sF.a,{state:"thinking"})})})]}),(0,s.jsx)("ul",{ref:r,className:"flex-1 min-h-0 overflow-y-auto flex flex-col gap-2",children:x.map(e=>(0,s.jsx)("li",{children:(0,s.jsx)("div",{className:"inline-block py-2 px-3 rounded-lg bg-bg-300 text-sm",children:e})},e))}),x.length>0?(0,s.jsx)("div",{className:"text-sm text-center text-text-500",children:(0,s.jsx)(X.A,{defaultMessage:"Ask for more edits, save, or discard changes",id:"zOxoAYYCog"})}):(0,s.jsxs)("div",{className:"mb-2",children:[(0,s.jsx)("div",{className:"text-sm text-text-500 mb-2",children:(0,s.jsx)(X.A,{defaultMessage:"Describe how youâ€™d like to edit the style, like:",id:"PRDvfjUkNA"})}),(0,s.jsx)("ul",{className:"flex flex-col gap-2",children:C.map((e,t)=>(0,s.jsx)("li",{children:(0,s.jsx)("button",{onClick:t=>{t.preventDefault(),w(e)},className:"text-sm font-medium h-8 px-3 rounded-full border-0.5 border-border-200 text-text-200 bg-gradient-to-b hover:text-text-000 hover:from-bg-400/0 hover:to-bg-400/50 hover:border-border-100 active:scale-x-[0.985] active:scale-y-[0.995] transition",children:e})},t))})]}),(0,s.jsx)("form",{className:"mb-1.5 mx-0.5",onSubmit:e=>j(e),children:(0,s.jsx)(a8.ks,{autoFocus:!0,className:"w-full",name:"inputText",placeholder:l.formatMessage({defaultMessage:"Ask Claude to edit the style...",id:"5D1Fao75P8"}),size:"lg",value:v,onChange:e=>y(e.target.value),append:(0,s.jsx)(f.N,{children:v.length>0&&(0,s.jsx)(h.P.div,{initial:{scale:.5,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.85,opacity:0,transition:{ease:"easeIn",duration:.1}},children:(0,s.jsx)(eu.$,{type:"submit",size:"icon_sm",variant:"claude",disabled:o||u,children:(0,s.jsx)(sz.D,{})})})})})})]}),(0,s.jsxs)(sJ,{isSaveButton:!0,children:[(0,s.jsx)(eu.$,{onClick:n,disabled:o||u||v.length>0||0===x.length,children:(0,s.jsx)(X.A,{defaultMessage:"Save changes",id:"X0ha1a+WYV"})}),(0,s.jsx)(eu.$,{onClick:k,disabled:o,loading:u,variant:"secondary",children:x.length>0?(0,s.jsx)(X.A,{defaultMessage:"Discard",id:"nmpevlUATU"}):(0,s.jsx)(X.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})})]})]})},sZ=e=>{let{style:t,updateStyle:a,onClose:n}=e,[l,i]=(0,d.useState)(!1),[r,o]=(0,d.useState)(t.prompt),c=(0,g.A)(),u=async e=>{e.preventDefault(),i(!0),await a({prompt:r}),i(!1),n()};return(0,s.jsxs)("form",{className:"flex flex-col gap-2 h-full min-h-0 p-3 pt-2 rounded-xl border-0.5 border-border-200",onSubmit:e=>u(e),children:[(0,s.jsx)("div",{className:"text-center text-sm text-text-200 font-medium",children:(0,s.jsx)(X.A,{defaultMessage:"Edit style instructions manually",id:"+qSf1b/LLJ"})}),(0,s.jsx)("textarea",{className:" flex-1 min-h-0 bg-bg-000 border border-border-200 p-3 leading-5 rounded-lg transition-colors hover:border-border-100 placeholder:text-text-500 focus:border-accent-secondary-100 focus:ring-0 focus:outline-none disabled:cursor-not-allowed disabled:opacity-50 whitespace-pre-wrap resize-none",name:"inputText",placeholder:c.formatMessage({defaultMessage:"Describe your style instructions",id:"nk7EX3l+b4"}),value:r,disabled:l,onChange:e=>o(e.target.value),autoFocus:!0}),(0,s.jsxs)(sJ,{isSaveButton:!0,children:[(0,s.jsx)(eu.$,{type:"submit",loading:l,children:(0,s.jsx)(X.A,{defaultMessage:"Save changes",id:"X0ha1a+WYV"})}),(0,s.jsx)(eu.$,{onClick:()=>{o(t.prompt),n()},disabled:l,variant:"secondary",children:(0,s.jsx)(X.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})})]})]})},s0=e=>{let{style:t,onClick:a}=e,n="default"===t.type;return(0,s.jsxs)("div",{className:(0,p.A)("flex flex-col items-center h-full px-6 gap-4 rounded-lg sm:rounded-xl max-sm:mx-1.5",!n&&"bg-gradient-to-b from-accent-secondary-900/75 to-accent-secondary-900/25 border border-accent-secondary-100/50",n&&"bg-bg-300 border border-border-300"),children:[(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsx)("div",{className:(0,p.A)("w-fit px-4 py-2 pb-2.5 gap-2.5 rounded-b-lg font-medium text-xs",n?"bg-bg-400 text-text-300":"bg-accent-secondary-200/10 text-accent-secondary-100"),children:n?(0,s.jsx)(X.A,{defaultMessage:"Preset style",id:"qwpRSZtBAV"}):(0,s.jsx)(X.A,{defaultMessage:"Your custom style",id:"o/vLK7B7mw"})})}),(0,s.jsxs)("div",{className:"flex flex-col items-center gap-1.5 pb-4",children:[!n&&(0,s.jsx)(eC.m,{className:"text-center",tooltipContent:(0,s.jsx)(X.A,{defaultMessage:"Full style instructions are generated and include more than shown in summary. You can edit instructions manually from the options menu",id:"R5PMcY1ELo"}),children:(0,s.jsxs)("div",{className:"flex items-center gap-1 cursor-help opacity-50 hover:opacity-60",children:[(0,s.jsx)("span",{className:"text-sm font-medium",children:(0,s.jsx)(X.A,{defaultMessage:"Style summary",id:"hVmQ4DO8io"})}),(0,s.jsx)(aI.R,{size:12,className:"translate-y-px",weight:"bold"})]})}),(0,s.jsx)("div",{"data-testid":"style-summary",className:"font-claude-response text-xl font-normal text-pretty leading-snug text-center flex-1 flex items-center",children:"default"===t.type&&t.summaryKey?(0,s.jsx)(tW.X5,{id:t.summaryKey}):t.summary})]}),(0,s.jsx)("div",{className:"flex-1 flex items-center text-sm",children:n?(0,s.jsx)(X.A,{defaultMessage:"Preset styles are not editable",id:"qjKy0s/reb"}):(0,s.jsx)(eu.$,{variant:"secondary",onClick:a,className:"!border-accent-secondary-200 !text-accent-secondary-000 hover:!bg-accent-secondary-100/10",prepend:(0,s.jsx)(sH.f,{weight:"bold"}),children:(0,s.jsx)(X.A,{defaultMessage:"Edit with Claude",id:"wdKoWlVN+G"})})})]})},s1=e=>{let{style:t,animateBoolRef:a}=e,n=(0,g.A)(),[l,i]=(0,d.useState)(""),[r,o]=(0,d.useState)(),c=(0,d.useRef)(t.prompt),u=(0,d.useRef)(r),x=(0,m.T9)("claude_style_previews","previewExamples",s$,sW),{handleRateLimitError:b}=sk(),{isPending:v,mutateAsync:y}=(0,sm.n7)(),j=(0,d.useCallback)(async()=>{if(r)try{let e=await y({style_prompt:t.prompt,example_key:r.key,example_text:r.textKey?(0,tW.fl)({id:r.textKey,intl:n}):r.text});i(e)}catch(e){b(e,n.formatMessage({defaultMessage:"Failed to preview style. Please try again.",id:"B2A4x/wbTg"}))}},[b,y,r,t.prompt,n]);return(0,d.useEffect)(()=>{var e;(c.current!==t.prompt||(null==(e=u.current)?void 0:e.key)!==(null==r?void 0:r.key))&&(c.current=t.prompt,u.current=r,j())},[j,r,t.prompt]),(0,s.jsx)(h.P.div,{className:(0,p.A)("max-sm:hidden flex flex-col gap-2 h-full min-h-0 p-2 rounded-xl border-0.5 border-border-300 transition-colors",r?"bg-bg-000/70":"bg-bg-000/20"),initial:!!a.current&&{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{scale:{type:"spring",stiffness:230,damping:15,delay:.2},opacity:{duration:.3,delay:.2}},children:r?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex items-center text-sm px-2 font-medium text-text-200",children:[(0,s.jsx)(X.A,{defaultMessage:"Previewing with",id:"tNFdPqESDT"}),(0,s.jsx)(sx.ms,{align:"center",trigger:(0,s.jsxs)("button",{className:"flex items-center !px-1 !py-0.5 gap-0.5 !text-accent-secondary-100 hover:!bg-accent-secondary-900",children:[r?r.nameKey?(0,s.jsx)(tW.X5,{id:r.nameKey}):r.name:(0,s.jsx)(X.A,{defaultMessage:"Example",id:"xrCRnH/mKK"}),(0,s.jsx)(sq.a,{className:"translate-y-px"})]}),children:x.map(e=>(0,s.jsx)(sx.tJ,{disabled:v,onClick:()=>o(e),children:e.nameKey?(0,s.jsx)(tW.X5,{id:e.nameKey}):e.name},e.key))})]}),(0,s.jsxs)(sL.E,{className:"p-2 pt-0 min-h-0 overflow-y-scroll",children:[(0,s.jsx)("div",{className:"bg-bg-300 -mx-0.5 mb-2 py-1.5 px-2 text-sm rounded-lg text-pretty",children:r.textKey?(0,s.jsx)(tW.X5,{id:r.textKey}):r.text}),(0,s.jsx)(f.N,{children:v?(0,s.jsx)("div",{className:"pt-2",children:(0,s.jsx)(sF.a,{state:"writing"})}):(0,s.jsx)(h.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{ease:"easeIn",duration:.25},children:(0,s.jsx)(sP.fP,{className:"font-claude-response flex-1 flex flex-col gap-2",text:l})})})]})]}):(0,s.jsx)("div",{className:"flex-1 grid place-items-center text-center",children:(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsx)("div",{className:"text-sm text-text-500 font-medium mb-4",children:(0,s.jsx)(X.A,{defaultMessage:"Preview with an example...",id:"YdUmd5z6YL"})}),(0,s.jsx)("div",{className:"flex flex-wrap justify-center gap-2 w-full",children:x.map(e=>(0,s.jsx)("button",{onClick:()=>o(e),className:"\n                    rounded-full\n                    border-0.5\n                    border-border-300\n                    text-sm\n                    text-text-400\n                    font-medium\n                    h-8\n                    px-3\n                    flex\n                    items-center\n                    bg-gradient-to-b\n                    from-always-black/0\n                    to-always-black/5\n                    hover:bg-accent-secondary-900\n                    hover:text-accent-secondary-000\n                    hover:border-accent-secondary-100/50\n                    transition-colors",children:e.nameKey?(0,s.jsx)(tW.X5,{id:e.nameKey}):e.name},e.key))})]})})})},s2=e=>{let{style:t,returnToListScreen:a,onRename:n,setStateToManualEdit:l}=e,i=(0,tX.X)(t),o="default"===t.type,{isPending:d,mutateAsync:c}=(0,sm.M$)(i),{addHiddenPresetStyle:u}=sK(),{clearStoredStyle:m,storedStyle:x}=(0,tJ.p)(),{addError:p}=(0,r.Yf)(),f=(0,g.A)(),h=async()=>{if(o)u(t),setTimeout(()=>{a()},500);else try{await c(),x&&"uuid"in x&&x.uuid===t.uuid&&m(),a()}catch(e){p(f.formatMessage({defaultMessage:"Failed to delete style. Please try again.",id:"4eIHICfKCI"}),{error:e,messageForLogging:"Failed to delete style. Please try again."})}};return(0,s.jsxs)(sx.ms,{align:"end",unstyledTrigger:!0,trigger:(0,s.jsxs)(eu.$,{variant:"ghost",className:"max-sm:min-w-8 max-sm:px-2 sm:pl-3 sm:pr-2",children:[(0,s.jsxs)("span",{className:"hidden sm:flex items-center gap-1",children:[(0,s.jsx)(X.A,{defaultMessage:"Options",id:"NDV5MqT9ww"}),"\xa0",(0,s.jsx)(sq.a,{})]}),(0,s.jsx)("span",{className:"sm:hidden",children:(0,s.jsx)(sO.L,{weight:"bold",size:20})})]}),children:[!o&&(0,s.jsx)(sx.tJ,{disabled:d,onClick:()=>{n()},children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(sU.g,{className:"mr-2"}),(0,s.jsx)(X.A,{defaultMessage:"Rename style",id:"sEO8vFphTF"})]})}),"Concise"===i?(0,s.jsx)(sx.q,{className:"text-sm",children:(0,s.jsx)(X.A,{defaultMessage:"Concise style canâ€™t be hidden",id:"zTztS+Om9I"})}):(0,s.jsx)(sx.tJ,{className:"pr-0 !text-danger-000",disabled:d,onClick:h,children:o?(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(sY.C,{}),(0,s.jsx)(X.A,{defaultMessage:"Hide preset style",id:"z44N28JZYv"})]}):(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(sG.l,{}),(0,s.jsx)(X.A,{defaultMessage:"Delete style",id:"fAqSoPl78t"})]})}),!o&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(sx.DG,{}),(0,s.jsx)(sx.tJ,{onClick:l,children:(0,s.jsx)(X.A,{defaultMessage:"Edit style manually",id:"H+z4uo2Wfn"})})]})]})},s5=e=>{let{size:t=16,className:a}=e;return(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",width:t,height:t,viewBox:"0 0 16 16",className:a,strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("path",{d:"M8.5 4.5c-3 2-4.5 4-5.5 8L2.5 15l1-1.5"}),(0,s.jsx)("path",{d:"M3 4.5c-.5 1.3-.1 5 .4 6.5 0 0 1.9-2 4.1-3 1.8-.8 3.8-.6 4.5-2 .6-1.2-.2-1.7-1.5-1 1.2-.7 4-2 3-3.5-1-1.4-3.5-.1-4.5.8C9 1.9 9 .9 8 1c-1 .1-2 1.5-2.3 2.8 0 0 0-.7-.7-.8-.7-.1-1.6.5-2 1.5Z"}),(0,s.jsx)("path",{d:"M10.5 11v4m-2-2h4"})]})};var s3=a(0x17fa2b30f),s4=a(0x1e6551146),s8=a(0x9fa0975a),s6=a(0xc454ce54),s9=a(0x18af45dd9);let s7=(0,d.forwardRef)((e,t)=>{let{setScreen:a,styles:n,onStyleChange:l}=e,{hiddenPresetStyles:i,resetHiddenPresetStyles:r}=sK(),{sortStyles:o,setOrder:c}=function(){let[e,t]=(0,sB.Vc)("userStylesOrder",[]);return{sortStyles:(0,d.useCallback)(t=>[...t].sort((t,a)=>{let s=(0,tX.X)(t),n=(0,tX.X)(a);if("Default"===s)return -1;if("Default"===n)return 1;let l=e.indexOf(s),i=e.indexOf(n);return -1===l&&-1===i?0:-1===l?1:-1===i?-1:l-i}),[e]),stylesOrder:e,setOrder:(0,d.useCallback)(e=>{t(e.map(e=>(0,tX.X)(e)))},[t])}}(),[u,m]=(0,d.useState)([]),x=(0,d.useCallback)(e=>{let t=[...i,"Default"];return o(e.filter(e=>!t.includes((0,tX.X)(e))))},[i,o]);(0,d.useEffect)(()=>{m(x(n))},[n,x]);let p=(0,d.useCallback)(e=>{Array.isArray(e)&&(m(e),c(e))},[c]),f=(0,d.useMemo)(()=>n.some(e=>"custom"===e.type),[n]);return(0,s.jsxs)(h.P.div,{exit:{opacity:0,transition:{duration:0}},ref:t,className:"flex-1 min-h-0 flex flex-col -mx-3",children:[(0,s.jsxs)("div",{className:"flex-1 min-h-0",children:[(0,s.jsx)(s8.x,{as:"ul",axis:"y",values:u,onReorder:p,layoutScroll:!0,className:"pl-3 pr-3 pb-2 overflow-y-auto max-h-full [mask-image:linear-gradient(to_top,hsl(var(--always-black)/0%)_0%,_hsl(var(--always-black)/100%)_3%)]",children:u.map(e=>(0,s.jsx)(ne,{style:e,onClick:()=>l(e,!1)},(0,tX.X)(e)))}),!f&&(0,s.jsxs)(h.P.div,{initial:{opacity:0,scale:.985},animate:{opacity:1,scale:1,transition:{delay:.3,ease:"easeOut",duration:.3}},exit:{opacity:0},className:"flex bg-gradient-to-b from-accent-pro-900/20 to-accent-pro-900/50 py-3 pl-3.5 pr-5 mx-3 rounded-lg border-0.5 border-border-300 text-text-300 text-sm",children:[(0,s.jsx)("div",{className:"font-ui-serif font-medium mr-4 text-accent-pro-000 mt-px whitespace-nowrap",children:(0,s.jsx)(X.A,{defaultMessage:"Tip",id:"4j1TGZubAJ"})}),(0,s.jsx)("p",{children:(0,s.jsx)(X.A,{defaultMessage:"Choose from preset styles or create your own custom style to tailor elements of Claudeâ€™s written responses such as tone, voice, vocabulary, detail level, and more. <link>Learn about styles</link>",id:"pwT6iI4QV7",values:{link:e=>(0,s.jsx)(a7.Y,{href:"https://support.anthropic.com/en/articles/10181068-configuring-and-using-styles",target:"_blank",children:e})}})})]})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center mt-4 mx-3",children:[(0,s.jsx)(eu.$,{onClick:()=>a(t$.I.CREATE),prepend:(0,s.jsx)(s5,{}),children:(0,s.jsx)(X.A,{defaultMessage:"Create custom style",id:"9y/YEanHck"})}),i.length>0&&(0,s.jsx)(a7.Y,{onClick:r,children:(0,s.jsx)(X.A,{defaultMessage:"Reset preset styles",id:"EITqrHaUNi"})})]})]})});s7.displayName="ListStyles";let ne=e=>{let{style:t,onClick:a}=e,n="default"===t.type,l=(0,s6.m)(),[i,r]=(0,d.useState)(!1);return(0,s.jsxs)(s9.N,{value:t,dragListener:!1,dragControls:l,dragTransition:{bounceStiffness:500,bounceDamping:40},onDragStart:()=>r(!0),onDragEnd:()=>r(!1),className:"relative my-2 min-w-0",children:[(0,s.jsxs)("button",{className:(0,p.A)("\n          flex\n          items-center\n          w-full\n          h-11\n          py-4\n          pl-1\n          pr-3\n          min-w-0\n          rounded-lg\n          transition\n          border-0.5\n          border-border-300\n          bg-bg-100\n          bg-gradient-to-b\n          from-bg-300/0\n          to-bg-300/50\n          select-none\n          relative\n        ",i?"scale-y-[1.015] scale-x-[1.0025] shadow-md":"group hover:enabled:from-accent-secondary-200/0 hover:enabled:to-accent-secondary-200/10 hover:enabled:border-accent-secondary-200/50"),onClick:a,children:[(0,s.jsx)("div",{className:"flex min-w-0 items-center flex-1 pl-7 truncate",children:"default"===t.type&&t.nameKey?(0,s.jsx)(tW.X5,{id:t.nameKey}):t.name}),n&&(0,s.jsx)("div",{className:"mr-0.5 rounded-full px-2 py-0.5 bg-text-300/5 text-text-400 font-medium text-[0.625rem]",children:(0,s.jsx)(X.A,{defaultMessage:"Preset",id:"EucS2pAMVS"})}),(0,s.jsx)("div",{className:"text-accent-secondary-200 opacity-0 scale-50 transition group-hover:scale-100 group-hover:opacity-100",children:n?(0,s.jsx)(s3.Q,{}):(0,s.jsx)(sU.g,{})})]}),(0,s.jsx)("div",{onPointerDown:e=>l.start(e),onClick:e=>e.stopPropagation(),className:"w-7 h-7 absolute left-1 top-1/2 -translate-y-1/2 grid place-items-center cursor-move text-text-500 hover:text-accent-secondary-000",children:(0,s.jsx)(s4.H,{size:16,weight:"bold"})})]})},nt=e=>{let{openWithScreen:t,onClose:a,styles:n,setChatStyle:l}=e,i=(0,g.A)(),r=!!t,o=(0,tH.st)(),[c,u]=(0,d.useState)(t||t$.I.LIST),[m,x]=(0,d.useState)(),[p,h]=(0,d.useState)(!1),[b,v]=(0,d.useState)(!1),y=(0,d.useRef)(!1);(0,d.useEffect)(()=>{t&&u(t)},[t]);let j=()=>{y.current=!1,u(t$.I.LIST),h(!1),v(!1)},w=()=>{(!p||window.confirm(i.formatMessage({defaultMessage:"Are you sure? Closing while editing may not synchronize changes.",id:"0XdWZrmwXu"})))&&(o.track({event_key:"styles.modal",open:!1}),j(),a())},k=(e,t)=>{y.current=t,x(e),u(t$.I.EDIT),h(!1),v(!1)};return(0,s.jsx)(eI.aF,{modalSize:"xl",title:(e=>{switch(e){case t$.I.CREATE:return(0,s.jsx)("div",{className:"font-ui-serif font-normal",children:(0,s.jsx)(X.A,{defaultMessage:"Create a style",id:"/pKvFi9Ak4"})});case t$.I.CREATE_MANUALLY:return(0,s.jsx)("div",{className:"font-ui-serif font-normal",children:(0,s.jsx)(X.A,{defaultMessage:"Describe your style",id:"Ntblq5cSRe"})});case t$.I.LIST:return(0,s.jsx)("div",{className:"font-ui-serif font-normal",children:(0,s.jsx)(X.A,{defaultMessage:"Customize your styles",id:"dn3MiW/vUH"})});case t$.I.EDIT:return(0,s.jsx)("div",{className:"w-10/12 sm:w-5/12 md:w-7/12",children:b?(0,s.jsx)(na,{style:m,onClose:e=>{e&&x(e),v(!1)}}):(0,s.jsx)("button",{title:m.name,className:"w-full font-ui-serif font-normal text-left truncate cursor-text h-9 pr-4 leading-none translate-y-px text-text-200 hover:text-text-000",onClick:()=>!p&&v(!0),children:p?(0,s.jsx)(X.A,{defaultMessage:"Edit {name}",id:"s3IOQQ+nJU",values:{name:m.name}}):"default"===m.type&&m.nameKey?(0,s.jsx)(tW.X5,{id:m.nameKey}):m.name})})}})(c),icon:(e=>{switch(e){case t$.I.CREATE:case t$.I.EDIT:return(0,s.jsx)(eu.$,{variant:"ghost",size:"icon_sm",disabled:p,onClick:()=>j(),children:(0,s.jsx)(sc.n,{})});case t$.I.CREATE_MANUALLY:return(0,s.jsx)(eu.$,{variant:"ghost",size:"icon_sm",onClick:()=>u(t$.I.CREATE),children:(0,s.jsx)(sc.n,{})});case t$.I.LIST:return null}})(c),isOpen:r,onClose:w,className:"h-[35rem] !bg-gradient-to-b from-bg-100 to-bg-200 !pt-5 !pb-7",prependBeforeCloseButton:(0,s.jsx)(s.Fragment,{children:c===t$.I.LIST&&(0,s.jsx)(eC.m,{tooltipContent:i.formatMessage({defaultMessage:"Learn more about styles â†—",id:"nuhnis5YtY"}),children:(0,s.jsx)("div",{className:"mr-1",children:(0,s.jsx)(eu.$,{href:"https://support.anthropic.com/en/articles/10181068-configuring-and-using-styles",variant:"ghost",className:"text-text-300",size:"icon",target:"_blank",children:(0,s.jsx)(su.v,{size:18})})})})}),hasCloseButton:!0,children:(0,s.jsxs)(f.N,{mode:"popLayout",children:[c===t$.I.CREATE&&(0,s.jsx)(sN,{onStyleChange:k,setScreen:u,animateBoolRef:y},"CreateStyleScreen"),c===t$.I.CREATE_MANUALLY&&(0,s.jsx)(sD,{onStyleChange:k,setScreen:u},"CreateStyleManuallyScreen"),c===t$.I.LIST&&(0,s.jsx)(s7,{setScreen:u,styles:n,onStyleChange:k},"ListStylesScreen"),c===t$.I.EDIT&&m&&(0,s.jsx)(sX,{animateBoolRef:y,style:m,returnToListScreen:j,setIsEditingName:v,setCurrentStyle:x,setIsEditing:h,setChatStyle:e=>{l(e),w()}},"EditStyleScreen")]})})},na=e=>{let{style:t,onClose:a}=e,n=(0,tX.X)(t),l="default"===t.type,i=(0,g.A)(),[r,o]=(0,d.useState)("default"===t.type&&t.nameKey?(0,tW.fl)({id:t.nameKey,intl:i}):t.name),{isPending:c,mutateAsync:u}=(0,sm.lo)(n,l),m=async()=>{a(await u({name:r}))};return(0,s.jsx)("form",{className:"w-full",onSubmit:async e=>{e.preventDefault(),await m()},children:(0,s.jsx)(a8.ks,{autoFocus:!0,className:"w-full",value:r,maxLength:64,onChange:e=>o(e.target.value),error:0===r.length,append:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eu.$,{variant:"ghost",type:"button",size:"icon_xs",className:"mr-1",onClick:()=>a(),disabled:c,children:(0,s.jsx)(ss.X,{})}),(0,s.jsx)(eu.$,{variant:"claude",size:"icon_xs",type:"submit",loading:c,children:(0,s.jsx)(aW.J,{weight:"bold"})})]})})})};var ns=a(0x1a28f0915),nn=a(0x1757bd130);let nl=(0,a(0x394ef833).v)(e=>({filePath:null,setFilePath:t=>e({filePath:t})}));var ni=a(0xeaff4de);let nr=()=>{let e=(0,m.fS)("overages_upsell_disabled"),t=(0,V.QN)(),{conversation:a}=(0,V.lE)(),{setSyncSourceUuids:n,syncSourceUuids:l,attachments:i,setAttachments:r}=(0,V.Jy)(e=>({setSyncSourceUuids:e.setSyncSourceUuids,syncSourceUuids:e.syncSourceUuids,attachments:e.attachments,setAttachments:e.setAttachments})),{setProjectUuid:o,setIsUploadingGithubSync:c}=(0,k.oM)(),{styleModalOpenWithScreen:u,setStyleModalOpenWithScreen:x,createProjectModalIsOpen:p,setCreateProjectModalIsOpen:f,githubModalIsOpen:h,setGithubModalIsOpen:g,gmailAuthModalIsOpen:v,setGmailAuthModalIsOpen:y,createPromptArgumentModalIsOpen:j,setCreatePromptArgumentModalIsOpen:w}=(0,e7.CH)(),{mcpDirectoryModalIsOpen:C,setMcpDirectoryModalIsOpen:M}=(0,e7.tl)(),{personalizedStyleOptions:N}=(0,tJ.p)(),{moveToProject:A}=(0,tR.j)(),S=(0,ee.sb)(),_=(0,tC.pi)(),E=(0,d.useCallback)(e=>{n(t=>[...t,e.uuid]),c(!1)},[n,c]),I=(0,b.NY)(l),T=(0,a4.B7)(I);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(nt,{openWithScreen:u,onClose:()=>x(null),styles:N,setChatStyle:e=>_(e.key)}),(0,s.jsx)(nn.r,{isOpen:!!v,onClose:()=>y(!1),callerIdentifier:"inputMenu"}),(0,s.jsx)(so,{moveAttachments:!!(null==p?void 0:p.moveAttachments),isOpen:!!(null==p?void 0:p.isOpen),handleClose:()=>f(null),handleProjectCreated:e=>{(null==a?void 0:a.id)?A([a.id],e.uuid,e.name,{enableNavigation:!0}):o(e.uuid),f(null)},syncSources:T,attachments:i,setSyncSourceUuids:n,setAttachments:r}),(0,s.jsx)(ns.s,{location:"chat",projectUuid:t,isOpen:h,onClose:()=>g(!1),onCreated:E,setIsUploadingGithubSync:c}),j&&(0,s.jsx)(sa,{isOpen:j.isOpen,onClose:()=>w(null),serverUuid:j.serverUuid,prompt:j.prompt}),S&&(0,s.jsx)(aS.TY,{isOpen:C,setIsOpen:M,showManageButton:!0}),!e&&(0,s.jsx)(ni.Rk,{}),""]})},no=(0,d.memo)(e=>{let{options:t,onSelect:a,onClose:n,position:l,selectedIndex:i}=e,r=(0,d.useRef)(null),[o,c]=(0,d.useState)(l),[u,m]=(0,d.useState)(null),x=null!=u?u:i;return((0,d.useEffect)(()=>{if(r.current){let e=r.current.getBoundingClientRect(),t=window.innerWidth,a=window.innerHeight,s=l.top,n=l.left;e.right>t&&(n=Math.max(0,t-e.width-16)),e.bottom>a&&(s=Math.max(0,l.top-e.height-24)),c({top:s,left:n})}},[l.top,l.left,t.length]),(0,d.useEffect)(()=>{if(r.current&&x>=0){let e=r.current.children[x];null==e||e.scrollIntoView({block:"nearest"})}},[x]),(0,d.useEffect)(()=>{let e=e=>{r.current&&!r.current.contains(e.target)&&n()};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[n]),0===t.length)?null:(0,s.jsx)("div",{ref:r,className:"fixed z-50 max-h-96 w-60 overflow-y-auto rounded-2xl border-0.5 border-border-200 bg-bg-000 shadow-lg p-2",style:{top:"".concat(o.top,"px"),left:"".concat(o.left,"px")},children:t.map((e,t)=>(0,s.jsxs)("button",{type:"button",className:(0,p.A)("w-full flex items-center gap-2 overflow-clip","pl-2 pr-1.5 py-1.5 rounded-lg","font-base text-text-300 text-left","cursor-pointer select-none","hover:bg-bg-200 focus:bg-bg-200 focus:outline-none",x===t&&"bg-bg-200"),onClick:()=>a(e.id),onMouseEnter:()=>m(t),onMouseLeave:()=>m(null),children:[e.icon&&(0,s.jsx)("span",{className:"flex-shrink-0 w-5 h-5 flex items-center justify-center",children:"string"==typeof e.icon?(0,s.jsx)("img",{src:e.icon,alt:"",className:"w-4 h-4"}):e.icon}),(0,s.jsx)("span",{className:"flex-1 truncate text-left",children:e.label})]},e.id))})});no.displayName="MentionDropdown";var nd=a(0x1b847d515),nc=a(0xd674e3b3);let nu=new nd.hs("mention"),nm=nc.YY.create({name:"mentionExtension",addOptions:()=>({providers:[],onStateChange:()=>void 0,onSelect:()=>void 0}),addProseMirrorPlugins(){let{providers:e,onStateChange:t}=this.options;return[new nd.k_({key:nu,state:{init:()=>({active:!1,query:"",position:null,options:[],selectedIndex:0}),apply:(e,a,s,n)=>{let l=e.getMeta(nu);if(l){let e={...a,...l};return t(e),e}return a}},view:()=>{let t=null,a=null;return{update:(s,n)=>{let{state:l}=s,{selection:i}=l,{$from:r}=i,o=r.parent.textBetween(Math.max(0,r.parentOffset-50),r.parentOffset,void 0,"ï¿¼").match(/(?:^|\s)@(\w*)$/);if(!o){t=null,a&&(clearTimeout(a),a=null);let e=nu.getState(l);(null==e?void 0:e.active)&&s.dispatch(l.tr.setMeta(nu,{active:!1,query:"",options:[],position:null,selectedIndex:0}));return}let d=o[1]||"",c=nu.getState(l),u=nu.getState(n);if((null==u?void 0:u.active)&&!(null==c?void 0:c.active)){t=u.query,a&&(clearTimeout(a),a=null);return}if(null!==t){if(""===t&&""===d||""!==t&&d.startsWith(t))return;t=null}if((null==c?void 0:c.active)&&c.query===d)return;let m=s.coordsAtPos(r.pos),x={top:m.bottom+4,left:m.left};a&&clearTimeout(a),a=setTimeout(()=>{(async()=>{let t=(await Promise.all(e.map(e=>e.fetchOptions(d)))).flat();s.dispatch(l.tr.setMeta(nu,{active:!0,query:d,position:x,options:t,selectedIndex:(null==c?void 0:c.active)&&c.query===d?c.selectedIndex:0}))})()},250)},destroy:()=>{a&&clearTimeout(a)}}}})]},addKeyboardShortcuts(){return{ArrowDown:()=>{let e=nu.getState(this.editor.state);if(!(null==e?void 0:e.active))return!1;let t=Math.min(e.selectedIndex+1,e.options.length-1);return this.editor.view.dispatch(this.editor.state.tr.setMeta(nu,{selectedIndex:t})),!0},ArrowUp:()=>{let e=nu.getState(this.editor.state);if(!(null==e?void 0:e.active))return!1;let t=Math.max(e.selectedIndex-1,0);return this.editor.view.dispatch(this.editor.state.tr.setMeta(nu,{selectedIndex:t})),!0},Enter:()=>{let e=nu.getState(this.editor.state);if(!(null==e?void 0:e.active))return!1;let t=e.options[e.selectedIndex];return t&&this.options.onSelect(t.id),!0},Escape:()=>{let e=nu.getState(this.editor.state);return!!(null==e?void 0:e.active)&&(this.editor.view.dispatch(this.editor.state.tr.setMeta(nu,{active:!1,query:"",options:[],position:null,selectedIndex:0})),!0)}}}});var nx=a(0xe94b0893);let np=(0,d.memo)(e=>{let{node:t,selected:a}=e,[n,l]=(0,d.useState)(!1),i=t.attrs,r=i.label||"";return(0,s.jsxs)(nx.VR,{as:"span",className:(0,p.A)("inline-flex relative cursor-pointer group mx-0.5",a?"text-accent-secondary-000":"text-accent-secondary-100"),contentEditable:!1,"data-drag-handle":!0,onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),children:[(0,s.jsx)("span",{className:(0,p.A)("absolute -inset-y-0.5 -left-0.5 -right-1 rounded-md pointer-events-none",a&&"bg-accent-secondary-900",n&&!a&&"bg-accent-secondary-900/50")}),(0,s.jsxs)("span",{className:(0,p.A)("relative",i.icon&&"pl-5"),children:[i.icon&&(0,s.jsx)("span",{className:"absolute top-1/2 -translate-y-1/2 left-0 w-5 h-5 flex items-center justify-center",children:i.icon.startsWith("data:image")?(0,s.jsx)("img",{src:i.icon,alt:"",className:"h-4 w-4",title:r}):(0,s.jsx)("span",{className:"h-4 w-4",dangerouslySetInnerHTML:{__html:i.icon},title:r})}),(0,s.jsx)("span",{className:"relative [&::selection]:bg-transparent",children:r})]})]})});np.displayName="MentionChip";let nf=nc.bP.create({name:"mention",group:"inline",inline:!0,atom:!0,addAttributes:()=>({id:{default:null,parseHTML:e=>e.getAttribute("data-id"),renderHTML:e=>({"data-id":e.id})},label:{default:null,parseHTML:e=>e.getAttribute("data-label"),renderHTML:e=>({"data-label":e.label})},icon:{default:null,parseHTML:e=>e.getAttribute("data-icon"),renderHTML:e=>({"data-icon":e.icon})},providerId:{default:null,parseHTML:e=>e.getAttribute("data-provider-id"),renderHTML:e=>({"data-provider-id":e.providerId})}}),parseHTML:()=>[{tag:"span[data-type=â€œat-mentionâ€]"}],renderHTML(e){let{HTMLAttributes:t}=e;return["span",(0,nc.KV)(t,{"data-type":"at-mention"}),"@".concat(t["data-label"]||"")]},addNodeView:()=>(0,nx.gu)(np)});function nh(e){let t=e.split(":");return{serverUuid:t[0],resourceUri:t.slice(1).join(":")}}function ng(e){let t=e.getState(),a=[];for(let[e,s]of Object.entries(t.remoteServers)){if(!s)continue;let n=t.remoteConnectionStates[e];if(!(null==n?void 0:n.isConnected))continue;let l=t.remoteResources[e]||[];0!==l.length&&a.push({uuid:e,name:s.name,resources:l,iconType:"favicon",iconSrc:s.url})}for(let[e,s]of Object.entries(t.localClients)){if(!s)continue;let n=t.localResources[e]||[];0!==n.length&&a.push({uuid:s.uuid,name:e,resources:n,iconType:"external",iconSrc:void 0})}return a}var nb=a(0x16b1d0c0f);let nv={active:!1,query:"",position:null,options:[],selectedIndex:0};var ny=a(0x107838ca5);let nj=(0,d.createContext)({setOverrideSubmit:()=>!1});var nw=a(0x808b8338),nk=a(0x116207d9d),nC=a(0x11bffe47c),nM=a(0x996072ba),nN=a(0x20541bd9),nA=a(0x733b8fe2),nS=a.n(nA);let n_=new nd.hs("inputAutocomplete"),nE=()=>({decoration:null,completion:null}),nI=(e,t)=>nd.LN.atEnd(e).$anchor.pos===t.$anchor.pos,nT=e=>{let{editor:t}=e;if(!nI(t.state.doc,t.state.selection))return!1;let a=n_.getState(t.state);return!!a.decoration&&(t.view.dispatch(t.state.tr.insertText(a.completion.content)),!0)},nR=(e,t,a,s)=>{let n=e.getMeta(n_);if(n&&n.prompt===s.doc.textContent&&(t.completion=n),!nI(s.doc,s.selection)||!t.completion||t.completion.prompt!==s.doc.textContent)return t.decoration=null,t;let l=document.createElement("span");l.className="text-text-500",l.textContent=t.completion.content;let i=document.createElement("span");i.className="ml-1 px-1 border rounded-lg align-[1px] font-medium text-xs text-text-500",i.textContent="Tab";let r=s.selection.$head.pos,o=nN.NZ.widget(r,l),d=nN.NZ.widget(r,i);return t.decoration=nN.zF.create(s.doc,[o,d]),t},nD=nc.YY.create({name:"inputAutocompletion",addOptions:()=>({fetchInputAutocompletion:e=>Promise.resolve("")}),addProseMirrorPlugins(){let e=nS()(async(e,t)=>{try{let a=this.options.fetchInputAutocompletion,s=await a(t);s&&e.dispatch(e.state.tr.setMeta(n_,{prompt:t,content:s}))}catch(e){}},300);return[new nd.k_({key:n_,state:{init:nE,apply:nR},props:{decorations(e){return this.getState(e).decoration}},view:t=>{let{textContent:a}=t.state.doc;return a.length>=3&&e(t,a),{update:(t,a)=>{var s;let{state:n}=t,{doc:l}=n;!a.doc.eq(l)&&(null==(s=n_.getState(n).completion)?void 0:s.prompt)!==l.textContent&&l.textContent.length>=3&&e(t,l.textContent)}}}})]},addKeyboardShortcuts:()=>({Tab:nT})});var nP=a(0x26b0b403);let nF=e=>0===e.state.selection.$from.parentOffset,nL=e=>e.state.selection.$from.marks().some(e=>"code"===e.type.name),nz=e=>"heading"===e.state.selection.$from.parent.type.name,nO=e=>{let t=e.state.selection.$from;return t.parentOffset===t.parent.nodeSize-2},nU=e=>{let t=e.state.tr;t.setStoredMarks([]),t.insertText("â€‹"),e.view.dispatch(t)},nY=e=>!(e.state.selection.$from.after()<e.state.doc.content.size)&&(nU(e),!0),nG=e=>!(e.state.selection.$from.before()>0)&&e.chain().insertContentAt(0,"<p></p>").run(),nH=e=>!(e.state.selection.$from.after()<e.state.doc.content.size)&&e.chain().insertContent("<p></p>").run(),nq=nc.YY.create({name:"CodeBlockKeyboardNavExtension",addKeyboardShortcuts:()=>({ArrowUp:e=>{let{editor:t}=e;return"codeBlock"===t.state.selection.$from.parent.type.name&&!!nF(t)&&nG(t)}})}),nB=nc.YY.create({name:"InlineCodeKeyboardNavExtension",addKeyboardShortcuts:()=>({ArrowUp:e=>{let{editor:t}=e;return!!nL(t)&&!!nF(t)&&nG(t)},ArrowDown:e=>{let{editor:t}=e;return!!nL(t)&&!!nO(t)&&nH(t)},ArrowRight:e=>{let{editor:t}=e;return!!nL(t)&&!!nO(t)&&nY(t)},ArrowLeft:e=>{let{editor:t}=e;return!!nL(t)&&!!nF(t)&&(e=>!(e.state.selection.$from.before()>0)&&(nU(e),!0))(t)}})}),nK=nc.YY.create({name:"HeadingKeyboardNavExtension",addKeyboardShortcuts:()=>({ArrowUp:e=>{let{editor:t}=e;return!!nz(t)&&!!nF(t)&&nG(t)},ArrowDown:e=>{let{editor:t}=e;return!!nz(t)&&!!nO(t)&&nH(t)}})});nc.YY.create({name:"BoldKeyboardNavExtension",addKeyboardShortcuts:()=>({ArrowRight:e=>{let{editor:t}=e;return!!t.state.selection.$from.marks().some(e=>"bold"===e.type.name)&&!!nO(t)&&nY(t)}})}),nc.YY.create({name:"ItalicKeyboardNavExtension",addKeyboardShortcuts:()=>({ArrowRight:e=>{let{editor:t}=e;return!!t.state.selection.$from.marks().some(e=>"italic"===e.type.name)&&!!nO(t)&&nY(t)}})});let nV=nc.YY.create({name:"StrikeKeyboardNavExtension",addKeyboardShortcuts:()=>({ArrowRight:e=>{let{editor:t}=e;return!!t.state.selection.$from.marks().some(e=>"strike"===e.type.name)&&!!nO(t)&&nY(t)}})}),nW=e=>{let{editor:t}=e;return t.commands.enter(),t.commands.scrollIntoView(),!0},n$=nc.YY.create({name:"PTagShiftEnterCreateExtension",addKeyboardShortcuts:()=>({"Shift-Enter":nW,"Alt-Enter":nW})}),nJ=nc.YY.create({name:"pasteCodeAsPlainText",addProseMirrorPlugins:()=>[new nd.k_({key:new nd.hs("pasteCodeAsPlainText"),props:{handlePaste:(e,t,a)=>{let{schema:s}=e.state;if(!t.clipboardData||!t.clipboardData.types.includes("vscode-editor-data"))return!1;let n=t.clipboardData.getData("text/plain"),l=s.text(n);return e.dispatch(e.state.tr.replaceSelectionWith(l)),!0}}})]}),nX=()=>(0,s.jsx)(nx.VR,{className:"code-block",children:(0,s.jsx)("pre",{className:"my-4 block rounded-md bg-[#282c34] p-2 text-[0.875rem] text-[#abb2bf]",children:(0,s.jsx)("code",{children:(0,s.jsx)(nx.$p,{as:"div"})})})});var nQ=a(0x13adb921e);let nZ=(0,d.forwardRef)((e,t)=>{let{className:a,disabled:n,prompt:l,tipTapEditorState:i,setTipTapEditorState:o,placeholder:c,onSubmit:u,onReady:x,placement:f,fetchInputAutocompletion:h,onMentionAttachments:v,onMentionDeleted:y,extraExtensions:j=[]}=e,w=(0,g.A)(),k=(0,m.fS)("plain_text_input"),C=(0,m.fS)("chat_input_at_mentions"),M=E(),{mentionProviders:N,handleMentionDeleted:A}=function(e,t){let a=(0,tS.R4)(),n=(0,r.Yf)(),{syncSourceUuids:l,setSyncSourceUuids:i}=(0,V.Jy)(e=>({syncSourceUuids:e.syncSourceUuids,setSyncSourceUuids:e.setSyncSourceUuids})),o=(0,b.NY)(l).map(e=>e.data).filter(e=>void 0!==e),c=(0,d.useRef)(a),u=(0,d.useRef)(n),m=(0,d.useRef)(o),x=(0,d.useRef)(i);c.current=a,u.current=n,(0,d.useEffect)(()=>{m.current=o},[o]),(0,d.useEffect)(()=>{x.current=i},[i]);let p=(0,d.useCallback)(e=>{null==t||t(e,"desktop")},[t]),f=(0,d.useCallback)(e=>{let{resourceUri:t}=nh(e),a=m.current.filter(e=>{var a;let s=e.config;return(null==s||null==(a=s.resource)?void 0:a.uri)===t});if(a.length>0){let e=a.map(e=>e.uuid);x.current(t=>t.filter(t=>!e.includes(t)))}},[]),h=(0,d.useCallback)(e=>(0,s.jsx)(tt.z,{size:16,type:e.iconType,src:e.iconSrc,name:e.name}),[]),g=(0,d.useCallback)(e=>(0,nQ.qV)((0,s.jsx)(tt.z,{size:16,type:e.iconType,src:e.iconSrc,name:e.name})),[]),v=(0,d.useMemo)(()=>(function(e){let t=aB.EC;if(!(null==t?void 0:t.fetchMentionOptions)||!(null==t?void 0:t.handleMentionSelect))return null;let a=new Map;return{id:"desktop",fetchOptions:async e=>{let s=await t.fetchMentionOptions(e);return a.clear(),s.map(e=>(e.icon&&a.set(e.id,e.icon),{id:e.id,label:e.label,icon:e.icon?d.createElement("img",{src:e.icon,alt:"",className:"w-4 h-4"}):void 0,category:e.category,metadata:e.metadata?JSON.parse(e.metadata):void 0,providerId:"desktop"}))},onSelect:async e=>await t.handleMentionSelect(e),onDelete:e,getIconHtml:e=>a.get(e)}})(p),[p]),y=(0,d.useMemo)(()=>(function(e){let{connectorsStore:t,onSelect:a,onDelete:s,renderIcon:n,renderIconToHtml:l}=e;return{id:"mcp-resources",getIconHtml:e=>{let{serverUuid:a}=nh(e),s=ng(t).find(e=>e.uuid===a);return s?l(s):void 0},fetchOptions:e=>{let a=ng(t),s=e.toLowerCase(),l=[];for(let e of a)for(let t of e.resources.filter(e=>{var t,a;return(null==(t=e.name)?void 0:t.toLowerCase().includes(s))||(null==(a=e.description)?void 0:a.toLowerCase().includes(s))}))l.push({id:"".concat(e.uuid,":").concat(t.uri),label:t.name,icon:n(e),category:e.name,metadata:{serverUuid:e.uuid,resourceUri:t.uri},providerId:"mcp-resources"});return l},onSelect:async e=>{let{serverUuid:s,resourceUri:n}=nh(e),l=ng(t).find(e=>e.uuid===s),i=null==l?void 0:l.resources.find(e=>e.uri===n);if(!l||!i)throw Error("Resource not found");return await a(s,i),{chipText:i.name}},onDelete:s}})({connectorsStore:en.eZ,onSelect:async(e,t)=>{try{await c.current({serverUuid:e,resource:t})}catch(e){throw u.current.addError((0,es.J)(e),{error:e,errorContext:{tags:{source:"mention_mcp_resource_attach"}}}),e}},onDelete:f,renderIcon:h,renderIconToHtml:g}),[f,h,g]),j=(0,d.useMemo)(()=>e?[v,y].filter(Boolean):[],[e,v,y]),w=(0,d.useCallback)((e,t)=>{let a=j.find(e=>e.id===t);a&&a.onDelete(e)},[j]);return{mentionProviders:j,handleMentionDeleted:w}}(C,y),S=function(e){let{mentionProviders:t,onMentionAttachments:a,onMentionDeleted:s}=e,n=(0,tH.st)(),l=(0,d.useRef)(null),[i,r]=(0,d.useState)(nv),o=(0,d.useRef)(!1),c=(0,d.useCallback)(e=>{e.active&&!o.current&&n.track({event_key:"claudeai.mentions.dropdown.opened"}),o.current=e.active,r(e)},[n]),u=(0,d.useCallback)(()=>{r(nv)},[]),{handleMentionSelect:m}=function(e){let{editor:t,mentionProviders:a,mentionOptions:s,onMentionAttachments:n,onMentionDeleted:l,onDropdownClose:i}=e,r=(0,tH.st)(),o=(0,nb.f)(e=>e.incrementLoading),c=(0,nb.f)(e=>e.decrementLoading),u=d.useRef(null),m=d.useRef(new Map);return d.useEffect(()=>{t&&(u.current=async e=>{var l,d,u;i();let x=s.find(t=>t.id===e);if(!x||!t)return;let p=a.find(e=>e.id===x.providerId);if(!p)return;let{state:f,view:h}=t,{$from:g}=f.selection,b=g.parent.textBetween(Math.max(0,g.parentOffset-50),g.parentOffset,void 0,"ï¿¼").match(/(?:^|\s)@(\w*)$/);if(!b)return;let v=g.pos-b[0].length+ +!!b[0].startsWith(" "),y=f.tr;y.delete(v,g.pos);let j=null==(l=f.schema.nodes.mention)?void 0:l.create({id:e,label:x.label,icon:p.getIconHtml(e),providerId:x.providerId});j&&(y.insert(v,j),y.insertText(" ",v+1)),h.dispatch(y),m.current.set(e,x.providerId);let w=await p.onSelect(e);if(!w){t.view.dispatch(t.state.tr.delete(v,v+2)),m.current.delete(e);return}if(w.additionalText){let e=t.state.tr;e.insertText(w.additionalText,t.state.doc.content.size),t.view.dispatch(e)}r.track({event_key:"claudeai.mentions.option.selected",attachment_count:null!=(u=null==(d=w.attachments)?void 0:d.length)?u:0}),(0,a1.flushSync)(()=>{o()});try{n&&w.attachments&&await n(e,w.attachments),t.commands.focus()}finally{(0,a1.flushSync)(()=>{c()})}})},[t,a,s,n,i,r,o,c]),d.useEffect(()=>{if(!t||!l)return;let e=e=>{let{transaction:t}=e,{before:a}=t;t.steps.forEach(e=>{if(void 0!==e.from&&void 0!==e.to){let t=e.from,s=e.to;t<s&&a.nodesBetween(t,s,e=>{if("mention"===e.type.name&&e.attrs.id){let t=e.attrs.id,a=m.current.get(t);a&&(l(t,a),m.current.delete(t))}})}})};return t.on("update",e),()=>{t.off("update",e)}},[t,l]),{handleMentionSelect:d.useCallback(async e=>{u.current&&await u.current(e)},[])}}({editor:l.current,mentionProviders:t,mentionOptions:i.options,onMentionAttachments:a,onMentionDeleted:s,onDropdownClose:u});return{mentionState:i,handleStateChange:c,handleDropdownClose:u,handleMentionSelect:m,setEditor:(0,d.useCallback)(e=>{l.current=e},[])}}({mentionProviders:N,onMentionAttachments:v,onMentionDeleted:A}),{editor:_}=(e=>{let{tipTapEditorState:t,setTipTapEditorState:a,onReady:s,placeholder:n,extraEditorAttributes:l={},fetchInputAutocompletion:i,plainTextMode:r=!1,mentionsEnabled:o=!1,mentionProviders:c=[],onMentionStateChange:u,onMentionSelect:m,extraExtensions:x=[]}=e,p=(0,d.useRef)(n),f=(0,d.useRef)(()=>p.current),h=[nk.A.configure({placeholder:f.current,emptyEditorClass:"is-editor-empty before:!text-text-500 before:whitespace-nowrap"}),nD.configure({fetchInputAutocompletion:i}),n$],g=o?[nf,nm.configure({providers:c,onStateChange:null!=u?u:()=>void 0,onSelect:null!=m?m:()=>void 0})]:[],b=[nJ,nw.A.extend({addNodeView:()=>(0,nx.gu)(nX)}).configure({lowlight:nM.l,exitOnTripleEnter:!1}),nq,nK,nB,nV],v=[nC.A.configure(r?{bold:!1,italic:!1,strike:!1,code:!1,codeBlock:!1,blockquote:!1,hardBreak:!1,heading:!1,horizontalRule:!1,bulletList:{},orderedList:{},listItem:{}}:{bold:!1,italic:!1,codeBlock:!1,blockquote:!1,hardBreak:!1,heading:!1,horizontalRule:!1}),...h,...r?[]:b,...g,...x],y=(0,nx.hG)({immediatelyRender:!1,editorProps:{attributes:{enterkeyhint:"enter",...l}},onCreate:e=>{let{editor:t}=e;null==s||s({editor:t})},autofocus:!(0,G.Fr)()&&"end",extensions:v,content:t,onUpdate(e){let{editor:t}=e,s=t.isEmpty&&!t.isFocused,n=t.getJSON();a((0,nP.DV)(n)),s&&t.commands.focus("end")}});return(0,d.useEffect)(()=>{p.current=n,y&&y.view.dispatch(y.state.tr.setMeta("placeholderUpdate",!0))},[y,n]),{editor:y}})({tipTapEditorState:i,setTipTapEditorState:o,onReady:x,placeholder:c,fetchInputAutocompletion:h,plainTextMode:k,mentionsEnabled:C,mentionProviders:N,onMentionStateChange:C?S.handleStateChange:void 0,onMentionSelect:C?e=>S.handleMentionSelect(e):void 0,extraEditorAttributes:{role:"textbox","data-testid":"chat-input","aria-label":w.formatMessage({defaultMessage:"Write your prompt to Claude",id:"Lxn7p6AQvE"}),"aria-multiline":"true","aria-required":"false","aria-invalid":"false"},extraExtensions:j});d.useEffect(()=>{C&&S.setEditor(_)},[_,C,S.setEditor]),d.useEffect(()=>{_&&C&&_.extensionManager.extensions.forEach(e=>{"mentionExtension"===e.name&&(e.options.providers=N)})},[_,C,N]);let[I,T]=(0,d.useState)(!1);(0,d.useImperativeHandle)(t,()=>({setContent(e){e!==l&&(null==_||_.commands.setContent(e,{emitUpdate:!1,parseOptions:{preserveWhitespace:"full"}}))},setEditable(e){_.setOptions({editable:e})},focus(){null==_||_.commands.focus()},getPosition:()=>null==_?void 0:_.state.selection.$anchor,getEditor:()=>_,getIsAtEnd(){if(!_)return;let e=_.state.selection.$anchor.pos;return nd.LN.atEnd(_.state.doc).$anchor.pos===e},scrollToEnd(){_&&requestAnimationFrame(()=>{requestAnimationFrame(()=>{_.commands.setTextSelection(_.state.doc.content.size),_.commands.scrollIntoView();let e=_.view.dom.parentElement;e&&(e.scrollTop=e.scrollHeight)})})}}),[_,l]);let R=(0,d.useCallback)(e=>{if(n&&"Enter"===e.key&&!e.shiftKey)return void e.preventDefault();if("Enter"!==e.key||!u||C&&S.mentionState.active)return;let t=null==_?void 0:_.storage["slash-command-suggestion"];(null==t||!t.isActive||null==t||!t.hasVisibleItems)&&(I||e.shiftKey||e.altKey||e.nativeEvent.isComposing||(0,G.Fr)()&&!e.metaKey&&!e.ctrlKey||(e.preventDefault(),u(e)))},[n,u,I,C,S.mentionState.active,null==_?void 0:_.storage]);return(0,s.jsxs)(nj.Provider,{value:{setOverrideSubmit:T},children:[(0,s.jsx)(nx.$Z,{className:(0,p.A)("max-h-96 w-full overflow-y-auto font-large break-words transition-opacity duration-200","bottom"===f?"min-h-[1.5rem]":"min-h-[3rem]",n&&"opacity-60",n&&"cursor-default",M,a),editor:_,onKeyDownCapture:R}),C&&S.mentionState.active&&S.mentionState.position&&(0,s.jsx)(no,{options:S.mentionState.options,onSelect:S.handleMentionSelect,onClose:S.handleDropdownClose,position:S.mentionState.position,selectedIndex:S.mentionState.selectedIndex})]})});nZ.displayName="PromptInput";var n0=a(0x26ee41f8),n1=a(0x2290f7c8d),n2=a(0x1ca509f4d),n5=a(0x1ebc739c1),n3=a(0x4fc21aed);let n4=(0,d.memo)(e=>{let{children:t,skillName:a,skillDescription:n,onOpenChange:l}=e,[i,r]=(0,d.useState)(!1),o=(0,d.useCallback)(e=>{r(e),null==l||l(e)},[l]);return(0,s.jsxs)(n0.y,{open:i,onOpenChange:o,children:[(0,s.jsx)(n1.W,{render:e=>(0,s.jsx)("span",{...e,className:"inline-flex relative cursor-pointer",children:t})}),i&&(0,s.jsx)(n2.i,{children:(0,s.jsx)(n5.U,{side:"top",sideOffset:8,align:"start",children:(0,s.jsxs)(n3.i,{className:(0,p.A)("rounded-2xl border-0.5 border-border-200","bg-bg-000 shadow-lg font-base","w-[203px] p-2","flex flex-col gap-2"),children:[(0,s.jsxs)("div",{className:"flex items-center justify-between px-1",children:[(0,s.jsxs)("div",{className:"text-text-100 font-small",children:[(0,s.jsx)("span",{className:"text-text-100/30",children:"/"})," ",a]}),(0,s.jsx)(ep.BookText,{size:16,className:"text-text-400"})]}),(0,s.jsx)("div",{className:(0,p.A)("text-text-500 font-small","bg-bg-100 rounded-xl","py-2 px-2.5"),children:(0,s.jsx)("p",{className:"line-clamp-5",children:n})})]})})})]})});function n8(e){let{node:t,selected:a}=e,{skillName:n,skillDescription:l}=t.attrs,[i,r]=(0,d.useState)(!1),[o,c]=(0,d.useState)(!1),u=(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:(0,p.A)("absolute -inset-y-0.5 -left-0.5 -right-1 rounded-md pointer-events-none",a&&"bg-accent-secondary-900",(i||o)&&!a&&"bg-accent-secondary-900/50")}),(0,s.jsxs)("span",{className:"relative pl-2",children:[(0,s.jsx)("span",{className:(0,p.A)("absolute top-1/2 -translate-y-1/2 left-0","w-2 h-5 flex items-center justify-center","font-base-bold select-none opacity-50"),children:"/"}),(0,s.jsx)("span",{className:"select-none",children:n})]})]});return(0,s.jsx)(nx.VR,{as:"span",className:(0,p.A)("inline-flex relative cursor-pointer",a?"text-accent-secondary-000":"text-accent-secondary-100"),contentEditable:!1,onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),children:(0,s.jsx)(n4,{skillName:n,skillDescription:l,onOpenChange:c,children:u})})}n4.displayName="SkillHoverCard";let n6=nc.bP.create({name:"skillChip",group:"inline",inline:!0,atom:!0,addAttributes:()=>({skillId:{default:null},skillName:{default:""},skillDescription:{default:""}}),parseHTML:()=>[{tag:"span[data-skill-chip]"}],renderHTML(e){let{HTMLAttributes:t}=e;return["span",(0,nc.KV)(t,{"data-skill-chip":""}),0]},renderText(e){let{node:t}=e;return"/".concat(t.attrs.skillName)},addNodeView:()=>(0,nx.gu)(n8),addKeyboardShortcuts(){return{Backspace:()=>{let{selection:e}=this.editor.state,{$from:t,empty:a}=e;if(!a)return!1;let s=t.nodeBefore;if(s&&s.type.name===this.name){let e=t.pos-s.nodeSize;return this.editor.chain().setNodeSelection(e).run(),!0}return!1}}}});var n9=a(0x229407f5a),n7=a(0x22062498b),le=a(0x84bd1d62);ep.BookText;let lt=(0,s.jsx)(ep.Projects,{}),la=(0,s.jsx)(ep.Connectors,{}),ls=(0,s.jsx)(ep.BookText,{}),ln=(0,s.jsx)(ep.Share,{});var ll=a(0x176ac88f);let li=(0,d.createContext)(void 0);function lr(e,t){let a=t+1;for(;a<e.length&&"separator"===e[a].type;)a++;return a<e.length?a:t}function lo(e,t){let a=t-1;for(;a>=0&&"separator"===e[a].type;)a--;return a>=0?a:t}function ld(e){let t=e.findIndex(e=>"separator"!==e.type);return t>=0?t:0}function lc(e){var t;return"button"===e.type||"skill"===e.type||"checkbox"===e.type&&(null==(t=e.closeOnClick)||t)}function lu(e){let{children:t,items:a,onClose:n,resetKey:l}=e,[i,r]=(0,d.useState)(0),[o,c]=(0,d.useState)(null),[u,m]=(0,d.useState)(-1),[x,p]=(0,d.useState)("keyboard"),[f,h]=(0,d.useState)(!1),g=(0,ll.Z)(l);return(0,d.useEffect)(()=>{l!==g&&r(ld(a))},[l,g,a]),(0,d.useEffect)(()=>{let e=a[i];if(e&&"submenu"===e.type){var t;let a=null!=(t=e.label)?t:"";if(o!==a){let e=setTimeout(()=>{c(a),m(-1)},150);return()=>clearTimeout(e)}}else c(null)},[i,a,o]),(0,d.useEffect)(()=>{let e=()=>{f||h(!0),"keyboard"===x&&p("mouse")};return document.addEventListener("mousemove",e),()=>document.removeEventListener("mousemove",e)},[f,x]),(0,d.useEffect)(()=>{let e=e=>{var t,s,l;"Escape"===e.key&&(e.preventDefault(),e.stopImmediatePropagation(),n()),["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Enter"].includes(e.key)&&(p("keyboard"),h(!1),e.preventDefault(),e.stopImmediatePropagation());let d=a[i],c=o&&u>=0,x=(null==d?void 0:d.type)==="submenu"?d.items:[];if("ArrowDown"===e.key)c?m(lr(x,u)):r(lr(a,i));else if("ArrowUp"===e.key)c?m(lo(x,u)):r(lo(a,i));else if("ArrowRight"===e.key)(null==d?void 0:d.type)==="submenu"&&o===(null!=(t=d.label)?t:"")&&m(ld(x));else if("ArrowLeft"===e.key)u>=0&&m(-1);else if("Enter"===e.key)if(c){let e=x[u];e&&"separator"!==e.type&&"submenu"!==e.type&&"search-input"!==e.type&&"loading"!==e.type&&(null==(s=e.onAction)||s.call(e),lc(e)&&n())}else{let e=a[i];e&&"separator"!==e.type&&"loading"!==e.type&&("submenu"===e.type?m(ld(e.items)):"search-input"!==e.type&&(null==(l=e.onAction)||l.call(e),lc(e)&&n()))}};return document.addEventListener("keydown",e,!0),()=>document.removeEventListener("keydown",e,!0)},[a,i,o,u,n]),(0,s.jsx)(li.Provider,{value:{items:a,onClose:n,setActiveItemById:e=>{let t=a.findIndex(t=>"label"in t&&t.label===e);t>=0&&r(t)},activeIndex:i,submenuOpen:o,submenuActiveIndex:u,setSubmenuOpen:c,setSubmenuActiveIndex:m,interactionMode:x,hasMouseMoved:f,setHasMouseMoved:h},children:t})}function lm(){let e=(0,d.useContext)(li);if(!e)throw Error("useSlashCommandMenu must be used within SlashCommandMenuProvider");return e}var lx=a(0x18c856b49),lp=a(0x698cb19f),lf=a(0x19b73ecad);function lh(e){let{reference:t,placement:a="top-start",horizontalOffset:n=-16,verticalOffset:l=10,usePortal:i=!1,onClickOutsideHandler:r,children:o,disableFlip:c=!1}=e,[u,m]=(0,d.useState)(void 0),x=(0,d.useMemo)(()=>({getBoundingClientRect:()=>"function"==typeof t?t():t||new DOMRect}),[t]),{refs:p,floatingStyles:f}=(0,lx.we)({placement:a,middleware:[(0,lp.cY)({mainAxis:l,crossAxis:n}),...c?[]:[(0,lp.UU)()],(0,lp.BN)({padding:8}),(0,lp.Ej)({apply(e){let{availableHeight:t}=e;m(t-16)},padding:8})],whileElementsMounted:lf.ll}),h=(0,aN.L)(()=>{r&&r()},["mousedown"]);(0,d.useLayoutEffect)(()=>{p.setReference(x)},[p,x]);let g=(0,s.jsx)("div",{ref:e=>{p.setFloating(e),h&&(h.current=e)},role:"menu",style:{...f,maxHeight:u?"".concat(u,"px"):void 0},className:"z-dropdown bg-bg-000 backdrop-blur-xl rounded-xl border-0.5 border-border-200 shadow-[0px_2px_8px_0px_hsl(var(--always-black)/8%)] dark:shadow-[0px_2px_8px_0px_hsl(var(--always-black)/24%)] p-1.5 w-60 max-h-96 overflow-y-auto",children:o});return i?(0,a1.createPortal)(g,document.body):g}function lg(){return(0,s.jsx)("div",{className:"h-[0.5px] bg-border-300 my-1.5 mx-2"})}function lb(e){let{items:t,activeIndex:a,isInSubmenu:n=!1}=e;return t&&0!==t.length?(0,s.jsx)("div",{className:"flex flex-col",children:t.map((e,t)=>{if("separator"===e.type)return(0,s.jsx)(lg,{},e.label);if("loading"===e.type)return null;let l="label"in e?e.label:"item-".concat(t);return(0,s.jsx)(lv,{item:e,index:t,isActive:t===a,isInSubmenu:n},l)})}):null}let lv=(0,d.memo)(function(e){var t,a;let{item:n,index:l,isActive:i,isInSubmenu:r=!1}=e,{onClose:o,submenuOpen:c,setActiveItemById:u,setSubmenuActiveIndex:m,submenuActiveIndex:x,interactionMode:f,hasMouseMoved:h,setHasMouseMoved:g}=lm(),b=(0,d.useRef)(null),v="search-input"!==n.type&&null!=(t=n.label)?t:"",y=("checkbox"===n.type||"toggle"===n.type)&&n.checked,j="checkbox"!==n.type&&"toggle"!==n.type||null==(a=n.closeOnClick)||a,w=h&&"mouse"===f,k=c===v&&x>=0;if((0,d.useEffect)(()=>{i&&"keyboard"===f&&b.current&&b.current.scrollIntoView({block:"nearest",inline:"nearest"})},[i,f]),"search-input"===n.type)return null;let C=()=>{var e;"submenu"!==n.type&&(null==(e=n.onAction)||e.call(n),("button"===n.type||"skill"===n.type||("checkbox"===n.type||"toggle"===n.type)&&j)&&o&&o())},M=()=>{("keyboard"!==f||h)&&(h||g(!0),r?m(l):u(v))},N=e=>{e.stopPropagation()};return"skill"===n.type?(0,s.jsxs)("div",{ref:b,role:"menuitem",tabIndex:-1,onMouseEnter:M,onMouseDown:N,className:(0,p.A)("group flex items-center gap-1 overflow-clip pl-2 pr-1.5 py-1.5 rounded-lg font-base cursor-pointer select-none",i&&"bg-bg-200",w&&"hover:bg-bg-200","text-text-300","active:bg-bg-300"),onClick:C,children:[(0,s.jsx)("span",{className:"text-text-100/30",children:"/"}),(0,s.jsx)("span",{className:"truncate",children:n.label})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{ref:b,role:"menuitem",tabIndex:-1,onMouseEnter:M,onMouseDown:N,className:(0,p.A)("group flex items-start gap-2 overflow-clip pl-2 pr-1.5 py-1.5 rounded-lg font-base cursor-pointer select-none",i&&y&&"bg-accent-secondary-100/10",i&&!y&&!k&&"bg-bg-200",i&&!y&&k&&"bg-bg-100",i&&!y&&w&&"hover:bg-bg-200",y?"text-accent-secondary-100":"text-text-300",w&&y&&"hover:bg-accent-secondary-100/10",w&&!y&&"hover:bg-bg-200",i&&y&&"active:bg-accent-secondary-100/20",i&&!y&&"active:bg-bg-300"),onClick:C,children:[(0,s.jsx)("div",{className:"size-5 flex items-center justify-center",children:n.icon}),(0,s.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,s.jsx)("span",{children:n.label}),n.subtitle&&(0,s.jsx)("span",{className:(0,p.A)("font-small",y?"text-accent-secondary-200/75":"text-text-500"),children:n.subtitle})]}),"button"===n.type&&n.suffix&&(0,s.jsx)("div",{className:"flex items-center h-5 text-text-500 font-small",children:n.suffix}),("checkbox"===n.type||"toggle"===n.type)&&!j&&(0,s.jsx)("div",{className:"flex items-center h-5",children:(0,s.jsx)(eQ.j,{readOnly:!0,size:"small",checked:y})}),"checkbox"===n.type&&j&&y&&(0,s.jsx)(ep.Check,{size:20,className:"text-accent-secondary-100"}),"submenu"===n.type&&(0,s.jsx)("div",{className:"h-5 flex items-center",children:(0,s.jsx)(ep.CaretRight,{size:14,className:"text-text-500"})})]}),"submenu"===n.type&&c===v&&(0,s.jsx)(lh,{reference:b.current?b.current.getBoundingClientRect():null,placement:"right-start",horizontalOffset:-8,verticalOffset:0,usePortal:!0,children:(0,s.jsx)(lb,{items:n.items,activeIndex:x,isInSubmenu:!0})})]})});function ly(e){let{clientRect:t}=e,{onClose:a,items:n,activeIndex:l}=lm();return(0,s.jsx)(lh,{reference:t,onClickOutsideHandler:a,disableFlip:!0,children:(0,s.jsx)(lb,{items:n,activeIndex:l})})}function lj(e){var t,a;let{editor:n,query:l}=e,[i,r]=(0,d.useState)(null),[o,c]=(0,d.useState)(!1),u=(0,d.useRef)(null);if((0,d.useLayoutEffect)(()=>{if(!n||!u.current)return void c(!1);let{from:e}=n.state.selection;if(e<n.state.doc.content.size-2){r(null),c(!1);return}let t=n.view.coordsAtPos(e);if(!t)return void c(!1);let a=t.left+2;r({top:t.top+(t.bottom-t.top)/2,left:a});let s=n.view.dom,l=null==s?void 0:s.parentElement;if(l){let e=l.getBoundingClientRect(),t=u.current.offsetWidth;c(e.right-a>=t+8)}else c(!1)},[n,l]),""!==l)return null;let m=i&&o;return(0,a1.createPortal)((0,s.jsx)("span",{ref:u,className:"absolute -translate-y-1/2 text-text-500/75 font-large pointer-events-none select-none z-50",style:{top:null!=(t=null==i?void 0:i.top)?t:0,left:null!=(a=null==i?void 0:i.left)?a:0,visibility:m?"visible":"hidden"},children:(0,s.jsx)(X.A,{defaultMessage:"Type to filter",id:"YHS8McfgFb"})}),document.body)}function lw(e,t){var a,s;if("separator"===e.type||"search-input"===e.type||"loading"===e.type)return!1;let n=(null!=(s=e.label)?s:"").toLowerCase().includes(t),l="subtitle"in e&&(null==(a=e.subtitle)?void 0:a.toLowerCase().includes(t));return n||!!l}function lk(e){let{placement:t,clientRect:a,editor:n,range:l,onClose:o,query:c}=e,u=(0,tH.st)(),x=(0,d.useRef)(!1),{items:p}=(e=>{let{placement:t}=e,a=(0,g.A)(),{conversation:n}=(0,V.lE)(),{addError:l}=(0,r.Yf)(),{account:o}=(0,i.YL)(),c=(0,n7.B)(o),u=nl(e=>e.setFilePath),x=(0,tT.K)(),p=tF(),f=tY(),h=t6(),{items:b}=tv({includeConnectedOnly:!0}),v=t0(),j=(0,m.fS)("slash_skill"),w=(()=>{let{data:e,isLoading:t}=(0,le.y$)();return(0,d.useMemo)(()=>{var a;if(t)return[{type:"loading"}];let s=(null!=(a=null==e?void 0:e.skills)?a:[]).filter(e=>e.enabled);return 0===s.length?[]:s.map(e=>({type:"skill",label:e.skillName,skillId:e.skillId,skillDescription:e.skillDescription}))},[e,t])})(),C=t3(t),M=tV(),N=(0,eo.mL)(),A=(0,eo.PF)(),S=(0,eo.lI)(),_=(0,el.Z3)((null==n?void 0:n.id)||null),{model:E=_}=(0,k.oM)(),I=(0,y.vP)("paprika_mode"),T=(0,ev.j)()(E),{toggleConversationSetting:R}=(0,y.rX)({source:"slashCommandMenu"});return{items:(0,d.useMemo)(()=>{if(N||A){let e=[C,...M?[M]:[]];b.length>0&&e.push({type:"submenu",label:a.formatMessage({defaultMessage:"Connectors",id:"2mMJRvsAg1"}),icon:la,items:b});let t=null===aB.Fd||void 0===aB.Fd?void 0:aB.Fd.shareSession;return c&&A&&S&&t&&e.push({type:"button",label:a.formatMessage({defaultMessage:"Export session",id:"etQYz8bNj6"}),subtitle:a.formatMessage({defaultMessage:"Export transcript to Downloads",id:"qXQ6zVPez8"}),icon:ln,onAction:async()=>{try{let e=await t(S);e.success&&e.filePath?u(e.filePath):l(e.error||"Failed to export session.",{errorContext:{tags:{source:"share_session"}},messageForLogging:"Failed to export session."})}catch(e){l("Failed to export session. You can try again.",{error:e instanceof Error?e:void 0,errorContext:{tags:{source:"share_session"}},messageForLogging:"Failed to export session."})}}}),e}let e=[C,...M?[M]:[]];x&&p.length>0&&e.push({type:"submenu",icon:lt,label:a.formatMessage({defaultMessage:"Add to project",id:"+mqxxzVczn"}),items:p}),e.push({type:"separator",label:"separator-1"}),f&&e.push(f),h&&e.push(h),T&&e.push({type:"checkbox",label:a.formatMessage({defaultMessage:"Extended thinking",id:"5j4WakKa2u"}),icon:(0,s.jsx)(ep.ExtendedThinking,{size:16}),checked:!!I,closeOnClick:!0,onAction:()=>{R("paprika_mode",I?null:"extended")}}),v&&e.push(v);let t=j&&w.length>0;return(b.length>0||t)&&e.push({type:"separator",label:"separator-2"}),b.length>0&&e.push({type:"submenu",label:a.formatMessage({defaultMessage:"Connectors",id:"2mMJRvsAg1"}),icon:la,items:b}),t&&e.push({type:"submenu",icon:ls,label:a.formatMessage({defaultMessage:"Skills",id:"EJSVsOA19u"}),items:w}),e},[N,A,S,c,u,x,p,a,f,h,I,T,R,v,j,w,b,C,M,l])}})({placement:t});(0,d.useEffect)(()=>{x.current||(x.current=!0,u.track({event_key:"claudeai.slash_command_menu.opened"}))},[u]);let f=(0,d.useMemo)(()=>{if(!c)return p.filter(e=>"submenu"!==e.type||e.items.length>0);let e=c.trim().toLowerCase();if(!e)return[];let t=[];return p.forEach(a=>{lw(a,e)&&t.push(a),"submenu"===a.type&&a.items.forEach(a=>{lw(a,e)&&t.push(a)})}),t},[p,c]),h=(0,d.useCallback)(e=>{if("separator"===e.type)return e;if("submenu"===e.type)return{...e,items:e.items.map(e=>h(e))};if("search-input"===e.type||"loading"===e.type)return e;let t=e.onAction;return{...e,onAction:()=>{var a,s;if(u.track({event_key:"claudeai.slash_command_menu.item_selected",item_label:null!=(a=e.label)?a:"",item_type:e.type}),null==t||t(),"skill"===e.type){n.chain().focus().deleteRange(l).insertContent({type:"skillChip",attrs:{skillId:e.skillId,skillName:e.label,skillDescription:e.skillDescription}}).run(),o();return}("button"===e.type||"checkbox"===e.type&&(null==(s=e.closeOnClick)||s))&&(n.chain().focus().deleteRange(l).run(),o())}}},[u,n,o,l]),b=(0,d.useMemo)(()=>f.map(e=>h(e)),[f,h]);(0,d.useEffect)(()=>{n&&n.view.dom.focus()},[n]);let v=b.length>0;return((0,d.useEffect)(()=>{let e=n.storage["slash-command-suggestion"];e&&(e.hasVisibleItems=v)},[n,v]),v)?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(lj,{editor:n,query:c||""}),(0,s.jsx)(lu,{items:b,onClose:o,resetKey:c,children:(0,s.jsx)(ly,{clientRect:a})})]}):null}lv.displayName="SlashCommandMenuItem";let lC=new nd.hs("slash-command-suggestion"),lM=nc.YY.create({name:"slash-command-suggestion",addOptions:()=>({placement:"onpage"}),addStorage:()=>({isActive:!1,justClosed:!1,hasVisibleItems:!1}),addProseMirrorPlugins(){let e,t;return[(0,n9.Ay)({editor:this.editor,pluginKey:lC,char:"/",allowSpaces:!0,...(e=this.options.placement,t=this.editor,{items:()=>[{}],command:()=>{},allow:e=>{let{state:a,range:s}=e,n=t.storage["slash-command-suggestion"];if(null==n?void 0:n.justClosed)return!1;let l=a.doc.textBetween(s.from,s.to,"");return!(l.startsWith("/")?l.slice(1):l).startsWith(" ")},render:()=>{let a=null,s=null,n=t=>({placement:e,clientRect:t.clientRect,editor:t.editor,range:t.range,query:t.query,onClose:()=>(0,n9.Pn)(t.editor.view,lC)});return{onStart:e=>{e.editor.storage["slash-command-suggestion"].isActive=!0,a=(s=new nx.NV(lk,{props:n(e),editor:e.editor})).element,document.body.appendChild(a)},onUpdate:e=>{null==s||s.updateProps(n(e))},onKeyDown:e=>{let{event:a,view:s}=e;if("Escape"===a.key)return(0,n9.Pn)(s,lC),!0;let n=t.storage["slash-command-suggestion"];return!!(null==n?void 0:n.hasVisibleItems)&&("Enter"!==a.key||!a.shiftKey)&&("Enter"===a.key||"ArrowUp"===a.key||"ArrowDown"===a.key)},onExit:e=>{let t=e.editor.storage["slash-command-suggestion"];t.isActive=!1,t.justClosed=!0,setTimeout(()=>{t.justClosed=!1},100),s&&(s.destroy(),s=null),(null==a?void 0:a.parentNode)&&(a.parentNode.removeChild(a),a=null)}}}})})]}});var lN=a(0x120e6a4a3);let lA=(0,d.forwardRef)((e,t)=>{var a;let{promptInputSsrEnabled:n,isTipTapReady:l,promptInputSsrTextareaRef:c,onSubmit:u,onReady:x,placement:p,placeholder:f,fetchInputAutocompletion:h,className:b,disabled:v}=e,{prompt:y,tipTapEditorState:j}=(0,V.QT)(),{setTipTapEditorState:w,setFiles:k}=(0,V.Jy)((0,ny.k)(e=>({setTipTapEditorState:e.setTipTapEditorJSON,setFiles:e.setFiles}))),{handleMentionAttachments:C,handleMentionDeleted:M}=function(e){let{setFiles:t,createMessageFileFromBase64:a}=e,s=(0,g.A)(),{activeOrganization:n}=(0,i.YL)(),l=(0,a4.mn)(),{addError:c}=(0,r.Yf)(),u=(0,d.useRef)(new Map);return{handleMentionAttachments:(0,d.useCallback)(async(e,i)=>{let r=[];for(let e of i)if(e.extracted_content)try{var d;let t=await a(e.extracted_content,e.file_type,null!=(d=null==n?void 0:n.uuid)?d:"",l,e.file_name);r.push(...t)}catch(e){o.v.error(o.u.DESKTOP_API,"Failed to upload mention attachment",{error:e}),c(s.formatMessage({defaultMessage:"Failed to upload attachment. You can try again.",id:"lG4VIx4FDG"}),{error:e,messageForLogging:"Failed to upload attachment. You can try again."})}let m=r.map(e=>e.file_uuid);u.current.set(e,m),t(e=>{let t=new Set(e.map(e=>e.file_uuid));return[...e,...r.filter(e=>!t.has(e.file_uuid))]})},[t,n,l,a,c,s]),handleMentionDeleted:(0,d.useCallback)(e=>{let a=u.current.get(e);a&&(t(e=>e.filter(e=>!a.includes(e.file_uuid))),u.current.delete(e))},[t])}}({setFiles:k,createMessageFileFromBase64:lN.bl}),N=(0,m.fS)("claudeai-slash"),A=(0,d.useMemo)(()=>N?[lM.configure({placement:p}),n6]:[],[p,N]),S=n&&!l&&(null==(a=c.current)?void 0:a.value)?{type:"doc",content:[{type:"paragraph",content:[{type:"text",text:c.current.value}]}]}:j;return(0,s.jsx)(nZ,{ref:t,prompt:y,tipTapEditorState:S,setTipTapEditorState:w,onSubmit:u,onReady:x,placement:p,placeholder:f,fetchInputAutocompletion:h,className:b,onMentionAttachments:C,onMentionDeleted:M,extraExtensions:A,disabled:v})});lA.displayName="PromptInputWithState";let lS=(0,d.memo)(e=>{let{placeholders:t,isVisible:a}=e,[n,l]=(0,d.useState)(0),[i,r]=(0,d.useState)(!1),[o,c]=(0,d.useState)(!1);return((0,d.useEffect)(()=>{if(!a||t.length<=1||o)return;let e=setInterval(()=>{r(!0),l(e=>{let a=(e+1)%t.length;return 0===a&&c(!0),a})},5e3);return()=>clearInterval(e)},[a,t.length,o]),(0,d.useEffect)(()=>{a&&(l(0),r(!1),c(!1))},[a]),a)?(0,s.jsx)("div",{className:"absolute inset-0 pointer-events-none overflow-hidden pl-1.5 pt-[5px]",children:(0,s.jsx)(f.N,{mode:"wait",initial:!1,children:(0,s.jsx)(h.P.span,{initial:!!i&&{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.5,ease:"linear"},className:"block text-text-500",children:t[n]},n)})}):null});lS.displayName="RotatingPlaceholder";let l_=(0,d.forwardRef)((e,t)=>{let{disabled:a,placement:C,placeholder:_,onSubmit:E,onReady:R,onRetry:D,enableScreenDrop:P=!1,disableDropZone:F=!1,isRunningToolOrThinking:O=!1}=e,Y=(0,V.QN)(),G=M(),B=(0,V.N3)(),{previewPrompt:K,setPrompt:eu,setAttachments:em,setFiles:ex,attachments:ep,files:ef,syncSourceUuids:eh,setSyncSourceUuids:eg}=(0,V.Jy)(e=>({previewPrompt:e.previewPrompt,setPrompt:e.setPrompt,setAttachments:e.setAttachments,setFiles:e.setFiles,attachments:e.attachments,files:e.files,syncSourceUuids:e.syncSourceUuids,setSyncSourceUuids:e.setSyncSourceUuids})),{isUploadingDriveSync:eb,isUploadingGithubSync:ev,sendMessage:ey,conversation:ej,isChatSyncing:ew,isProjectSyncing:ek,isSending:eC,focusInput:eM,promptInputRef:eN,willRedirectOnSubmit:eA,hasBlockingWarning:eS,isUploadingFile:e_,validateMaxUploadLimit:eE,onPasteFiles:eI,uploadInputProps:eT,hasAttachments:eR,isNewConversation:eD,isImprovingPrompt:eP,currentCompassTask:eF}=(0,k.oM)(),{incognitoModeEnabled:eL}=(0,T.S)(),{toggleConversationSetting:ez}=(0,y.rX)({source:"extendedThinkingKeyBinding"}),eO=(0,y.vP)("paprika_mode");!function(e){let{matchShortcut:t}=(0,er.wk)("extended_thinking");(0,er.Kh)("extended_thinking",e),(0,d.useEffect)(()=>{if(!e)return;let a=a=>{if(t(a))return a.preventDefault(),a.stopPropagation(),e(),!1};return document.addEventListener("keydown",a,!0),()=>document.removeEventListener("keydown",a,!0)},[t,e])}((0,d.useCallback)(()=>{ez("paprika_mode",eO?null:"extended")},[ez,eO])),(0,d.useImperativeHandle)(t,()=>({setContent:(e,t,a)=>{eu(e,{forceUpdateTiptap:!0}),em("function"==typeof t?t(ep):t),ex("function"==typeof a?a(ef):a)},sendMessage:ey,setAttachments:e=>{em("function"==typeof e?e(ep):e)},getAttachments:()=>ep})),(()=>{let{setPrompt:e,setAttachments:t,setFiles:a}=(0,V.Tc)(e=>({setPrompt:e.setPrompt,setAttachments:e.setAttachments,setFiles:e.setFiles}),"useSavePromptOnFail"),{failedStreamRetryData:s,setFailedStreamRetryData:n}=(0,el.x)();(0,d.useEffect)(()=>{null!==s&&(e(s.prompt),t(s.attachments),a(s.files),n(null))},[s,t,n,a,e])})();let{fetchInputAutocompletion:eU}=(0,v.$z)(null==ej?void 0:ej.id),{handleDriveDocUrlPaste:eY,parseDriveUrl:eG}=(()=>{let e=(0,V.BN)(),{setSyncSourceUuids:t}=(0,V.Jy)(e=>({setSyncSourceUuids:e.setSyncSourceUuids})),{isAtMaxNumUploads:a,setIsUploadingDriveSync:n}=(0,k.oM)(),l=(0,Z.LP)(),{addError:o}=(0,r.Yf)(),c=(0,g.A)(),{activeOrganization:u}=(0,i.YL)(),m=null==u?void 0:u.uuid,x=(0,en.Uz)({type:"remote"}),p=(0,et.kO)(),f=(0,Q.p9)(),h=null==x?void 0:x.find(e=>e.url&&et.TI[e.url]===J.v8.GDRIVE),v=!h&&p,{mutate:y}=(0,b.EF)({onMutate:()=>{n(!0)},onSuccess:e=>{t(t=>[...t,e.uuid]),n(!1)},onError:e=>{n(!1),o((0,es.J)(e),{error:e,errorContext:{tags:{source:"drive_url_paste_sync_create"}}})},meta:{noToast:!0}}),{mutateAsync:j}=(0,ee.Ax)(),{isDriveAuthenticated:w,initDriveAuth:C}=(0,Z.cI)({callerIdentifier:"chat-input",handleAuthSuccess:()=>{let t=e.getState().getPrompt().match(/(https?:\/\/[^\s]+)/gi)||[],a=h?ea.V7:ea.$g;for(let e of t){let t=a(e);t&&M(t,e,!0)}}}),M=(0,d.useCallback)(async function(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!v&&(l||i)){if(h&&h.isConnecting)return void o(c.formatMessage({defaultMessage:"Google Drive is still connecting. Please wait a moment and try again.",id:"TjIapq8P8R"}),{errorContext:{tags:{source:"drive_connector_connecting"}},messageForLogging:"Google Drive is still connecting. Please wait a moment and try again."});if(!w&&!i)return void o((0,s.jsx)("span",{children:(0,s.jsx)(X.A,{defaultMessage:"<button>Authenticate</button> to paste link as attachment",id:"85AH1hyv0s",values:{button:e=>(0,s.jsx)("button",{className:"underline",onClick:C,children:e})}})}));if(a)return void o(c.formatMessage({defaultMessage:"You can add at most {maxUploads, plural, one {# attachment} other {# attachments}} to a message.",id:"wvnM4s8976"},{maxUploads:$.XA.maxTotalUploadsPerMessage}),{messageForLogging:"You can add at most {maxUploads, plural, one {# attachment} other {# attachments}} to a message."});if(h){let e=h.resources.find(e=>e.uri===t);if(e)return void y({sync_source_type:J.v8.MCP_RESOURCES,sync_source_config:{server_uuid:h.uuid,resource:{...e}}});if(f&&!(0,en.HG)(h.uuid,f)&&m){n(!0);try{let e=await j({resource_uri:t,server_uuid:h.uuid});if(e){let t=e.resource;y({sync_source_type:J.v8.MCP_RESOURCES,sync_source_config:{server_uuid:h.uuid,resource:{...t}}})}n(!1)}catch(e){n(!1),o("Failed to fetch. You can try again.",{error:e,errorContext:{tags:{action:"get_resource_for_drive_doc_paste"}}})}}else try{n(!0);let e=(0,en.KU)(h.uuid),a=await e.readResource({uri:t});if(a.contents.length>0){var r;let e={...a.contents[0]};y({sync_source_type:J.v8.MCP_RESOURCES,sync_source_config:{server_uuid:h.uuid,resource:{...e,name:null!=(r=e.name)?r:"Unknown Title"}}})}n(!1)}catch(e){n(!1),o("Failed to fetch. You can try again.",{error:e,errorContext:{tags:{action:"get_resource_for_drive_doc_paste"}}})}}else y({sync_source_type:J.v8.GDRIVE,sync_source_config:{uri:e}})}},[v,l,w,a,h,f,m,j,o,C,c,y,n]);return{handleDriveDocUrlPaste:M,parseDriveUrl:h?ea.V7:ea.$g}})(),eH=function(e,t,a,s,n,l,i){let[r,o]=(0,d.useState)(!1);return(0,d.useEffect)(()=>{let e=e=>{"Shift"===e.key&&o(!0)},t=e=>{"Shift"===e.key&&o(!1)};return window.addEventListener("keydown",e),window.addEventListener("keyup",t),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",t)}},[]),(0,d.useCallback)(o=>{var d,c,u,m;let x=(null==(c=o.clipboardData)||null==(d=c.files)?void 0:d.length)>0,p=null==(u=o.clipboardData)?void 0:u.getData("text/plain"),f=null==p?void 0:p.length;if(f&&!x){let e=n(p);e&&s(e,p)}let h=x&&Array.from(o.clipboardData.files).some(e=>e.type.startsWith("image/"));if(o.clipboardData.types.includes("text/plain")&&o.clipboardData.types.includes("text/html")&&h){let e=o.clipboardData.getData("text/html");if(e.includes("urn:schemas-microsoft-com:office:")||e.includes("content=Word.Document")||e.includes("content=PowerPoint.Slide")||e.includes("content=Excel.Sheet")||e.includes(' class="Mso')){let e=o.clipboardData.getData("text/plain");if(e){o.preventDefault();let t=null==i||null==(m=i.current)?void 0:m.getEditor();t&&t.commands.insertContent(e);return}}}if(x){t({newUploads:Array.from(o.clipboardData.files)})&&a(o.clipboardData.files),o.preventDefault();return}if(!t({numNewPotentialAttachments:1,showError:!1}))return;let g=new Blob([p]).size;l||!f||g<4096||r||(o.preventDefault(),e(e=>[...e,{file_name:"",file_size:g,file_type:"txt",extracted_content:p}]))},[t,e,a,s,n,r,l,i])}(em,eE,eI,eY,eG,(0,e8.lS)(),eN),eq=(0,d.useCallback)(e=>{var t,a;(null==eN||null==(a=eN.current)||null==(t=a.getEditor())?void 0:t.isFocused)&&eH(e)},[eH,eN]),eB=(0,W.U)(Y),eK=(0,x.q)(),eV=(0,ed.Zx)(null==ej?void 0:ej.id),eW=(0,eo.PF)(),e$=eV||eW,eJ=!!(ej&&ej.isSampling&&!e$),eX=a||eC||B&&0===ep.length&&0===ef.length&&0===eh.length||e_||eb||ev||ew||ek||eS||eB||eJ||!!eF,eQ=(0,d.useCallback)(async()=>{!eX&&(await ey(),E&&E())},[eX,E,ey]),eZ=(0,d.useCallback)(e=>{let t=e.target;"BUTTON"===t.tagName||t.closest("button")||t.closest("[role]")||t.closest("a")||t.closest("input")||t.closest("select")||t.closest("textarea")||eM()},[eM]),e0=(0,d.useRef)(null),[e1]=(0,c.d)(),e2=(null==ej?void 0:ej.id)||e1,e5=(0,u.u9)(),{deleteFile:e3,deletingFileUuid:e4}=function(e){let{conversationUuid:t,wiggleEnabled:a}=e,{activeOrganization:s}=(0,i.YL)(),{addError:n}=(0,r.Yf)(),[c,u]=(0,d.useState)(null),m=(0,d.useRef)(!1);return{deleteFile:(0,d.useCallback)(async e=>{if(!a)return!1;if(!t||!(null==s?void 0:s.uuid))return o.v.error(o.u.CHAT_COMPLETION,"wiggle_file_delete_skipped_missing_conversation",{fileUuid:e,conversationUuid:t,orgUuid:null==s?void 0:s.uuid}),!1;if(m.current)return!1;m.current=!0,u(e);try{return await (0,l.lm)(e,{orgUuid:s.uuid,conversationUuid:t,wiggleEnabled:!0}),!0}catch(t){return o.v.error(o.u.CHAT_COMPLETION,"wiggle_file_delete_failed",{error:t,fileUuid:e}),n("File couldn't be deleted. You can try again.",{error:t,errorContext:{tags:{source:"file_delete"}}}),!1}finally{m.current=!1,u(null)}},[t,a,null==s?void 0:s.uuid,n]),deletingFileUuid:c}}({conversationUuid:e2,wiggleEnabled:null!=e5&&e5}),e6=(0,b.NY)(eh).map((e,t)=>{let{data:a}=e;return{syncSource:a,uuid:eh[t]}}),e9=(0,s.jsx)(f.N,{initial:!1,children:eR&&(0,s.jsx)(h.P.div,{className:(0,p.A)("overflow-hidden",!G&&"rounded-b-2xl"),initial:{height:0},animate:{height:"auto"},exit:{height:0},children:(0,s.jsx)("div",{className:(0,p.A)("p-3.5 overflow-x-auto",G?"pb-2.5":"rounded-b-2xl border-t-0.5 border-border-300/25 bg-bg-100"),children:(0,s.jsx)(w.B,{isUploadingFile:e_,isUploadingSync:eb||ev,attachments:ep,files:ef,syncSourceResults:e6,deletingFileUuid:null!=e4?e4:void 0,onRemoveAttachment:e=>{em(t=>t.filter((t,a)=>a!==e))},onRemoveFile:async e=>{let t=ef[e];t&&(ex(t=>t.filter((t,a)=>a!==e)),await e3(t.file_uuid))},onRemoveSyncSource:e=>{eg(t=>t.filter(t=>t!==e))}})})},"attachments")}),e7=(0,ei.h)(null==ej?void 0:ej.id,null==ej?void 0:ej.model),te=(0,n.WZ)(null==ej?void 0:ej.id),tt=(0,m.fS)("hey_hello_hi");(0,m.fS)("yukon_gold_nudge");let ta=(0,m.fS)("chat-ui-core"),{data:ts,clearAll:tn,focusBanner:tl}=(0,ec.u5)(),ti=(0,g.A)();(0,d.useEffect)(()=>{eC&&tn()},[eC,tn]);let tr=H({placeholder:_,isNewConversation:eD,isAgentMode:eV}),to=ts?ti.formatMessage({defaultMessage:"Something else...",id:"oFcUsddNXs"}):tr,td=function(){let e=(0,g.A)();return[e.formatMessage({defaultMessage:"How can I help you today?",id:"XLcM6WHfQR"}),e.formatMessage({defaultMessage:"Type / for commands",id:"fHClqd2+bS"})]}(),{isTipTapReady:tc,promptInputSsrEnabled:tu,promptInputSsrTextareaRef:tm,handleTipTapReady:tx,handleKeyDownCapture:tp}=L(),tf=(0,d.useCallback)(e=>{let t=e.target.closest("[data-ask-user-input-banner]");if(ts&&"ArrowUp"===e.key&&!t){e.preventDefault(),tl();return}null==tp||tp(e)},[ts,tl,tp]),th=!tu&&!eK,tg=!tu||eK;if(th)return(0,s.jsx)(q,{placement:C,textareaRef:tm,placeholder:to});if(tt&&ej&&e7&&"refusal"===e7.stopReason&&e7.fallback&&e7.lastMessage&&ej.id&&ej.model)return(0,s.jsx)(j.sF,{model:ej.model,conversationUuid:ej.id,lastMessage:e7.lastMessage,fallback:e7.fallback,onRetryWithFallback:async()=>{if(!e7.lastMessage.parent_message_uuid)return;let{model:e}=await te.mutateAsync();null==D||D(e7.lastMessage.parent_message_uuid,e)}});let tb=K&&B,tv=G&&eD&&B&&!tb&&!eC;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(U,{onKeyDownCapture:tf,children:[tu&&(0,s.jsx)(z,{children:(0,s.jsx)(q,{placement:C,textareaRef:tm,hidden:eK,isTipTapReady:tc,placeholder:to})}),tg&&(0,s.jsx)(z,{children:(0,s.jsxs)(S,{onPasteCapture:eq,children:[(0,s.jsx)("input",{ref:e0,id:(0,t2.h)(C),"data-testid":"file-upload","aria-hidden":"true",tabIndex:-1,className:"absolute -z-10 h-0 w-0 overflow-hidden opacity-0 select-none",...eT}),"bottom"===C&&(0,s.jsxs)("div",{className:"px-3 md:px-2",children:[(0,s.jsx)(j.Qg,{placement:C,onRetry:(e,t)=>null==D?void 0:D(e,t),isRunningToolOrThinking:O,askUserInputData:ts}),""]}),(0,s.jsxs)(A,{onClick:eZ,disabled:a,className:(0,p.A)("border border-transparent",eA&&eC&&"animated-loading-background",eP?"transition-all duration-500 ring-1 ring-border-300/50 dark:ring-border-300/50":"",eL?"border-dashed bg-clip-padding !border-border-200 shadow-[0_0.25rem_1.25rem_hsl(var(--always-black)/3.5%)] focus-within:shadow-[0_0.25rem_1.25rem_hsl(var(--always-black)/7.5%)]":"shadow-[0_0.25rem_1.25rem_hsl(var(--always-black)/3.5%),0_0_0_0.5px_hsla(var(--border-300)/0.15)] hover:shadow-[0_0.25rem_1.25rem_hsl(var(--always-black)/3.5%),0_0_0_0.5px_hsla(var(--border-200)/0.3)] focus-within:shadow-[0_0.25rem_1.25rem_hsl(var(--always-black)/7.5%),0_0_0_0.5px_hsla(var(--border-200)/0.3)] hover:focus-within:shadow-[0_0.25rem_1.25rem_hsl(var(--always-black)/7.5%),0_0_0_0.5px_hsla(var(--border-200)/0.3)]"),children:[G&&e9,(0,s.jsxs)(I,{children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(lA,{ref:eN,onSubmit:eQ,onReady:e=>{tx(e.editor),null==R||R()},placement:C,placeholder:to,fetchInputAutocompletion:eU,className:(0,p.A)(tb&&"!opacity-0",tv&&"[&_.is-editor-empty]:before:!content-['']"),promptInputSsrEnabled:tu,isTipTapReady:tc,promptInputSsrTextareaRef:tm,disabled:a}),(0,s.jsx)(f.N,{children:tb?(0,s.jsx)(h.P.p,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"self-start absolute pointer-events-none inset-0 text-text-500 line-clamp-2",children:K}):eP&&!B?(0,s.jsx)(h.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 pointer-events-none overflow-hidden rounded",children:(0,s.jsx)(h.P.div,{className:"absolute inset-0 bg-gradient-to-r from-transparent via-always-white/20 dark:via-always-white/10 to-transparent",animate:{x:["-100%","100%"]},transition:{duration:1.5,ease:"easeInOut",repeat:1/0}})}):null}),tv&&(0,s.jsx)(lS,{placeholders:td,isVisible:tv})]}),(0,s.jsx)(aX,{placement:C,isDisabled:eX,disabled:a,skipInitialAnimation:tu&&!tc})]}),(0,s.jsx)(a2,{disabled:F,enableScreenDrop:P}),!G&&e9]}),"bottom"!==C&&(0,s.jsxs)("div",{className:"px-3 md:px-2",children:[(0,s.jsx)(j.Qg,{placement:C,onRetry:(e,t)=>null==D?void 0:D(e,t),isRunningToolOrThinking:O,askUserInputData:ts}),""]}),"bottom"===C&&!ta&&(0,s.jsx)(N,{})]})})]}),(0,s.jsx)(nr,{})]})});l_.displayName="ChatInputContent";let lE=(0,d.forwardRef)((e,t)=>{let{disabled:a,placement:n,placeholder:l,onSubmit:i,onReady:r,onRetry:o,enableScreenDrop:d=!1,disableDropZone:c=!1,sessionMcpServers:u,isRunningToolOrThinking:m=!1}=e;return(0,s.jsx)(e7.Xx,{placement:n,sessionMcpServers:u,children:(0,s.jsx)(l_,{ref:t,disabled:a,placement:n,placeholder:l,onSubmit:i,onReady:r,onRetry:o,enableScreenDrop:d,disableDropZone:c,isRunningToolOrThinking:m})})});lE.displayName="ChatInput"},0x72d3ed73:(e,t,a)=>{a.d(t,{$:()=>r});var s=a(0x22102fd88),n=a(0x1eb005d6b),l=a(0xb3d66042),i=a(0x1a1f6dda6);let r=e=>{let{children:t,className:a,collisionPadding:r=10,collisionBoundary:o="clipping-ancestors",...d}=e,c="string"==typeof a&&a.includes("max-h-");return(0,s.jsx)(n.g,{children:(0,s.jsx)(l.y,{className:(0,i.A)("z-dropdown rounded-xl border-0.5 border-border-200 p-1.5 min-w-[12rem] max-w-[320px]","bg-bg-000 backdrop-blur-xl shadow-[0px_2px_8px_0px_hsl(var(--always-black)/8%)] dark:shadow-[0px_2px_8px_0px_hsl(var(--always-black)/24%)]","overflow-y-auto",!c&&"max-h-[var(--available-height)]",a),collisionPadding:r,collisionBoundary:o,...d,children:t})})}},0x8ca4d894:(e,t,a)=>{a.d(t,{B:()=>v});var s=a(0x22102fd88),n=a(0x628a9a0b),l=a(0x14de19ae8),i=a(0x246846ae8),r=a(0x225bae024),o=a(0x183548b63),d=a(0x22fc8d729),c=a(0x24fcf6beb),u=a(0xac309a83),m=a(0x17f3a2521),x=a(0xfc89b4a4),p=a(0x1ab0d1ca1),f=a(0x38e6572),h=a(0xb6b8b1fb),g=a(0x122519e51);function b(e){let{value:t,children:a,disabled:n}=e;return(0,s.jsx)(i.eb,{disabled:n,value:t,children:a})}function v(e){var t,a,v,y,j,w;let{conversationUuid:k,message:C,requestedFeedbackType:M,setRequestedFeedbackType:N,isOpen:A,onClose:S,onSuccess:_,showOptions:E=!0}=e,I=(0,p.A)(),[T,R]=(0,x.useState)(""),{data:D}=(0,n.Bq)(k),P=null==D?void 0:D.chat_messages.some(e=>(0,c.Xz)(e).length>0),F=(0,g.V)(null!=(v=null==D?void 0:D.chat_messages)?v:[]).length>0,{mutate:L}=(0,n.HA)(k,C,!!P,{onSuccess:_}),z=(0,x.useId)(),O=null!=(y=null==(t=C.content)?void 0:t.some(e=>"thinking"===e.type))&&y,U="raven"===(0,l.$b)(),Y=(0,h.SK)(),G=(0,u.fS)("claude_ai_report_content_option"),H=null;return(null==D||null==(a=D.settings)?void 0:a.enabled_web_search)&&(H=null!=(w=null==(j=C.content)?void 0:j.some(e=>"tool_use"===e.type&&"web_search"===e.name))&&w?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(b,{value:m.kj.FLAG_WEB_OVER,children:(0,s.jsx)(f.A,{defaultMessage:"Shouldnâ€™t have searched the web",id:"T+mr27AakV"})}),(0,s.jsx)(b,{value:m.kj.FLAG_WEB_SOURCES,children:(0,s.jsx)(f.A,{defaultMessage:"Donâ€™t like the cited sources",id:"MBNotx/VaO"})}),(0,s.jsx)(b,{value:m.kj.FLAG_WEB_URL,children:(0,s.jsx)(f.A,{defaultMessage:"Report a URL",id:"BMYqsjhycd"})})]}):(0,s.jsx)(b,{value:m.kj.FLAG_WEB_UNDER,children:(0,s.jsx)(f.A,{defaultMessage:"Should have searched the web",id:"CS8kdzupd9"})})),(0,s.jsxs)(o.aF,{isOpen:A,title:I.formatMessage({defaultMessage:"Feedback",id:"Ejhdi47Jk5"}),onClose:S,children:[(0,s.jsx)("div",{className:"mt-4 flex flex-col",children:(null==M?void 0:M.includes("flag"))&&E&&(0,s.jsxs)(i.l6,{className:"my-2 max-w-md",label:I.formatMessage({defaultMessage:"What type of issue do you wish to report? (optional)",id:"IFWIi9rs1t"}),value:M,onValueChange:e=>{N(e||m.kj.FLAG)},children:[(0,s.jsx)(b,{value:m.kj.FLAG,disabled:!0,children:(0,s.jsx)(f.A,{defaultMessage:"Selectâ€¦",id:"q0+99kUbd6"})}),(0,s.jsx)(b,{value:m.kj.FLAG_BUG,children:(0,s.jsx)(f.A,{defaultMessage:"UI bug",id:"0uIYueAyDB"})}),(0,s.jsx)(b,{value:m.kj.FLAG_REFUSAL,children:(0,s.jsx)(f.A,{defaultMessage:"Overactive refusal",id:"Jl0Mn6yDBI"})}),F&&(0,s.jsx)(b,{value:m.kj.FLAG_FILE,children:(0,s.jsx)(f.A,{defaultMessage:"Poor image understanding",id:"227KYxHrx5"})}),(0,s.jsx)(b,{value:m.kj.FLAG_INSTRUCTIONS,children:(0,s.jsx)(f.A,{defaultMessage:"Did not fully follow my request",id:"2uOw8LgMwG"})}),(0,s.jsx)(b,{value:m.kj.FLAG_FACTS,children:(0,s.jsx)(f.A,{defaultMessage:"Not factually correct",id:"topE9Q6MGe"})}),(0,s.jsx)(b,{value:m.kj.FLAG_INCOMPLETE,children:(0,s.jsx)(f.A,{defaultMessage:"Incomplete response",id:"ZNEcy7OM5r"})}),O&&(0,s.jsx)(b,{value:m.kj.FLAG_THOUGHTS,children:(0,s.jsx)(f.A,{defaultMessage:"Issue with thought process",id:"zOab+24EWo"})}),H,Y&&(0,s.jsx)(b,{value:m.kj.FLAG_MEMORY,children:(0,s.jsx)(f.A,{defaultMessage:"Memory not applied correctly",id:"lNOB6Omh4y"})}),G&&(0,s.jsx)(b,{value:m.kj.FLAG_CONTENT,children:(0,s.jsx)(f.A,{defaultMessage:"Report content",id:"vfibES+z8T"})}),(0,s.jsx)(b,{value:m.kj.FLAG_OTHER,children:(0,s.jsx)(f.A,{defaultMessage:"Other",id:"/VnDMl81rh"})})]})}),M===m.kj.FLAG_WEB_URL||M===m.kj.FLAG_CONTENT?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"text-text-300 border-0.5 border-border-300 rounded-lg p-12 text-sm",children:(0,s.jsx)(f.A,{defaultMessage:"Please use this <link>form</link> to report violative content.",id:"QSjqvNNsUq",values:{link:e=>(0,s.jsx)(d.Y,{href:"https://docs.google.com/forms/d/e/1FAIpQLSeO9Hzkyf_hQ2fYkfP_cqAcJG5kdlkg1wF4drQEFK9Z6db7jg/viewform",target:"_blank",children:e})}})}),(0,s.jsx)(o.vW,{children:(0,s.jsx)(r.$,{variant:"secondary",onClick:S,children:(0,s.jsx)(f.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})})})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"mt-4 flex flex-col",children:[(0,s.jsx)("label",{htmlFor:z,className:"text-text-400 mb-2 text-sm",children:(0,s.jsx)(f.A,{defaultMessage:"Please provide details: (optional)",id:"og1W/bIZdx"})}),(0,s.jsx)(i.fs,{id:z,className:"text-sm",placeholder:(null==M?void 0:M.includes("flag"))||(null==M?void 0:M.includes("sc"))?I.formatMessage({defaultMessage:"What was unsatisfying about this response?",id:"+DB/t6WTki"}):I.formatMessage({defaultMessage:"What was satisfying about this response?",id:"yJFWG3mK1I"}),value:T,onChange:e=>{R(e.target.value)}})]}),(0,s.jsx)("p",{className:"text-text-500 mt-3 italic leading-tight",children:(0,s.jsx)("small",{children:(0,s.jsx)(f.A,{defaultMessage:"Submitting this report will send the entire current conversation to Anthropic for future improvements to our models. <link>Learn More</link>",id:"laRJ009b4f",values:{link:e=>(0,s.jsx)(d.Y,{target:"_blank",rel:"noopener",href:U?"https://privacy.anthropic.com/en/articles/9957937-how-does-anthropic-use-submitted-feedback":"https://privacy.anthropic.com/en/articles/10023565-how-does-anthropic-use-submitted-feedback",children:e})}})})}),(0,s.jsxs)(o.vW,{children:[(0,s.jsx)(r.$,{onClick:()=>{M&&(L({type:M,reason:T||void 0}),S())},children:(0,s.jsx)(f.A,{defaultMessage:"Submit",id:"wSZR47Y5kj"})}),(0,s.jsx)(r.$,{variant:"secondary",onClick:S,children:(0,s.jsx)(f.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})})]})]})]})}},0xde6c3752:(e,t,a)=>{a.d(t,{B:()=>r});var s=a(0x22102fd88),n=a(0x108536636),l=a(0x16b1d0c0f),i=a(0x1f59f8010);let r=e=>{let{attachments:t,files:a,syncSourceResults:r,onRemoveAttachment:o,onRemoveFile:d,onRemoveSyncSource:c,isUploadingFile:u,isUploadingSync:m,deletingFileUuid:x}=e,p=(0,l.f)(e=>e.isLoadingMentionData);return(0,s.jsxs)("div",{className:"flex flex-row gap-3",children:[t.map((e,t)=>(0,s.jsx)(n.NM,{file:e,handleRemove:()=>o(t),isEditable:!0},t)),a.map((e,t)=>(0,s.jsx)(n.NM,{file:e,showWarnings:!0,handleRemove:()=>d(t),isEditable:!0,disabled:x===e.file_uuid},e.file_uuid)),(0,s.jsx)(n.NG,{isShown:u||p,size:"normal"},"file-upload-loading"),r.map(e=>{let{syncSource:t,uuid:a}=e;return(0,s.jsx)(i.V,{uuid:a,syncSource:t,onRemove:()=>c(a),isEditable:!0},a)}),(0,s.jsx)(n.NG,{isShown:m,size:"normal"},"sync-upload-loading")]})}},0xe41b440d:(e,t,a)=>{a.d(t,{i:()=>n});var s=a(0x9f369389);let n=(0,a(0x394ef833).v)(e=>({selectedFolders:[],setSelectedFolders:t=>e({selectedFolders:t}),toggleSelectedFolder:t=>e(e=>e.selectedFolders.includes(t)?{selectedFolders:e.selectedFolders.filter(e=>e!==t)}:{selectedFolders:[...e.selectedFolders,t]}),clearSelectedFolders:()=>e({selectedFolders:[]}),recentSessions:[],setRecentSessions:t=>e({recentSessions:t}),fetchRecentSessions:async()=>{(null===s.Fd||void 0===s.Fd?void 0:s.Fd.getAll)&&e({recentSessions:await s.Fd.getAll()})}}))},0x114e73153:(e,t,a)=>{a.d(t,{U:()=>n});var s=a(0x213592df7);let n=e=>{let t=(0,s.ED)(e),{maxKbTokens:a}=(0,s.AO)();return void 0!==t&&t>a}},0x122519e51:(e,t,a)=>{a.d(t,{E:()=>n,V:()=>l});var s=a(0xfc89b4a4);function n(e){let t=[];for(let s of e){var a;for(let e of null!=(a=s.files_v2)?a:s.files)"file_kind"in e&&t.push(e)}return t}let l=e=>(0,s.useMemo)(()=>n(e),[e])},0x14b8da165:(e,t,a)=>{a.d(t,{L:()=>l});var s=a(0x22102fd88);let n=(0,a(0xfc89b4a4).createContext)({debugInfo:void 0});function l(e){let{children:t,debugInfo:a}=e;return(0,s.jsx)(n.Provider,{value:{debugInfo:a},children:t})}},0x17cee1991:(e,t,a)=>{a.d(t,{q:()=>l});var s=a(0x14de19ae8),n=a(0xfcc9d76b);function l(){let{isLoading:e}=(0,s.YL)(),t=(0,n.e)();return e||t}},0x19aca0448:(e,t,a)=>{a.d(t,{g:()=>c,h:()=>d});var s=a(0x22102fd88),n=a(0x628a9a0b),l=a(0x22fc8d729),i=a(0x78b33fbd),r=a(0x38e6572),o=a(0x1025e2485);function d(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1?arguments[1]:void 0,s=(0,n.mz)(t||""),l=null==s||null==(e=s.chat_messages)?void 0:e.at(-1),r=function(e){let{stopReason:t,model:a}=e,s=(0,i.useDynamicConfig)("holdup");if(!a||!t)return;let n=s.get("modelFallbacks",{})[a];if(n&&"refusal"===t)return n}({stopReason:null==l?void 0:l.stop_reason,model:a});return l&&"assistant"===l.sender&&("prompt_injection_risk"===l.stop_reason||"refusal"===l.stop_reason)?{stopReason:l.stop_reason,lastMessage:l,fallback:r}:null}function c(e){let t=(0,n.bT)("push"),a=()=>{t()},i=e=>(0,s.jsx)(l.Y,{onClick:a,children:e});return(0,s.jsx)(o.q,{actionButton:null,children:(0,s.jsx)("div",{className:"text-text-200 flex w-full items-center justify-between",children:(0,s.jsx)("div",{className:"flex items-center gap-1",children:(0,s.jsx)("span",{children:"refusal"===e.stopReason?(0,s.jsx)(r.A,{defaultMessage:"Claude is unable to respond to this request, which appears to violate our <policyLink>Usage Policy</policyLink>. Please <newChat>start a new chat</newChat>.",id:"JQtAKVGSTL",values:{policyLink:e=>(0,s.jsx)("a",{href:"https://www.anthropic.com/legal/aup",target:"_blank",className:"underline cursor-pointer",children:e}),newChat:i}}):(0,s.jsx)(r.A,{defaultMessage:"Claude is unable to respond to this request. Please <newChat>start a new chat</newChat>.",id:"VZKromeiwV",values:{newChat:i}})})})})})}},0x1f59f8010:(e,t,a)=>{a.d(t,{V:()=>o});var s=a(0x22102fd88);a(0x1b813d90);var n=a(0xfc89b4a4),l=a(0x1e841cc7d),i=a(0x1c12b3087),r=a(0x1f92f9b94);function o(e){let{uuid:t,syncSource:a,onRemove:o,isEditable:d}=e,{mutateAsync:c}=(0,l.Ql)(),u=(0,n.useCallback)(()=>{c(t),null==o||o()},[c,t,o]),{projectUuid:m}=(0,i.lE)();return(0,s.jsx)(r.br,{location:"chat",projectUuid:m,syncSource:a,handleRemove:d?u:void 0,isEditable:d})}},0x2120f5fe0:(e,t,a)=>{var s=a(0x22102fd88),n=a(0x252daebb2),l=a(0x19c88845),i=a(0x225bae024);a(0x183548b63);var r=a(0x1e1f2a153),o=a(0xfc89b4a4),d=a(0x38e6572);(0,o.memo)(e=>{let{data:t,variant:a="default",onClose:c}=e,u="nudge"===a,[m,x]=(0,o.useState)(!u),p=(0,o.useMemo)(()=>t?JSON.stringify(t,null,2):"",[t]),{didCopy:f,copyToClipboard:h}=(0,r.C)(),g=(0,o.useCallback)(()=>{h(p)},[h,p]),b=(0,o.useCallback)(()=>{let e=new Date().toISOString().replace(/[:.]/g,"-");!function(e,t,a){let s=new Blob([t],{type:a}),n=URL.createObjectURL(s),l=document.createElement("a");l.href=n,l.download=e,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(n)}("session-debug-".concat(e,".json"),p,"application/json")},[p]),v=(0,o.useCallback)(()=>{b(),null==c||c()},[b,c]),y=(0,o.useCallback)(()=>{x(e=>!e)},[]);return u?(0,s.jsxs)("div",{className:"flex flex-col gap-4 pt-2",children:[(0,s.jsx)("p",{className:"text-text-200 text-sm",children:(0,s.jsx)(n.YX,{id:"copper_bell_symphony"})}),(0,s.jsxs)("div",{className:"flex items-center gap-2 rounded-md bg-warning-900 border border-warning-200 p-3",children:[(0,s.jsx)(l.Warning,{className:"size-4 shrink-0 text-warning-100"}),(0,s.jsx)("p",{className:"text-warning-100 text-sm",children:(0,s.jsx)(n.YX,{id:"silver_drum_cascade"})})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,s.jsxs)(i.$,{variant:"primary",onClick:v,children:[(0,s.jsx)(l.Download,{className:"mr-1.5 size-4"}),(0,s.jsx)(n.YX,{id:"golden_harp_thunder"})]}),(0,s.jsx)(i.$,{variant:"secondary",onClick:c,children:(0,s.jsx)(n.YX,{id:"bronze_flute_whisper"})})]}),(0,s.jsxs)("div",{className:"border-t border-border-300 pt-3",children:[(0,s.jsxs)("button",{type:"button",onClick:y,className:"flex items-center gap-1 text-sm text-text-300 hover:text-text-200 transition-colors",children:[m?(0,s.jsx)(l.CaretDown,{className:"size-4"}):(0,s.jsx)(l.CaretRight,{className:"size-4"}),(0,s.jsx)(n.YX,{id:"velvet_piano_breeze"})]}),m&&(0,s.jsxs)("div",{className:"mt-2 relative",children:[(0,s.jsx)("div",{className:"absolute top-2 right-2 flex items-center space-x-2",children:(0,s.jsx)(i.$,{variant:"ghost",size:"icon_sm",onClick:g,prepend:(0,s.jsx)(r.u,{didCopy:f}),tooltip:(0,s.jsx)(d.A,{defaultMessage:"Copy debug information",id:"XVVZO6tEau"})})}),(0,s.jsx)("textarea",{readOnly:!0,className:"w-full h-48 overflow-auto break-words whitespace-pre-wrap text-xs font-mono p-2 bg-bg-200 rounded-md border border-border-300",children:p})]})]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"absolute top-6 right-16 flex items-center space-x-2",children:[(0,s.jsx)(i.$,{variant:"ghost",size:"icon_sm",onClick:g,prepend:(0,s.jsx)(r.u,{didCopy:f}),tooltip:(0,s.jsx)(d.A,{defaultMessage:"Copy debug information",id:"XVVZO6tEau"}),className:"ml-auto"}),(0,s.jsx)(i.$,{variant:"ghost",size:"icon_sm",onClick:b,prepend:(0,s.jsx)(l.Download,{}),tooltip:(0,s.jsx)(d.A,{defaultMessage:"Download debug information",id:"mmx3mC6aea"})})]}),(0,s.jsx)("textarea",{readOnly:!0,className:"h-96 overflow-auto break-words whitespace-pre-wrap text-xs font-mono p-2 my-3",children:p})]})}).displayName="SessionDebugModalContent"},0x2149252e7:(e,t,a)=>{a.d(t,{CG:()=>i.CG,T1:()=>d,hJ:()=>r.h,ne:()=>l.ne});var s=a(0x11e50e4d6),n=a(0x10e01d04d),l=a(0xc975f685),i=a(0x3797c34f),r=a(0x1c9d93a5f);let o=[l.aE];class d extends s.Zs{getAppCapabilities(){return this._appCapabilities}getAppVersion(){return this._appInfo}set onsizechange(e){this.setNotificationHandler(l.e,t=>e(t.params))}set onsandboxready(e){this.setNotificationHandler(l.Y2,t=>e(t.params))}set oninitialized(e){this.setNotificationHandler(l.DF,t=>e(t.params))}set onmessage(e){this.setRequestHandler(l.u$,async(t,a)=>e(t.params,a))}set onopenlink(e){this.setRequestHandler(l.Ji,async(t,a)=>e(t.params,a))}set onrequestdisplaymode(e){this.setRequestHandler(l.Jj,async(t,a)=>e(t.params,a))}set onloggingmessage(e){this.setNotificationHandler(n.B,async t=>{e(t.params)})}assertCapabilityForMethod(e){}assertRequestHandlerCapability(e){}assertNotificationCapability(e){}assertTaskCapability(e){throw Error("Tasks are not supported in MCP Apps")}assertTaskHandlerCapability(e){throw Error("Task handlers are not supported in MCP Apps")}getCapabilities(){return this._capabilities}async _oninitialize(e){let t=e.params.protocolVersion;return this._appCapabilities=e.params.appCapabilities,this._appInfo=e.params.appInfo,{protocolVersion:o.includes(t)?t:l.aE,hostCapabilities:this.getCapabilities(),hostInfo:this._hostInfo,hostContext:this._hostContext}}setHostContext(e){let t={},a=!1;for(let l of Object.keys(e)){var s,n;let i=this._hostContext[l],r=e[l];s=i,n=r,JSON.stringify(s)!==JSON.stringify(n)&&(t[l]=r,a=!0)}a&&(this._hostContext=e,this.sendHostContextChange(t))}sendHostContextChange(e){return this.notification({method:"ui/notifications/host-context-changed",params:e})}sendToolInput(e){return this.notification({method:"ui/notifications/tool-input",params:e})}sendToolInputPartial(e){return this.notification({method:"ui/notifications/tool-input-partial",params:e})}sendToolResult(e){return this.notification({method:"ui/notifications/tool-result",params:e})}sendSandboxResourceReady(e){return this.notification({method:"ui/notifications/sandbox-resource-ready",params:e})}sendResourceTeardown(e,t){return this.request({method:"ui/resource-teardown",params:e},l.$i,t)}forwardRequest(e,t){this.setRequestHandler(e,async(e,a)=>(console.log("Forwarding request ".concat(e.method," from MCP UI client")),this._client.request(e,t,{signal:a.signal})))}forwardNotification(e){this.setNotificationHandler(e,async e=>{console.log("Forwarding notification ".concat(e.method," from MCP UI client")),await this._client.notification(e)})}async connect(e){let t=this._client.getServerCapabilities();if(!t)throw Error("Client server capabilities not available");return t.tools&&(this.forwardRequest(n.FT,n.TF),t.tools.listChanged&&this.forwardNotification(n.fH)),t.resources&&(this.forwardRequest(n.OI,n.cv),this.forwardRequest(n.s,n.O$),this.forwardRequest(n.R6,n.ve),t.resources.listChanged&&this.forwardNotification(n.hh)),t.prompts&&(this.forwardRequest(n.Qq,n.Yu),t.prompts.listChanged&&this.forwardNotification(n.br)),super.connect(e)}constructor(e,t,a,s){super(s),this._client=e,this._hostInfo=t,this._capabilities=a,this._hostContext={},this._hostContext=(null==s?void 0:s.hostContext)||{},this.setRequestHandler(l.FF,e=>this._oninitialize(e)),this.setRequestHandler(n.tC,(e,t)=>{var a;return null==(a=this.onping)||a.call(this,e.params,t),{}}),this.setRequestHandler(l.Jj,e=>{var t;return{mode:null!=(t=this._hostContext.displayMode)?t:"inline"}})}}}}]);